services:
  db:
    # CI 不要固定容器名，避免冲突
    container_name: null
    # CI 不要写宿主 runtime
    volumes:
      - pgdata:/var/lib/postgresql/data
      - ./scripts/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql:ro

  redis:
    container_name: null
    volumes:
      - redisdata:/data

  odoo:
    container_name: null
    # CI 不要暴露端口
    ports: []
    # CI 不要写宿主 runtime/odoo
    volumes:
      - odoodata:/var/lib/odoo
      - ./addons:/mnt/extra-addons
      - ./addons_external:/mnt/addons_external
      - ./config/odoo.conf:/etc/odoo/odoo.conf:ro

  # CI 不需要这些，直接禁用（最简单）
  n8n:
    profiles: ["manual"]

  nginx:
    profiles: ["manual"]

volumes:
  pgdata:
  redisdata:
  odoodata:
