<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data noupdate="0">

        <!-- =========================================================
             基础组：SC 内部用户
             - 唯一负责 implied base.group_user
             - 所有 SC 能力组都应 implied 此组，避免重复黏 base.group_user
        ========================================================== -->
        <record id="group_sc_internal_user" model="res.groups">
            <field name="name">SC 基础 - 内部用户</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [ref('base.group_user')])]"/>
        </record>


        <!-- =========================
             项目中心
             - 关键：project.stage_id 字段受 project.group_project_user 限制
             - 放在 project_read，保证 read/user/manager 全链条具备 stage_id 读权限
        ========================== -->
        <!-- 原生能力桥接：承接 Odoo 原生项目组，统一从这里黏住 -->
        <record id="group_sc_bridge_project_read" model="res.groups">
            <field name="name">SC Bridge - Project Read</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_internal_user'),
                ref('project.group_project_user'),
                ref('project.group_project_stages')
            ])]"/>
        </record>

        <record id="group_sc_cap_project_read" model="res.groups">
            <field name="name">SC 能力 - 项目中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_bridge_project_read')
            ])]"/>
        </record>

        <record id="group_sc_cap_project_user" model="res.groups">
            <field name="name">SC 能力 - 项目中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_cap_project_read')
            ])]"/>
        </record>

        <record id="group_sc_cap_project_manager" model="res.groups">
            <field name="name">SC 能力 - 项目中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_cap_project_user')
            ])]"/>
        </record>


        <!-- =========================
             物资中心
        ========================== -->
        <record id="group_sc_cap_material_read" model="res.groups">
            <field name="name">SC 能力 - 物资中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_internal_user')
            ])]"/>
        </record>

        <record id="group_sc_cap_material_user" model="res.groups">
            <field name="name">SC 能力 - 物资中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_cap_material_read')
            ])]"/>
        </record>

        <record id="group_sc_cap_material_manager" model="res.groups">
            <field name="name">SC 能力 - 物资中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_cap_material_user')
            ])]"/>
        </record>


        <!-- =========================
             采购中心
        ========================== -->
        <record id="group_sc_cap_purchase_read" model="res.groups">
            <field name="name">SC 能力 - 采购中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_internal_user')
            ])]"/>
        </record>

        <record id="group_sc_cap_purchase_user" model="res.groups">
            <field name="name">SC 能力 - 采购中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_cap_purchase_read')
            ])]"/>
        </record>

        <record id="group_sc_cap_purchase_manager" model="res.groups">
            <field name="name">SC 能力 - 采购中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_cap_purchase_user')
            ])]"/>
        </record>


        <!-- =========================
             财务中心
             - 不 implied 合同中心（避免菜单/管理越权）
             - 跨域读取合同依赖 ACL/记录规则控制
        ========================== -->
        <record id="group_sc_cap_finance_read" model="res.groups">
            <field name="name">SC 能力 - 财务中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_internal_user')])
            ]"/>
        </record>

        <record id="group_sc_cap_finance_user" model="res.groups">
            <field name="name">SC 能力 - 财务中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_finance_read')])
            ]"/>
        </record>

        <record id="group_sc_cap_finance_manager" model="res.groups">
            <field name="name">SC 能力 - 财务中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_finance_user')])
            ]"/>
        </record>


        <!-- =========================
             合同中心
        ========================== -->
        <record id="group_sc_cap_contract_read" model="res.groups">
            <field name="name">SC 能力 - 合同中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_internal_user')])
            ]"/>
        </record>

        <record id="group_sc_cap_contract_user" model="res.groups">
            <field name="name">SC 能力 - 合同中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_contract_read')])
            ]"/>
        </record>

        <record id="group_sc_cap_contract_manager" model="res.groups">
            <field name="name">SC 能力 - 合同中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_contract_user')])
            ]"/>
        </record>


        <!-- =========================
             成控中心
        ========================== -->
        <record id="group_sc_cap_cost_read" model="res.groups">
            <field name="name">SC 能力 - 成控中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [
                    ref('smart_construction_core.group_sc_internal_user'),
                    ref('smart_construction_core.group_sc_cap_project_read')
                ])
            ]"/>
        </record>

        <record id="group_sc_cap_cost_user" model="res.groups">
            <field name="name">SC 能力 - 成控中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_cost_read')])
            ]"/>
        </record>

        <record id="group_sc_cap_cost_manager" model="res.groups">
            <field name="name">SC 能力 - 成控中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_cost_user')])
            ]"/>
        </record>


        <!-- =========================
             结算中心
        ========================== -->
        <record id="group_sc_cap_settlement_read" model="res.groups">
            <field name="name">SC 能力 - 结算中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_internal_user')])
            ]"/>
        </record>

        <record id="group_sc_cap_settlement_user" model="res.groups">
            <field name="name">SC 能力 - 结算中心经办</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_settlement_read')])
            ]"/>
        </record>

        <record id="group_sc_cap_settlement_manager" model="res.groups">
            <field name="name">SC 能力 - 结算中心审批</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_cap_settlement_user')])
            ]"/>
        </record>


        <!-- =========================
             数据中心（Phase1 先只读）
        ========================== -->
        <record id="group_sc_cap_data_read" model="res.groups">
            <field name="name">SC 能力 - 数据中心只读</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_internal_user')])
            ]"/>
        </record>


        <!-- =========================
             配置管理员
             - 仍建议 implied internal_user，保持其为内部用户
        ========================== -->
        <record id="group_sc_cap_config_admin" model="res.groups">
            <field name="name">SC 能力 - 配置管理员</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[
                (6, 0, [ref('smart_construction_core.group_sc_internal_user')])
            ]"/>
        </record>

        <!-- =========================
             联系人管理
             - 映射到 Odoo 联系人管理员
        ========================== -->
        <record id="group_sc_cap_contact_manager" model="res.groups">
            <field name="name">SC 能力 - 联系人管理</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_internal_user'),
                ref('base.group_partner_manager')
            ])]"/>
        </record>

        <!-- =========================
             超级管理员（仅测试/运维使用）
             - 汇总所有域的 manager 能力 + 配置/数据读
             - implied internal_user 以继承 base.group_user
             - implied project.group_project_manager 确保原生项目能力完整
        ========================== -->
        <record id="group_sc_super_admin" model="res.groups">
            <field name="name">SC 超级管理员（全能力）</field>
            <field name="category_id" ref="smart_construction_core.module_category_smart_construction"/>
            <field name="implied_ids" eval="[(6, 0, [
                ref('smart_construction_core.group_sc_internal_user'),

                ref('smart_construction_core.group_sc_cap_contact_manager'),
                ref('smart_construction_core.group_sc_cap_project_manager'),
                ref('smart_construction_core.group_sc_cap_contract_manager'),
                ref('smart_construction_core.group_sc_cap_cost_manager'),
                ref('smart_construction_core.group_sc_cap_material_manager'),
                ref('smart_construction_core.group_sc_cap_purchase_manager'),
                ref('smart_construction_core.group_sc_cap_finance_manager'),
                ref('smart_construction_core.group_sc_cap_settlement_manager'),

                ref('smart_construction_core.group_sc_cap_data_read'),
                ref('smart_construction_core.group_sc_cap_config_admin'),

                ref('project.group_project_manager')
            ])]"/>
        </record>

    </data>
</odoo>
