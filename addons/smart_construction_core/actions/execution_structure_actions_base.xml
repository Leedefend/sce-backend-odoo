<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="action_exec_structure_entry" model="ir.actions.server">
        <field name="name">执行结构入口</field>
        <field name="model_id" ref="project.model_project_project"/>
        <field name="state">code</field>
        <field name="groups_id" eval="[(4, ref('smart_construction_core.group_sc_cap_project_read'))]"/>
        <field name="code"><![CDATA[
next_action = {
    'type': 'ir.actions.act_window',
    'name': '项目列表',
    'res_model': 'project.project',
    'view_mode': 'kanban,tree,form',
    'views': [(False, 'kanban'), (False, 'tree'), (False, 'form')],
    'target': 'current',
    'domain': [('sc_demo_showcase_ready', '=', True)],
    'context': dict(env.context),
}
action = {
    'type': 'ir.actions.client',
    'tag': 'display_notification',
    'params': {
        'title': '执行结构',
        'message': '请先选择项目，将跳转到项目列表。',
        'type': 'warning',
        'sticky': False,
        'next': next_action,
    }
}
        ]]></field>
    </record>

    <record id="action_exec_structure_wbs" model="ir.actions.act_window">
        <field name="name">执行结构</field>
        <field name="res_model">construction.work.breakdown</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'sc_exec_view': 'wbs'}</field>
        <field name="domain">context.get('default_project_id') and [('project_id', '=', context.get('default_project_id'))] or []</field>
        <field name="groups_id" eval="[(4, ref('smart_construction_core.group_sc_cap_project_read'))]"/>
    </record>

    <record id="action_exec_structure_structure" model="ir.actions.act_window">
        <field name="name">执行结构</field>
        <field name="res_model">sc.project.structure</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'sc_exec_view': 'structure'}</field>
        <field name="domain">context.get('default_project_id') and [('project_id', '=', context.get('default_project_id'))] or []</field>
        <field name="groups_id" eval="[(4, ref('smart_construction_core.group_sc_cap_project_read'))]"/>
    </record>
</odoo>
