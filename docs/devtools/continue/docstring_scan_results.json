{
  "scan_time": "2026-01-31T22:03:57.048565",
  "files_scanned": 133,
  "missing_docstrings": [
    {
      "file": "core_extension.py",
      "symbol_type": "module",
      "qualified_name": "core_extension",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        ""
      ]
    },
    {
      "file": "hooks.py",
      "symbol_type": "module",
      "qualified_name": "hooks",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import zlib",
        "from odoo import SUPERUSER_ID, api"
      ]
    },
    {
      "file": "hooks.py",
      "symbol_type": "function",
      "qualified_name": "_tax_key",
      "line": 6,
      "decorators": [],
      "context_snippet": [
        "def _tax_key(company_id, type_tax_use, name, amount, amount_type, price_include=False):",
        "    raw = f\"{company_id}|{type_tax_use}|{amount_type}|{amount}|{int(bool(price_include))}|{name}\".encode(\"utf-8\")",
        "    return zlib.crc32(raw) & 0xFFFFFFFF"
      ]
    },
    {
      "file": "hooks.py",
      "symbol_type": "function",
      "qualified_name": "_advisory_xact_lock",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "def _advisory_xact_lock(cr, key_int):",
        "    cr.execute(\"SELECT pg_advisory_xact_lock(%s)\", (int(key_int),))",
        ""
      ]
    },
    {
      "file": "__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import models",
        "from . import controllers"
      ]
    },
    {
      "file": "__manifest__.py",
      "symbol_type": "module",
      "qualified_name": "__manifest__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "# pyright: reportUnusedExpression=false",
        "{"
      ]
    },
    {
      "file": "controllers/api_base.py",
      "symbol_type": "module",
      "qualified_name": "api_base",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/api_base.py",
      "symbol_type": "function",
      "qualified_name": "_server_time",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "def _server_time() -> str:",
        "    return datetime.utcnow().replace(microsecond=0).isoformat() + \"Z\"",
        ""
      ]
    },
    {
      "file": "controllers/api_base.py",
      "symbol_type": "function",
      "qualified_name": "_json_response",
      "line": 19,
      "decorators": [],
      "context_snippet": [
        "def _json_response(payload: Dict[str, Any], status: int = 200):",
        "    body = json.dumps(payload, ensure_ascii=False, default=str)",
        "    headers = [(\"Content-Type\", \"application/json; charset=utf-8\")]"
      ]
    },
    {
      "file": "controllers/api_base.py",
      "symbol_type": "function",
      "qualified_name": "ok",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "def ok(data: Any, warnings: Optional[list] = None, status: int = 200):",
        "    trace_id = get_trace_id()",
        "    payload = {"
      ]
    },
    {
      "file": "controllers/api_base.py",
      "symbol_type": "function",
      "qualified_name": "fail",
      "line": 38,
      "decorators": [],
      "context_snippet": [
        "def fail(",
        "    code: str,",
        "    message: str,"
      ]
    },
    {
      "file": "controllers/api_base.py",
      "symbol_type": "function",
      "qualified_name": "fail_from_exception",
      "line": 63,
      "decorators": [],
      "context_snippet": [
        "def fail_from_exception(exc: Exception, http_status: int = 500):",
        "    # Hide tracebacks; collapse to a stable server error payload.",
        "    return fail("
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "module",
      "qualified_name": "auth_signup",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        "import time"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "class",
      "qualified_name": "ScAuthSignup",
      "line": 17,
      "decorators": [],
      "context_snippet": [
        "class ScAuthSignup(AuthSignupHome):",
        "    def _get_signup_mode(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_signup_mode",
      "line": 18,
      "decorators": [],
      "context_snippet": [
        "    def _get_signup_mode(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        mode = (icp.get_param(\"sc.signup.mode\") or \"\").strip().lower()"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._require_email_verify",
      "line": 26,
      "decorators": [],
      "context_snippet": [
        "    def _require_email_verify(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        return icp.get_param(\"sc.signup.require_email_verify\", \"true\").lower() in (\"1\", \"true\", \"yes\")"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_domain_whitelist",
      "line": 30,
      "decorators": [],
      "context_snippet": [
        "    def _get_domain_whitelist(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        raw = icp.get_param(\"sc.signup.domain_whitelist\", \"\")"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_default_group_xmlids",
      "line": 36,
      "decorators": [],
      "context_snippet": [
        "    def _get_default_group_xmlids(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        raw = icp.get_param(\"sc.signup.default_group_xmlids\", \"base.group_portal\")"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_token_expiration_hours",
      "line": 44,
      "decorators": [],
      "context_snippet": [
        "    def _get_token_expiration_hours(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        try:"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_recaptcha_mode",
      "line": 52,
      "decorators": [],
      "context_snippet": [
        "    def _get_recaptcha_mode(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        mode = (icp.get_param(\"sc.signup.recaptcha.mode\") or \"soft\").strip().lower()"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._assert_open_allowed",
      "line": 57,
      "decorators": [],
      "context_snippet": [
        "    def _assert_open_allowed(self, token=None):",
        "        mode = self._get_signup_mode()",
        "        if token:"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_rate_limit_config",
      "line": 64,
      "decorators": [],
      "context_snippet": [
        "    def _get_rate_limit_config(self):",
        "        icp = request.env[\"ir.config_parameter\"].sudo()",
        "        window_sec = int(icp.get_param(\"sc.signup.ratelimit.window_sec\", \"60\") or 60)"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._get_client_ip",
      "line": 71,
      "decorators": [],
      "context_snippet": [
        "    def _get_client_ip(self):",
        "        req = request.httprequest",
        "        remote_addr = (req.remote_addr or \"\").strip()"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._assert_rate_limit",
      "line": 79,
      "decorators": [],
      "context_snippet": [
        "    def _assert_rate_limit(self, login=None):",
        "        window_sec, max_per_ip, max_per_email = self._get_rate_limit_config()",
        "        if window_sec <= 0:"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._assert_password_strength",
      "line": 94,
      "decorators": [],
      "context_snippet": [
        "    def _assert_password_strength(self, password):",
        "        if not password or len(password) < 8:",
        "            raise Forbidden(_(\"密码太短，请至少包含 8 位字符\"))"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._assert_email_allowed",
      "line": 102,
      "decorators": [],
      "context_snippet": [
        "    def _assert_email_allowed(self, email):",
        "        if not email:",
        "            return"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._apply_user_defaults",
      "line": 112,
      "decorators": [],
      "context_snippet": [
        "    def _apply_user_defaults(self, user):",
        "        if not user:",
        "            return"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup._send_activation_email",
      "line": 137,
      "decorators": [],
      "context_snippet": [
        "    def _send_activation_email(self, user):",
        "        partner = user.partner_id.sudo()",
        "        if hasattr(partner, \"signup_prepare\"):"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup.web_auth_signup",
      "line": 163,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def web_auth_signup(self, *args, **kw):",
        "        qcontext = self.get_auth_signup_qcontext()",
        "        token = qcontext.get(\"token\")"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup.get_auth_signup_qcontext",
      "line": 203,
      "decorators": [],
      "context_snippet": [
        "    def get_auth_signup_qcontext(self):",
        "        qcontext = super().get_auth_signup_qcontext()",
        "        token_param = request.params.get(\"token\")"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup.do_signup",
      "line": 213,
      "decorators": [],
      "context_snippet": [
        "    def do_signup(self, qcontext):",
        "        token = qcontext.get(\"token\")",
        "        self._assert_open_allowed(token=token)"
      ]
    },
    {
      "file": "controllers/auth_signup.py",
      "symbol_type": "method",
      "qualified_name": "ScAuthSignup.sc_activate_account",
      "line": 239,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def sc_activate_account(self, token, **kwargs):",
        "        try:",
        "            partner = request.env[\"res.partner\"].sudo()._signup_retrieve_partner(token, check_validity=True, raise_exception=True)"
      ]
    },
    {
      "file": "controllers/capability_catalog_controller.py",
      "symbol_type": "module",
      "qualified_name": "capability_catalog_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/capability_catalog_controller.py",
      "symbol_type": "class",
      "qualified_name": "CapabilityCatalogController",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "class CapabilityCatalogController(http.Controller):",
        "    @http.route(\"/api/capabilities/export\", type=\"http\", auth=\"public\", methods=[\"GET\"], csrf=False)",
        "    def export_capabilities(self, **params):"
      ]
    },
    {
      "file": "controllers/capability_catalog_controller.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityCatalogController.export_capabilities",
      "line": 15,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def export_capabilities(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/capability_catalog_controller.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityCatalogController.search_capabilities",
      "line": 30,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def search_capabilities(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/capability_catalog_controller.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityCatalogController.lint_capabilities",
      "line": 81,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def lint_capabilities(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/capability_matrix_controller.py",
      "symbol_type": "module",
      "qualified_name": "capability_matrix_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/capability_matrix_controller.py",
      "symbol_type": "class",
      "qualified_name": "CapabilityMatrixController",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class CapabilityMatrixController(http.Controller):",
        "",
        "    @http.route(\"/api/contract/capability_matrix\", type=\"http\", auth=\"user\", methods=[\"GET\", \"POST\"], csrf=False)"
      ]
    },
    {
      "file": "controllers/capability_matrix_controller.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixController.capability_matrix",
      "line": 13,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def capability_matrix(self, **params):",
        "        try:",
        "            from odoo.addons.smart_construction_core.services.capability_matrix_service import ("
      ]
    },
    {
      "file": "controllers/execute_controller.py",
      "symbol_type": "module",
      "qualified_name": "execute_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/execute_controller.py",
      "symbol_type": "class",
      "qualified_name": "ExecuteController",
      "line": 12,
      "decorators": [],
      "context_snippet": [
        "class ExecuteController(http.Controller):",
        "",
        "    @http.route(\"/api/execute_button\", type=\"http\", auth=\"user\", methods=[\"POST\"], csrf=False)"
      ]
    },
    {
      "file": "controllers/execute_controller.py",
      "symbol_type": "function",
      "qualified_name": "_merge_payload",
      "line": 36,
      "decorators": [],
      "context_snippet": [
        "def _merge_payload(params):",
        "    payload = dict(params or {})",
        "    try:"
      ]
    },
    {
      "file": "controllers/execute_controller.py",
      "symbol_type": "function",
      "qualified_name": "_is_method_allowed",
      "line": 46,
      "decorators": [],
      "context_snippet": [
        "def _is_method_allowed(model, method):",
        "    payload = {\"op\": \"model\", \"model\": model, \"view_type\": \"form\"}",
        "    handler = UiContractHandler(request.env, request=request, payload=payload)"
      ]
    },
    {
      "file": "controllers/execute_controller.py",
      "symbol_type": "method",
      "qualified_name": "ExecuteController.execute_button",
      "line": 15,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def execute_button(self, **params):",
        "        payload = _merge_payload(params)",
        "        model = (payload.get(\"model\") or \"\").strip()"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "module",
      "qualified_name": "frontend_api",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import http",
        "from odoo.http import request"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "function",
      "qualified_name": "_meta",
      "line": 57,
      "decorators": [],
      "context_snippet": [
        "def _meta(trace_id: str) -> dict:",
        "    return {",
        "        \"trace_id\": trace_id,"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "function",
      "qualified_name": "_error_resp",
      "line": 64,
      "decorators": [],
      "context_snippet": [
        "def _error_resp(code: str, message: str, trace_id: str, details: dict | None = None):",
        "    return build_error_envelope(",
        "        code=code,"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "class",
      "qualified_name": "FrontendAPI",
      "line": 76,
      "decorators": [],
      "context_snippet": [
        "class FrontendAPI(http.Controller):",
        "",
        "    @http.route('/api/login', type='json', auth='public', csrf=False, cors='*', methods=['POST'])"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "method",
      "qualified_name": "FrontendAPI.api_login",
      "line": 79,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def api_login(self, **kwargs):",
        "        trace_id = get_trace_id(request.httprequest.headers)",
        "        payload = _get_payload(kwargs)"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "method",
      "qualified_name": "FrontendAPI.api_logout",
      "line": 110,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def api_logout(self, **kwargs):",
        "        trace_id = get_trace_id(request.httprequest.headers)",
        "        request.session.logout(keep_db=True)"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "method",
      "qualified_name": "FrontendAPI.api_session_get",
      "line": 116,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def api_session_get(self, **kwargs):",
        "        trace_id = get_trace_id(request.httprequest.headers)",
        "        uid = request.session.uid"
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "method",
      "qualified_name": "FrontendAPI.api_menu_tree",
      "line": 132,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def api_menu_tree(self, **kwargs):",
        "        trace_id = get_trace_id(request.httprequest.headers)",
        "        \"\"\"从我们模块根菜单（external id：smart_construction_enterprise.menu_sc_root）返回可见树。\"\"\""
      ]
    },
    {
      "file": "controllers/frontend_api.py",
      "symbol_type": "function",
      "qualified_name": "serialize",
      "line": 140,
      "decorators": [],
      "context_snippet": [
        "        def serialize(menu):",
        "            children = menu.child_id.sorted(lambda m: m.sequence or 10)",
        "            return {"
      ]
    },
    {
      "file": "controllers/insight_controller.py",
      "symbol_type": "module",
      "qualified_name": "insight_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/insight_controller.py",
      "symbol_type": "class",
      "qualified_name": "InsightController",
      "line": 12,
      "decorators": [],
      "context_snippet": [
        "class InsightController(http.Controller):",
        "",
        "    @http.route(\"/api/insight\", type=\"http\", auth=\"user\", methods=[\"GET\"], csrf=False)"
      ]
    },
    {
      "file": "controllers/insight_controller.py",
      "symbol_type": "method",
      "qualified_name": "InsightController._json",
      "line": 59,
      "decorators": [],
      "context_snippet": [
        "    def _json(self, payload, status=200):",
        "        body = json.dumps(payload, ensure_ascii=False)",
        "        headers = [(\"Content-Type\", \"application/json; charset=utf-8\")]"
      ]
    },
    {
      "file": "controllers/meta_controller.py",
      "symbol_type": "module",
      "qualified_name": "meta_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/meta_controller.py",
      "symbol_type": "class",
      "qualified_name": "MetaController",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class MetaController(http.Controller):",
        "",
        "    @http.route(\"/api/meta/describe_model\", type=\"http\", auth=\"user\", methods=[\"GET\", \"POST\"], csrf=False)"
      ]
    },
    {
      "file": "controllers/meta_controller.py",
      "symbol_type": "function",
      "qualified_name": "_merge_payload",
      "line": 89,
      "decorators": [],
      "context_snippet": [
        "def _merge_payload(params):",
        "    payload = dict(params or {})",
        "    try:"
      ]
    },
    {
      "file": "controllers/meta_controller.py",
      "symbol_type": "method",
      "qualified_name": "MetaController.describe_model",
      "line": 13,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def describe_model(self, **params):",
        "        payload = _merge_payload(params)",
        "        model = (payload.get(\"model\") or \"\").strip()"
      ]
    },
    {
      "file": "controllers/meta_controller.py",
      "symbol_type": "method",
      "qualified_name": "MetaController.describe_project_capabilities",
      "line": 53,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def describe_project_capabilities(self, **params):",
        "        payload = _merge_payload(params)",
        "        project_id = payload.get(\"project_id\") or payload.get(\"id\")"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "module",
      "qualified_name": "ops_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "function",
      "qualified_name": "_has_admin",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "def _has_admin(user):",
        "    return user.has_group(\"smart_construction_core.group_sc_cap_config_admin\") or user.has_group(\"base.group_system\")",
        ""
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "class",
      "qualified_name": "OpsController",
      "line": 17,
      "decorators": [],
      "context_snippet": [
        "class OpsController(http.Controller):",
        "    @http.route(\"/api/ops/tenants\", type=\"http\", auth=\"public\", methods=[\"GET\"], csrf=False)",
        "    def tenants(self, **params):"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "method",
      "qualified_name": "OpsController.tenants",
      "line": 19,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def tenants(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "method",
      "qualified_name": "OpsController.set_subscription",
      "line": 60,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def set_subscription(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "method",
      "qualified_name": "OpsController.batch_upgrade",
      "line": 96,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def batch_upgrade(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "method",
      "qualified_name": "OpsController.batch_rollback",
      "line": 140,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def batch_rollback(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "method",
      "qualified_name": "OpsController.audit_search",
      "line": 161,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def audit_search(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/ops_controller.py",
      "symbol_type": "method",
      "qualified_name": "OpsController.job_status",
      "line": 190,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def job_status(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "module",
      "qualified_name": "pack_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "function",
      "qualified_name": "_has_admin",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "def _has_admin(user):",
        "    return user.has_group(\"smart_construction_core.group_sc_cap_config_admin\") or user.has_group(\"base.group_system\")",
        ""
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "class",
      "qualified_name": "PackController",
      "line": 17,
      "decorators": [],
      "context_snippet": [
        "class PackController(http.Controller):",
        "    @http.route(\"/api/packs/publish\", type=\"http\", auth=\"public\", methods=[\"POST\"], csrf=False)",
        "    def publish_pack(self, **params):"
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "method",
      "qualified_name": "PackController.publish_pack",
      "line": 19,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def publish_pack(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "method",
      "qualified_name": "PackController.catalog",
      "line": 82,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def catalog(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "method",
      "qualified_name": "PackController._install_pack",
      "line": 121,
      "decorators": [],
      "context_snippet": [
        "    def _install_pack(self, user, env, pack_id, mode, dry_run, confirm, strict):",
        "        Registry = env[\"sc.pack.registry\"].sudo()",
        "        Installation = env[\"sc.pack.installation\"].sudo()"
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "method",
      "qualified_name": "PackController.install_pack",
      "line": 202,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def install_pack(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/pack_controller.py",
      "symbol_type": "method",
      "qualified_name": "PackController.upgrade_pack",
      "line": 230,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def upgrade_pack(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/portal_dashboard_controller.py",
      "symbol_type": "module",
      "qualified_name": "portal_dashboard_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/portal_dashboard_controller.py",
      "symbol_type": "class",
      "qualified_name": "PortalDashboardController",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class PortalDashboardController(http.Controller):",
        "",
        "    @http.route(\"/api/contract/portal_dashboard\", type=\"http\", auth=\"user\", methods=[\"GET\", \"POST\"], csrf=False)"
      ]
    },
    {
      "file": "controllers/portal_dashboard_controller.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardController.portal_dashboard",
      "line": 13,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def portal_dashboard(self, **params):",
        "        try:",
        "            from odoo.addons.smart_construction_core.services.portal_dashboard_service import ("
      ]
    },
    {
      "file": "controllers/portal_execute_button_controller.py",
      "symbol_type": "module",
      "qualified_name": "portal_execute_button_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/portal_execute_button_controller.py",
      "symbol_type": "class",
      "qualified_name": "PortalExecuteButtonController",
      "line": 14,
      "decorators": [],
      "context_snippet": [
        "class PortalExecuteButtonController(http.Controller):",
        "    @http.route(",
        "        \"/api/contract/portal_execute_button\","
      ]
    },
    {
      "file": "controllers/portal_execute_button_controller.py",
      "symbol_type": "function",
      "qualified_name": "_merge_payload",
      "line": 70,
      "decorators": [],
      "context_snippet": [
        "def _merge_payload(params):",
        "    payload = dict(params or {})",
        "    try:"
      ]
    },
    {
      "file": "controllers/portal_execute_button_controller.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonController.portal_execute_button_contract",
      "line": 22,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def portal_execute_button_contract(self, **params):",
        "        model = (params.get(\"model\") or \"\").strip() or None",
        "        method = (params.get(\"method\") or \"\").strip() or None"
      ]
    },
    {
      "file": "controllers/portal_execute_button_controller.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonController.portal_execute_button",
      "line": 39,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def portal_execute_button(self, **params):",
        "        payload = _merge_payload(params)",
        "        model = (payload.get(\"model\") or \"\").strip()"
      ]
    },
    {
      "file": "controllers/preference_controller.py",
      "symbol_type": "module",
      "qualified_name": "preference_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/preference_controller.py",
      "symbol_type": "function",
      "qualified_name": "_get_json_body",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "def _get_json_body():",
        "    body = request.httprequest.get_json(force=True, silent=True)",
        "    return body if isinstance(body, dict) else {}"
      ]
    },
    {
      "file": "controllers/preference_controller.py",
      "symbol_type": "class",
      "qualified_name": "PreferenceController",
      "line": 18,
      "decorators": [],
      "context_snippet": [
        "class PreferenceController(http.Controller):",
        "    @http.route(\"/api/preferences/get\", type=\"http\", auth=\"public\", methods=[\"GET\", \"POST\"], csrf=False)",
        "    def pref_get(self, **params):"
      ]
    },
    {
      "file": "controllers/preference_controller.py",
      "symbol_type": "method",
      "qualified_name": "PreferenceController.pref_get",
      "line": 20,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def pref_get(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/preference_controller.py",
      "symbol_type": "method",
      "qualified_name": "PreferenceController.pref_set",
      "line": 43,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def pref_set(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/scene_controller.py",
      "symbol_type": "module",
      "qualified_name": "scene_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/scene_controller.py",
      "symbol_type": "function",
      "qualified_name": "_has_admin",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "def _has_admin(user):",
        "    return user.has_group(\"smart_construction_core.group_sc_cap_config_admin\") or user.has_group(\"base.group_system\")",
        ""
      ]
    },
    {
      "file": "controllers/scene_controller.py",
      "symbol_type": "function",
      "qualified_name": "_parse_bool",
      "line": 17,
      "decorators": [],
      "context_snippet": [
        "def _parse_bool(val, default=False):",
        "    if val is None:",
        "        return default"
      ]
    },
    {
      "file": "controllers/scene_controller.py",
      "symbol_type": "class",
      "qualified_name": "SceneController",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "class SceneController(http.Controller):",
        "    @http.route(\"/api/scenes/my\", type=\"http\", auth=\"public\", methods=[\"GET\"], csrf=False)",
        "    def my_scenes(self, **params):"
      ]
    },
    {
      "file": "controllers/scene_controller.py",
      "symbol_type": "method",
      "qualified_name": "SceneController.my_scenes",
      "line": 27,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def my_scenes(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "module",
      "qualified_name": "scene_template_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_get_json_body",
      "line": 16,
      "decorators": [],
      "context_snippet": [
        "def _get_json_body():",
        "    body = request.httprequest.get_json(force=True, silent=True)",
        "    return body if isinstance(body, dict) else {}"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_has_admin",
      "line": 21,
      "decorators": [],
      "context_snippet": [
        "def _has_admin(user):",
        "    return user.has_group(\"smart_construction_core.group_sc_cap_config_admin\") or user.has_group(\"base.group_system\")",
        ""
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_parse_bool",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "def _parse_bool(val, default=False):",
        "    if val is None:",
        "        return default"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_resolve_group_xmlids",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "def _resolve_group_xmlids(env, xmlids, strict, issues, cap_key):",
        "    group_ids = []",
        "    for xmlid in xmlids or []:"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_apply_pack",
      "line": 49,
      "decorators": [],
      "context_snippet": [
        "def _apply_pack(env, user, body):",
        "    upgrade_policy = body.get(\"upgrade_policy\") or {}",
        "    default_mode = (upgrade_policy.get(\"default_mode\") or \"merge\").strip().lower()"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_normalize_pack_payload",
      "line": 402,
      "decorators": [],
      "context_snippet": [
        "def _normalize_pack_payload(payload):",
        "    caps = payload.get(\"capabilities\") or []",
        "    scenes = payload.get(\"scenes\") or []"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_pack_hash",
      "line": 421,
      "decorators": [],
      "context_snippet": [
        "def _pack_hash(payload):",
        "    normalized = _normalize_pack_payload(dict(payload))",
        "    raw = json.dumps(normalized, ensure_ascii=False, sort_keys=True, separators=(\",\", \":\"))"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_diff_fields",
      "line": 427,
      "decorators": [],
      "context_snippet": [
        "def _diff_fields(current, incoming):",
        "    changed = []",
        "    for key, val in incoming.items():"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "function",
      "qualified_name": "_risk_level",
      "line": 435,
      "decorators": [],
      "context_snippet": [
        "def _risk_level(diff_v2, mode):",
        "    deletes = len(diff_v2.get(\"deletes\") or [])",
        "    updates = len(diff_v2.get(\"updates\") or [])"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "class",
      "qualified_name": "SceneTemplateController",
      "line": 445,
      "decorators": [],
      "context_snippet": [
        "class SceneTemplateController(http.Controller):",
        "    @http.route(\"/api/scenes/export\", type=\"http\", auth=\"public\", methods=[\"GET\"], csrf=False)",
        "    def export_scenes(self, **params):"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "method",
      "qualified_name": "SceneTemplateController.export_scenes",
      "line": 447,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def export_scenes(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/scene_template_controller.py",
      "symbol_type": "method",
      "qualified_name": "SceneTemplateController.import_scenes",
      "line": 608,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def import_scenes(self, **params):",
        "        try:",
        "            user = get_user_from_token()"
      ]
    },
    {
      "file": "controllers/ui_contract_controller.py",
      "symbol_type": "module",
      "qualified_name": "ui_contract_controller",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/ui_contract_controller.py",
      "symbol_type": "class",
      "qualified_name": "UiContractController",
      "line": 12,
      "decorators": [],
      "context_snippet": [
        "class UiContractController(http.Controller):",
        "",
        "    @http.route(\"/api/ui/contract\", type=\"http\", auth=\"user\", methods=[\"GET\", \"POST\"], csrf=False)"
      ]
    },
    {
      "file": "controllers/ui_contract_controller.py",
      "symbol_type": "function",
      "qualified_name": "_normalize_contract",
      "line": 53,
      "decorators": [],
      "context_snippet": [
        "def _normalize_contract(data, model, view_type):",
        "    views = (data or {}).get(\"views\") or {}",
        "    if view_type == \"form\":"
      ]
    },
    {
      "file": "controllers/ui_contract_controller.py",
      "symbol_type": "function",
      "qualified_name": "_merge_payload",
      "line": 78,
      "decorators": [],
      "context_snippet": [
        "def _merge_payload(params):",
        "    payload = dict(params or {})",
        "    try:"
      ]
    },
    {
      "file": "controllers/ui_contract_controller.py",
      "symbol_type": "function",
      "qualified_name": "_normalize_code",
      "line": 88,
      "decorators": [],
      "context_snippet": [
        "def _normalize_code(raw_code, status):",
        "    if isinstance(raw_code, str) and raw_code.isupper():",
        "        return raw_code"
      ]
    },
    {
      "file": "controllers/ui_contract_controller.py",
      "symbol_type": "method",
      "qualified_name": "UiContractController.ui_contract",
      "line": 15,
      "decorators": [
        "http.route"
      ],
      "context_snippet": [
        "    def ui_contract(self, **params):",
        "        payload = _merge_payload(params)",
        "        model = (payload.get(\"model\") or \"\").strip()"
      ]
    },
    {
      "file": "controllers/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import insight_controller",
        "from . import auth_signup"
      ]
    },
    {
      "file": "controllers/utils/trace.py",
      "symbol_type": "module",
      "qualified_name": "trace",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "controllers/utils/trace.py",
      "symbol_type": "function",
      "qualified_name": "new_trace_id",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "def new_trace_id() -> str:",
        "    return str(uuid.uuid4())",
        ""
      ]
    },
    {
      "file": "controllers/utils/trace.py",
      "symbol_type": "function",
      "qualified_name": "get_trace_id",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "def get_trace_id() -> str:",
        "    if request is None:",
        "        return new_trace_id()"
      ]
    },
    {
      "file": "controllers/utils/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        ""
      ]
    },
    {
      "file": "handlers/capability_describe.py",
      "symbol_type": "module",
      "qualified_name": "capability_describe",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "handlers/capability_describe.py",
      "symbol_type": "function",
      "qualified_name": "_infer_schema",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "def _infer_schema(payload: dict) -> dict:",
        "    schema = {}",
        "    for key, value in (payload or {}).items():"
      ]
    },
    {
      "file": "handlers/capability_describe.py",
      "symbol_type": "class",
      "qualified_name": "CapabilityDescribeHandler",
      "line": 26,
      "decorators": [],
      "context_snippet": [
        "class CapabilityDescribeHandler(BaseIntentHandler):",
        "    INTENT_TYPE = \"capability.describe\"",
        "    DESCRIPTION = \"Describe capability payload/permissions/intent\""
      ]
    },
    {
      "file": "handlers/capability_describe.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityDescribeHandler.handle",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "    def handle(self, payload=None, ctx=None):",
        "        params = payload or self.params or {}",
        "        key = params.get(\"key\") or params.get(\"capability_key\")"
      ]
    },
    {
      "file": "handlers/system_ping_construction.py",
      "symbol_type": "module",
      "qualified_name": "system_ping_construction",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.addons.smart_core.core.base_handler import BaseIntentHandler",
        ""
      ]
    },
    {
      "file": "handlers/system_ping_construction.py",
      "symbol_type": "class",
      "qualified_name": "SystemPingConstructionHandler",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class SystemPingConstructionHandler(BaseIntentHandler):",
        "    INTENT_TYPE = \"system.ping.construction\"",
        "    DESCRIPTION = \"Construction demo ping (extension loader)\""
      ]
    },
    {
      "file": "handlers/system_ping_construction.py",
      "symbol_type": "method",
      "qualified_name": "SystemPingConstructionHandler.handle",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "    def handle(self):",
        "        return {",
        "            \"module\": \"smart_construction_core\","
      ]
    },
    {
      "file": "models/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import core",
        "from . import projection"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "module",
      "qualified_name": "boq",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        "from odoo.exceptions import UserError, ValidationError"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine._compute_amount",
      "line": 239,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount(self):",
        "        for rec in self:",
        "            qty = rec.quantity or 0.0"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine._compute_amount_leaf",
      "line": 250,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount_leaf(self):",
        "        for rec in self:",
        "            if rec.line_type == \"item\":"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine._compute_qty_remain",
      "line": 256,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_qty_remain(self):",
        "        for rec in self:",
        "            if rec.line_type and rec.line_type != \"item\":"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine._check_qty_done_range",
      "line": 264,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_qty_done_range(self):",
        "        for rec in self:",
        "            if rec.line_type and rec.line_type != \"item\":"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine._compute_structure_levels",
      "line": 289,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_structure_levels(self):",
        "        for rec in self:",
        "            unit_node = False"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine._compute_code_segments",
      "line": 304,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_code_segments(self):",
        "        for rec in self:",
        "            code = (rec.code or \"\").strip()"
      ]
    },
    {
      "file": "models/core/boq.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqLine.unlink",
      "line": 338,
      "decorators": [],
      "context_snippet": [
        "    def unlink(self):",
        "        frozen_projects = set()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/contract_recon_summary.py",
      "symbol_type": "module",
      "qualified_name": "contract_recon_summary",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/core/contract_recon_summary.py",
      "symbol_type": "class",
      "qualified_name": "ScContractReconSummary",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class ScContractReconSummary(models.Model):",
        "    _name = \"sc.contract.recon.summary\"",
        "    _description = \"Contract Reconciliation Summary\""
      ]
    },
    {
      "file": "models/core/contract_recon_summary.py",
      "symbol_type": "method",
      "qualified_name": "ScContractReconSummary._compute_totals",
      "line": 77,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_totals(self):",
        "        SettlementLine = self.env[\"sc.settlement.order.line\"]",
        "        Settlement = self.env[\"sc.settlement.order\"]"
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "class",
      "qualified_name": "ProjectBudgetBoqLine",
      "line": 155,
      "decorators": [],
      "context_snippet": [
        "class ProjectBudgetBoqLine(models.Model):",
        "    _name = \"project.budget.boq.line\"",
        "    _description = \"项目预算 / 中标清单行\""
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "class",
      "qualified_name": "ProjectCostCode",
      "line": 262,
      "decorators": [],
      "context_snippet": [
        "class ProjectCostCode(models.Model):",
        "    _name = \"project.cost.code\"",
        "    _description = \"项目成本科目\""
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "class",
      "qualified_name": "ProjectCostLedger",
      "line": 305,
      "decorators": [],
      "context_snippet": [
        "class ProjectCostLedger(models.Model):",
        "    _name = \"project.cost.ledger\"",
        "    _description = \"项目成本台账\""
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "class",
      "qualified_name": "ProjectBudgetCostAlloc",
      "line": 460,
      "decorators": [],
      "context_snippet": [
        "class ProjectBudgetCostAlloc(models.Model):",
        "    _name = \"project.budget.cost.alloc\"",
        "    _description = \"预算清单与成本科目分摊\""
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBudgetBoqLine._compute_bidded_amount",
      "line": 257,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_bidded_amount(self):",
        "        for line in self:",
        "            qty = line.qty_bidded or 0.0"
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostCode._compute_hierarchy",
      "line": 296,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_hierarchy(self):",
        "        for rec in self:",
        "            if rec.parent_id:"
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostLedger._compute_period_value",
      "line": 363,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _compute_period_value(date_value):",
        "        if not date_value:",
        "            return False"
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostLedger._get_or_create_period",
      "line": 369,
      "decorators": [],
      "context_snippet": [
        "    def _get_or_create_period(self, project_id, period_value):",
        "        Period = self.env[\"project.cost.period\"].sudo()",
        "        period = Period.search("
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostLedger._ensure_period_unlocked",
      "line": 387,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_period_unlocked(self, period_rec, operation_label):",
        "        if period_rec and period_rec.locked:",
        "            raise_guard("
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostLedger.create",
      "line": 397,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            if not vals.get(\"date\"):"
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostLedger.write",
      "line": 428,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        Period = self.env[\"project.cost.period\"]",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/cost_domain.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostLedger.unlink",
      "line": 454,
      "decorators": [],
      "context_snippet": [
        "    def unlink(self):",
        "        for rec in self:",
        "            self._ensure_period_unlocked(rec.period_id, \"Delete\")"
      ]
    },
    {
      "file": "models/core/cost_period.py",
      "symbol_type": "module",
      "qualified_name": "cost_period",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models",
        ""
      ]
    },
    {
      "file": "models/core/cost_period.py",
      "symbol_type": "class",
      "qualified_name": "ProjectCostPeriod",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ProjectCostPeriod(models.Model):",
        "    _name = \"project.cost.period\"",
        "    _description = \"项目成本期间\""
      ]
    },
    {
      "file": "models/core/cost_period.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostPeriod._audit_period",
      "line": 29,
      "decorators": [],
      "context_snippet": [
        "    def _audit_period(self, event_code, before_locked, after_locked, reason=None, require_reason=False):",
        "        Audit = self.env[\"sc.audit.log\"]",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/cost_period.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostPeriod.action_lock_period",
      "line": 45,
      "decorators": [],
      "context_snippet": [
        "    def action_lock_period(self, reason=None):",
        "        for rec in self:",
        "            before_locked = rec.locked"
      ]
    },
    {
      "file": "models/core/cost_period.py",
      "symbol_type": "method",
      "qualified_name": "ProjectCostPeriod.action_unlock_period",
      "line": 65,
      "decorators": [],
      "context_snippet": [
        "    def action_unlock_period(self, reason=None):",
        "        for rec in self:",
        "            if not reason:"
      ]
    },
    {
      "file": "models/core/funding_baseline.py",
      "symbol_type": "module",
      "qualified_name": "funding_baseline",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        "from odoo.exceptions import UserError"
      ]
    },
    {
      "file": "models/core/funding_baseline.py",
      "symbol_type": "class",
      "qualified_name": "ProjectFundingBaseline",
      "line": 6,
      "decorators": [],
      "context_snippet": [
        "class ProjectFundingBaseline(models.Model):",
        "    _name = \"project.funding.baseline\"",
        "    _description = \"Project Funding Baseline\""
      ]
    },
    {
      "file": "models/core/funding_baseline.py",
      "symbol_type": "method",
      "qualified_name": "ProjectFundingBaseline._check_funding_ready",
      "line": 42,
      "decorators": [],
      "context_snippet": [
        "    def _check_funding_ready(self, project):",
        "        if not project.is_funding_ready():",
        "            raise UserError(\"项目未满足资金承载条件，不能建立资金基准。\")"
      ]
    },
    {
      "file": "models/core/funding_baseline.py",
      "symbol_type": "method",
      "qualified_name": "ProjectFundingBaseline._check_single_active",
      "line": 46,
      "decorators": [],
      "context_snippet": [
        "    def _check_single_active(self, project, exclude_ids=None):",
        "        domain = [",
        "            (\"project_id\", \"=\", project.id),"
      ]
    },
    {
      "file": "models/core/funding_baseline.py",
      "symbol_type": "method",
      "qualified_name": "ProjectFundingBaseline.create",
      "line": 57,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            project_id = vals.get(\"project_id\")"
      ]
    },
    {
      "file": "models/core/funding_baseline.py",
      "symbol_type": "method",
      "qualified_name": "ProjectFundingBaseline.write",
      "line": 67,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        state_to_active = vals.get(\"state\") == \"active\"",
        "        project_id = vals.get(\"project_id\")"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "module",
      "qualified_name": "material_plan",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _, api, fields, models",
        "from odoo.tools.safe_eval import safe_eval"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "class",
      "qualified_name": "ProjectMaterialPlan",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ProjectMaterialPlan(models.Model):",
        "    _name = \"project.material.plan\"",
        "    _description = \"物资计划\""
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "class",
      "qualified_name": "ProjectMaterialPlanLine",
      "line": 221,
      "decorators": [],
      "context_snippet": [
        "class ProjectMaterialPlanLine(models.Model):",
        "    _name = \"project.material.plan.line\"",
        "    _description = \"物资计划行\""
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan._get_material_approver",
      "line": 47,
      "decorators": [],
      "context_snippet": [
        "    def _get_material_approver(self):",
        "        self.ensure_one()",
        "        # 物资负责人（若项目上有定义）"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_submit",
      "line": 69,
      "decorators": [],
      "context_snippet": [
        "    def action_submit(self):",
        "        seq = self.env[\"ir.sequence\"]",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_approve",
      "line": 97,
      "decorators": [],
      "context_snippet": [
        "    def action_approve(self):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_reject",
      "line": 113,
      "decorators": [],
      "context_snippet": [
        "    def action_reject(self, reason=None):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_on_tier_approved",
      "line": 129,
      "decorators": [],
      "context_snippet": [
        "    def action_on_tier_approved(self):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_on_tier_rejected",
      "line": 142,
      "decorators": [],
      "context_snippet": [
        "    def action_on_tier_rejected(self, reason=None):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_done",
      "line": 154,
      "decorators": [],
      "context_snippet": [
        "    def action_done(self):",
        "        for rec in self:",
        "            if rec.state != \"approved\":"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_cancel",
      "line": 162,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self):",
        "        for rec in self:",
        "            if rec.state in (\"done\", \"cancel\"):"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan._compute_po_counts",
      "line": 170,
      "decorators": [],
      "context_snippet": [
        "    def _compute_po_counts(self):",
        "        PurchaseLine = self.env[\"purchase.order.line\"].sudo()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_view_purchase_orders",
      "line": 181,
      "decorators": [],
      "context_snippet": [
        "    def action_view_purchase_orders(self):",
        "        self.ensure_one()",
        "        action = self.env[\"ir.actions.act_window\"]._for_xml_id(\"purchase.purchase_rfq\")"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlan.action_view_purchase_lines",
      "line": 195,
      "decorators": [],
      "context_snippet": [
        "    def action_view_purchase_lines(self):",
        "        self.ensure_one()",
        "        action = self.env[\"ir.actions.act_window\"]._for_xml_id(\"purchase.purchase_line_form_action\")"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlanLine.create",
      "line": 245,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        Product = self.env[\"product.product\"]",
        "        for vals in vals_list:"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlanLine._onchange_product_id_set_uom",
      "line": 254,
      "decorators": [
        "api.onchange"
      ],
      "context_snippet": [
        "    def _onchange_product_id_set_uom(self):",
        "        for line in self:",
        "            if line.product_id:"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlanLine._check_uom_category",
      "line": 260,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_uom_category(self):",
        "        for line in self:",
        "            if line.product_id and line.uom_id:"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlanLine.write",
      "line": 268,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        lock_fields = {\"product_id\", \"spec\", \"quantity\", \"uom_id\", \"vendor_id\", \"note\"}",
        "        for line in self:"
      ]
    },
    {
      "file": "models/core/material_plan.py",
      "symbol_type": "method",
      "qualified_name": "ProjectMaterialPlanLine.unlink",
      "line": 275,
      "decorators": [],
      "context_snippet": [
        "    def unlink(self):",
        "        for line in self:",
        "            if line.plan_id and line.plan_id.state != \"draft\":"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "module",
      "qualified_name": "payment_ledger",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models, _",
        "from odoo.exceptions import UserError, ValidationError"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "class",
      "qualified_name": "PaymentLedger",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class PaymentLedger(models.Model):",
        "    _name = \"payment.ledger\"",
        "    _description = \"Payment Ledger\""
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "method",
      "qualified_name": "PaymentLedger._check_request_state",
      "line": 61,
      "decorators": [],
      "context_snippet": [
        "    def _check_request_state(self, request):",
        "        if not request or request.state != \"approved\":",
        "            raise UserError(\"付款申请未处于已批准状态，不能登记付款。\")"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "method",
      "qualified_name": "PaymentLedger._check_amount",
      "line": 69,
      "decorators": [],
      "context_snippet": [
        "    def _check_amount(self):",
        "        for rec in self:",
        "            if (rec.amount or 0.0) <= 0.0:"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "method",
      "qualified_name": "PaymentLedger._check_overpay",
      "line": 74,
      "decorators": [],
      "context_snippet": [
        "    def _check_overpay(self, exclude_ids=None):",
        "        for rec in self:",
        "            req = rec.payment_request_id"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "method",
      "qualified_name": "PaymentLedger.create",
      "line": 93,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        if not self.env.context.get(\"allow_payment_ledger_create\"):",
        "            raise UserError(\"请通过付款申请登记付款记录。\")"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "method",
      "qualified_name": "PaymentLedger.write",
      "line": 114,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        for rec in self:",
        "            request_id = vals.get(\"payment_request_id\", rec.payment_request_id.id)"
      ]
    },
    {
      "file": "models/core/payment_ledger.py",
      "symbol_type": "method",
      "qualified_name": "PaymentLedger.unlink",
      "line": 124,
      "decorators": [],
      "context_snippet": [
        "    def unlink(self):",
        "        for rec in self:",
        "            self._check_request_state(rec.payment_request_id)"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "module",
      "qualified_name": "payment_request",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _, api, fields, models",
        "from odoo.exceptions import ValidationError, UserError"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "class",
      "qualified_name": "PaymentRequest",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "class PaymentRequest(models.Model):",
        "    _name = \"payment.request\"",
        "    _description = \"Payment Request\""
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._get_active_funding_baseline",
      "line": 180,
      "decorators": [],
      "context_snippet": [
        "    def _get_active_funding_baseline(self, project):",
        "        baseline = self.env[\"project.funding.baseline\"].search(",
        "            ["
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._get_reserved_amount",
      "line": 192,
      "decorators": [],
      "context_snippet": [
        "    def _get_reserved_amount(self, project, exclude_ids=None):",
        "        domain = [",
        "            (\"project_id\", \"=\", project.id),"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_project_funding_gate",
      "line": 203,
      "decorators": [],
      "context_snippet": [
        "    def _check_project_funding_gate(self, project, amount, exclude_ids=None):",
        "        if not project or not project.is_funding_ready():",
        "            raise UserError(\"项目未满足资金承载条件，不能提交付款申请。\")"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._enforce_funding_gate",
      "line": 220,
      "decorators": [],
      "context_snippet": [
        "    def _enforce_funding_gate(self, vals=None):",
        "        vals = vals or {}",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_project_lifecycle",
      "line": 231,
      "decorators": [],
      "context_snippet": [
        "    def _check_project_lifecycle(self, project, target_state):",
        "        if not project:",
        "            return"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_settlement_state",
      "line": 244,
      "decorators": [],
      "context_snippet": [
        "    def _check_settlement_state(self, settlement):",
        "        if not settlement:",
        "            return"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.create",
      "line": 257,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        seq = self.env[\"ir.sequence\"]",
        "        for vals in vals_list:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.write",
      "line": 268,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        if \"state\" in vals and not self.env.context.get(\"allow_transition\"):",
        "            sample = self[:1]"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._get_attachment_count",
      "line": 294,
      "decorators": [],
      "context_snippet": [
        "    def _get_attachment_count(self):",
        "        self.ensure_one()",
        "        if \"message_attachment_count\" in self._fields:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._snapshot_audit_payload",
      "line": 304,
      "decorators": [],
      "context_snippet": [
        "    def _snapshot_audit_payload(self):",
        "        self.ensure_one()",
        "        return {"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._audit_transition",
      "line": 314,
      "decorators": [],
      "context_snippet": [
        "    def _audit_transition(self, event_code, before, after, reason=None, require_reason=False, action_name=None):",
        "        self.ensure_one()",
        "        return self.env[\"sc.audit.log\"].write_event("
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._compute_settlement_amount_insufficient",
      "line": 330,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_settlement_amount_insufficient(self):",
        "        for rec in self:",
        "            if not rec.settlement_id:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._compute_settlement_match_flags",
      "line": 340,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_settlement_match_flags(self):",
        "        for rec in self:",
        "            state = rec.settlement_id.compliance_state if rec.settlement_id else False"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._get_bool_param",
      "line": 346,
      "decorators": [],
      "context_snippet": [
        "    def _get_bool_param(self, key, default=True):",
        "        val = self.env[\"ir.config_parameter\"].sudo().get_param(key)",
        "        if val is None:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._compute_move_type",
      "line": 352,
      "decorators": [],
      "context_snippet": [
        "    def _compute_move_type(self):",
        "        for rec in self:",
        "            rec.move_type = rec.type"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._compute_payment_totals",
      "line": 357,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_payment_totals(self):",
        "        paid_map = {}",
        "        if self.ids:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_can_done",
      "line": 376,
      "decorators": [],
      "context_snippet": [
        "    def _check_can_done(self):",
        "        for rec in self:",
        "            if rec.state != \"approved\":"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._onchange_type_set_contract_domain",
      "line": 392,
      "decorators": [
        "api.onchange"
      ],
      "context_snippet": [
        "    def _onchange_type_set_contract_domain(self):",
        "        domain = {}",
        "        expected_contract_type = \"in\" if self.type == \"pay\" else \"out\""
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_settlement_compliance_or_raise",
      "line": 403,
      "decorators": [],
      "context_snippet": [
        "    def _check_settlement_compliance_or_raise(self, strict=True):",
        "        self.ensure_one()",
        "        if not self.settlement_id:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_settlement_consistency",
      "line": 417,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_settlement_consistency(self):",
        "        for rec in self:",
        "            settle = rec.settlement_id"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_contract_direction",
      "line": 437,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_contract_direction(self):",
        "        for rec in self:",
        "            if not rec.contract_id:"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_submit",
      "line": 503,
      "decorators": [],
      "context_snippet": [
        "    def action_submit(self):",
        "        if not self.env.user.has_group(\"smart_construction_core.group_sc_cap_finance_user\"):",
        "            raise ValidationError(_(\"你没有提交付款/收款申请的权限。\"))"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_approve",
      "line": 547,
      "decorators": [],
      "context_snippet": [
        "    def action_approve(self):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_set_approved",
      "line": 580,
      "decorators": [],
      "context_snippet": [
        "    def action_set_approved(self):",
        "        self._enforce_funding_gate({\"state\": \"approved\"})",
        "        result = None"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_done",
      "line": 589,
      "decorators": [],
      "context_snippet": [
        "    def action_done(self):",
        "        if not self.env.user.has_group(\"smart_construction_core.group_sc_cap_finance_manager\"):",
        "            raise ValidationError(_(\"你没有完成付款/收款申请的权限。\"))"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._ensure_payment_ledger",
      "line": 614,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_payment_ledger(self, amount=None, paid_at=None, ref=None, note=None):",
        "        self.ensure_one()",
        "        Ledger = self.env[\"payment.ledger\"].with_context(allow_payment_ledger_create=True)"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_cancel",
      "line": 631,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self):",
        "        if not self.env.user.has_group(\"smart_construction_core.group_sc_cap_finance_manager\"):",
        "            raise ValidationError(_(\"你没有取消付款/收款申请的权限。\"))"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest._check_state_from_condition",
      "line": 636,
      "decorators": [],
      "context_snippet": [
        "    def _check_state_from_condition(self):",
        "        self.ensure_one()",
        "        parent = getattr(super(), \"_check_state_from_condition\", None)"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_on_tier_approved",
      "line": 642,
      "decorators": [],
      "context_snippet": [
        "    def action_on_tier_approved(self):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/payment_request.py",
      "symbol_type": "method",
      "qualified_name": "PaymentRequest.action_on_tier_rejected",
      "line": 662,
      "decorators": [],
      "context_snippet": [
        "    def action_on_tier_rejected(self, reason=None):",
        "        for rec in self:",
        "            if rec.state != \"submit\":"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "module",
      "qualified_name": "progress_entry",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "class",
      "qualified_name": "ProjectProgressEntry",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ProjectProgressEntry(models.Model):",
        "    _name = \"project.progress.entry\"",
        "    _description = \"项目进度计量记录\""
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry._ensure_manager_role",
      "line": 44,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_manager_role(self):",
        "        if not self.env.user.has_group(\"smart_construction_core.group_sc_cap_project_manager\"):",
        "            raise_guard("
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry._ensure_immutable",
      "line": 53,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_immutable(self, operation_label=\"Write\"):",
        "        for rec in self:",
        "            if rec.state == \"submitted\" and not self.env.context.get(\"allow_progress_edit\"):"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry._ensure_no_direct_state_write",
      "line": 63,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_no_direct_state_write(self, vals):",
        "        if \"state\" in vals and not self.env.context.get(\"allow_progress_transition\"):",
        "            raise_guard("
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry._audit_transition",
      "line": 72,
      "decorators": [],
      "context_snippet": [
        "    def _audit_transition(self, event_code, action, before_state, after_state, reason=None, require_reason=False):",
        "        Audit = self.env[\"sc.audit.log\"]",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry.create",
      "line": 99,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            self._ensure_no_direct_state_write(vals)"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry.write",
      "line": 111,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        self._ensure_no_direct_state_write(vals)",
        "        self._ensure_immutable(\"Write\")"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry.unlink",
      "line": 116,
      "decorators": [],
      "context_snippet": [
        "    def unlink(self):",
        "        self._ensure_immutable(\"Delete\")",
        "        return super().unlink()"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry.action_submit_progress",
      "line": 120,
      "decorators": [],
      "context_snippet": [
        "    def action_submit_progress(self):",
        "        for rec in self:",
        "            if rec.project_id:"
      ]
    },
    {
      "file": "models/core/progress_entry.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProgressEntry.action_revert_progress",
      "line": 135,
      "decorators": [],
      "context_snippet": [
        "    def action_revert_progress(self, reason=None):",
        "        self._ensure_manager_role()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/project_budget.py",
      "symbol_type": "module",
      "qualified_name": "project_budget",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models",
        ""
      ]
    },
    {
      "file": "models/core/project_budget.py",
      "symbol_type": "class",
      "qualified_name": "ProjectBudget",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class ProjectBudget(models.Model):",
        "    _name = \"project.budget\"",
        "    _inherit = [\"project.budget\", \"mail.thread\", \"mail.activity.mixin\"]"
      ]
    },
    {
      "file": "models/core/project_budget.py",
      "symbol_type": "class",
      "qualified_name": "ProjectBudgetLine",
      "line": 12,
      "decorators": [],
      "context_snippet": [
        "class ProjectBudgetLine(models.Model):",
        "    _name = \"project.budget.line\"",
        "    _description = \"Project Budget Line\""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "module",
      "qualified_name": "project_core",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from collections import defaultdict",
        "import logging"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "class",
      "qualified_name": "ScProjectStructure",
      "line": 19,
      "decorators": [],
      "context_snippet": [
        "class ScProjectStructure(models.Model):",
        "    _name = 'sc.project.structure'",
        "    _description = '项目工程结构（WBS）'"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "class",
      "qualified_name": "ProjectProjectStage",
      "line": 234,
      "decorators": [],
      "context_snippet": [
        "class ProjectProjectStage(models.Model):",
        "    _inherit = \"project.project.stage\"",
        "    _description = \"项目阶段\""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "class",
      "qualified_name": "ProjectProject",
      "line": 251,
      "decorators": [],
      "context_snippet": [
        "class ProjectProject(models.Model):",
        "    _inherit = 'project.project'",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "class",
      "qualified_name": "ProjectResponsibility",
      "line": 2049,
      "decorators": [],
      "context_snippet": [
        "class ProjectResponsibility(models.Model):",
        "    _name = 'project.responsibility'",
        "    _description = '项目责任矩阵'"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStructure._compute_display_label",
      "line": 112,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_display_label(self):",
        "        for rec in self:",
        "            if rec.code and rec.name and rec.code != rec.name:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStructure._compute_level",
      "line": 120,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_level(self):",
        "        for rec in self:",
        "            rec.level = (rec.parent_id.level or 0) + 1 if rec.parent_id else 1"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStructure._compute_boq_line_all_ids",
      "line": 142,
      "decorators": [],
      "context_snippet": [
        "    def _compute_boq_line_all_ids(self):",
        "        BoqLine = self.env['project.boq.line']",
        "        for node in self:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStructure._exec_structure_action",
      "line": 159,
      "decorators": [],
      "context_snippet": [
        "    def _exec_structure_action(self, view_key):",
        "        ctx = dict(self.env.context or {})",
        "        project_id = False"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStructure.action_open_exec_wbs",
      "line": 218,
      "decorators": [],
      "context_snippet": [
        "    def action_open_exec_wbs(self):",
        "        return self._exec_structure_action(",
        "            \"smart_construction_core.action_exec_structure_wbs\","
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStructure.action_open_exec_structure",
      "line": 224,
      "decorators": [],
      "context_snippet": [
        "    def action_open_exec_structure(self):",
        "        return self._exec_structure_action(",
        "            \"smart_construction_core.action_exec_structure_structure\","
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._exec_structure_action",
      "line": 273,
      "decorators": [],
      "context_snippet": [
        "    def _exec_structure_action(self, view_key):",
        "        ctx = dict(self.env.context or {})",
        "        project_id = self.id if self else False"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._stage_has_default_column",
      "line": 350,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _stage_has_default_column(self):",
        "        return self._has_column(\"project_project_stage\", \"is_default\")",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._default_stage_id",
      "line": 354,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _default_stage_id(self):",
        "        # 关键 guard：fresh DB 装模块时，列可能还没创建",
        "        if not self._stage_has_default_column():"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._get_stage_for_lifecycle",
      "line": 364,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _get_stage_for_lifecycle(self, lifecycle_state):",
        "        xmlid = self._STAGE_XMLID_BY_LIFECYCLE.get(lifecycle_state)",
        "        if not xmlid:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._get_stage_by_key",
      "line": 371,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _get_stage_by_key(self, key):",
        "        xmlid = self._STAGE_XMLID_BY_KEY.get(key)",
        "        if not xmlid:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._stage_key_rank",
      "line": 378,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _stage_key_rank(self, key):",
        "        order = [",
        "            'planning',"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_has_execution_signal",
      "line": 391,
      "decorators": [],
      "context_snippet": [
        "    def _sc_has_execution_signal(self):",
        "        self.ensure_one()",
        "        if (self.boq_line_count or 0) >= 1:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_has_settlement_signal",
      "line": 401,
      "decorators": [],
      "context_snippet": [
        "    def _sc_has_settlement_signal(self):",
        "        self.ensure_one()",
        "        Settlement = self.env['sc.settlement.order'].sudo()"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_is_settlement_complete",
      "line": 412,
      "decorators": [],
      "context_snippet": [
        "    def _sc_is_settlement_complete(self):",
        "        self.ensure_one()",
        "        Settlement = self.env['sc.settlement.order'].sudo()"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_compute_stage_key",
      "line": 426,
      "decorators": [],
      "context_snippet": [
        "    def _sc_compute_stage_key(self):",
        "        self.ensure_one()",
        "        reason = ''"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sync_stage_from_signals",
      "line": 467,
      "decorators": [],
      "context_snippet": [
        "    def _sync_stage_from_signals(self):",
        "        for project in self:",
        "            key = project._sc_compute_stage_key()"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sync_stage_from_lifecycle",
      "line": 489,
      "decorators": [],
      "context_snippet": [
        "    def _sync_stage_from_lifecycle(self, lifecycle_state=None):",
        "        for project in self:",
        "            state = lifecycle_state or project.lifecycle_state"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._get_stage_key_from_stage",
      "line": 496,
      "decorators": [],
      "context_snippet": [
        "    def _get_stage_key_from_stage(self, stage):",
        "        if not stage:",
        "            return False"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_sc_stage_sync",
      "line": 514,
      "decorators": [],
      "context_snippet": [
        "    def action_sc_stage_sync(self):",
        "        self._sync_stage_from_signals()",
        "        return True"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.is_funding_ready",
      "line": 591,
      "decorators": [],
      "context_snippet": [
        "    def is_funding_ready(self):",
        "        self.ensure_one()",
        "        return bool(self.funding_enabled and self.code)"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_costs",
      "line": 933,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_costs(self):",
        "        for project in self:",
        "            project.cost_variance = (project.budget_total or 0.0) - (project.cost_actual or 0.0)"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_pay_overview",
      "line": 945,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_pay_overview(self):",
        "        contract_map = defaultdict(float)",
        "        settlement_map = defaultdict(float)"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_funding_cap_amount",
      "line": 1006,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_funding_cap_amount(self):",
        "        amount_map = {}",
        "        if self.ids:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_funding_remaining_amount",
      "line": 1029,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_funding_remaining_amount(self):",
        "        reserved_map = {}",
        "        if self.ids:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.create",
      "line": 1051,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        sequence = self.env['ir.sequence']",
        "        default_stage = self._default_stage_id()"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.init",
      "line": 1072,
      "decorators": [],
      "context_snippet": [
        "    def init(self):",
        "        # 确保老项目也有默认阶段",
        "        res = super().init()"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_boq_stats",
      "line": 1084,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_boq_stats(self):",
        "        amount_map = {}",
        "        install_map = {}"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_boq_status",
      "line": 1114,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_boq_status(self):",
        "        projects = self",
        "        for project in projects:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_document_stats",
      "line": 1166,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_document_stats(self):",
        "        can_document = self._can_read_model('sc.project.document')",
        "        for project in self:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_cost_control_stats",
      "line": 1198,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_cost_control_stats(self):",
        "        ledger_amount_map = {}",
        "        ledger_count_map = {}"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_dashboard_overview",
      "line": 1267,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_dashboard_overview(self):",
        "        has_account_access = self.env.user.has_group('account.group_account_readonly')",
        "        can_payment = ('payment.request' in self.env) and self._can_read_model('payment.request')"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_cost_ledger",
      "line": 1364,
      "decorators": [],
      "context_snippet": [
        "    def action_open_cost_ledger(self):",
        "        self.ensure_one()",
        "        return {"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_progress_entries",
      "line": 1378,
      "decorators": [],
      "context_snippet": [
        "    def action_open_progress_entries(self):",
        "        self.ensure_one()",
        "        return {"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_wbs_count",
      "line": 1394,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_wbs_count(self):",
        "        can_wbs = self._can_read_model('sc.project.structure')",
        "        for project in self:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_tender_stats",
      "line": 1415,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_tender_stats(self):",
        "        can_tender = self._can_read_model('tender.bid')",
        "        for project in self:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_overview_counts",
      "line": 1420,
      "decorators": [],
      "context_snippet": [
        "    def _compute_overview_counts(self):",
        "        ids = self.ids",
        "        service = self.env[\"sc.project.overview.service\"]"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_stage_progress",
      "line": 1433,
      "decorators": [],
      "context_snippet": [
        "    def _compute_stage_progress(self):",
        "        Item = self.env[\"sc.project.stage.requirement.item\"]",
        "        for project in self:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_is_requirement_done",
      "line": 1450,
      "decorators": [],
      "context_snippet": [
        "    def _sc_is_requirement_done(self, item):",
        "        target_field = (item.target_field or \"\").strip()",
        "        if not target_field:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_project_budget",
      "line": 1459,
      "decorators": [],
      "context_snippet": [
        "    def action_open_project_budget(self):",
        "        return self._action_open_related('smart_construction_core.action_project_budget')",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_project_cost_ledger",
      "line": 1462,
      "decorators": [],
      "context_snippet": [
        "    def action_open_project_cost_ledger(self):",
        "        return self._action_open_related('smart_construction_core.action_project_cost_ledger')",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_project_progress_entry",
      "line": 1571,
      "decorators": [],
      "context_snippet": [
        "    def action_open_project_progress_entry(self):",
        "        return self._action_open_related('smart_construction_core.action_project_progress_entry')",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_cost_compare",
      "line": 1574,
      "decorators": [],
      "context_snippet": [
        "    def action_open_cost_compare(self):",
        "        return self._action_open_related('smart_construction_core.action_project_cost_compare')",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_profit_compare",
      "line": 1577,
      "decorators": [],
      "context_snippet": [
        "    def action_open_profit_compare(self):",
        "        return self._action_open_related('smart_construction_core.action_project_profit_compare')",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_wbs",
      "line": 1580,
      "decorators": [],
      "context_snippet": [
        "    def action_open_wbs(self):",
        "        return self.action_open_exec_wbs()",
        ""
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_exec_wbs",
      "line": 1583,
      "decorators": [],
      "context_snippet": [
        "    def action_open_exec_wbs(self):",
        "        self.ensure_one()",
        "        return self._exec_structure_action(\"wbs\")"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_open_exec_structure",
      "line": 1587,
      "decorators": [],
      "context_snippet": [
        "    def action_open_exec_structure(self):",
        "        self.ensure_one()",
        "        return self._exec_structure_action(\"structure\")"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_required_fields_for_transition",
      "line": 1900,
      "decorators": [],
      "context_snippet": [
        "    def _sc_required_fields_for_transition(self, target_state):",
        "        return {",
        "            \"in_progress\": ["
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._sc_validate_for_transition",
      "line": 1909,
      "decorators": [],
      "context_snippet": [
        "    def _sc_validate_for_transition(self, target_state):",
        "        required_fields = self._sc_required_fields_for_transition(target_state)",
        "        if not required_fields:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._validate_lifecycle_transition",
      "line": 1942,
      "decorators": [],
      "context_snippet": [
        "    def _validate_lifecycle_transition(self, target_state):",
        "        for project in self:",
        "            ScStateMachine.assert_transition("
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.write",
      "line": 1964,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        if self.env.context.get(\"sc_autosave\") and all(",
        "            project.lifecycle_state == \"draft\" for project in self"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._guard_project_close_by_settlement",
      "line": 1998,
      "decorators": [],
      "context_snippet": [
        "    def _guard_project_close_by_settlement(self, target_state):",
        "        Settlement = self.env[\"project.settlement\"]",
        "        count = Settlement.search_count("
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._guard_project_close_by_payment",
      "line": 2016,
      "decorators": [],
      "context_snippet": [
        "    def _guard_project_close_by_payment(self, target_state):",
        "        Payment = self.env[\"payment.request\"]",
        "        count = Payment.search_count("
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._guard_project_close_by_boq",
      "line": 2034,
      "decorators": [],
      "context_snippet": [
        "    def _guard_project_close_by_boq(self, target_state):",
        "        if not (self.boq_line_count or 0):",
        "            label = ScStateMachine.label(ScStateMachine.PROJECT, target_state)"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "function",
      "qualified_name": "_match_measure_group",
      "line": 1662,
      "decorators": [],
      "context_snippet": [
        "            def _match_measure_group(line):",
        "                name_text = (line.name or '') + ' ' + (line.division_name or '') + ' ' + (line.sheet_name or '')",
        "                for group_name, keywords in measure_group_rules:"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "function",
      "qualified_name": "_tag_scope",
      "line": 1721,
      "decorators": [],
      "context_snippet": [
        "            def _tag_scope(node, scope):",
        "                if node and node.biz_scope != scope:",
        "                    node.biz_scope = scope"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "function",
      "qualified_name": "_handle_work_lines",
      "line": 1734,
      "decorators": [],
      "context_snippet": [
        "            def _handle_work_lines(lines_subset):",
        "                for ln in lines_subset:",
        "                    code = (ln.code or '').strip()"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "function",
      "qualified_name": "_handle_measure",
      "line": 1792,
      "decorators": [],
      "context_snippet": [
        "            def _handle_measure(lines_subset, scope_key, major_label, seq_major):",
        "                if not lines_subset:",
        "                    return"
      ]
    },
    {
      "file": "models/core/project_core.py",
      "symbol_type": "function",
      "qualified_name": "_handle_fee_tax",
      "line": 1826,
      "decorators": [],
      "context_snippet": [
        "            def _handle_fee_tax(lines_subset, scope_key, major_label, seq_major):",
        "                if not lines_subset:",
        "                    return"
      ]
    },
    {
      "file": "models/core/project_dashboard.py",
      "symbol_type": "module",
      "qualified_name": "project_dashboard",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/core/project_dashboard.py",
      "symbol_type": "class",
      "qualified_name": "ProjectProject",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class ProjectProject(models.Model):",
        "    _inherit = \"project.project\"",
        ""
      ]
    },
    {
      "file": "models/core/project_dashboard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_dashboard_metrics",
      "line": 41,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_dashboard_metrics(self):",
        "        for rec in self:",
        "            budget = rec.budget_total or 0.0"
      ]
    },
    {
      "file": "models/core/project_dashboard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_dashboard_alerts",
      "line": 66,
      "decorators": [],
      "context_snippet": [
        "    def _compute_dashboard_alerts(self):",
        "        for rec in self:",
        "            alerts = []"
      ]
    },
    {
      "file": "models/core/project_project_financial.py",
      "symbol_type": "module",
      "qualified_name": "project_project_financial",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import models",
        ""
      ]
    },
    {
      "file": "models/core/project_project_financial.py",
      "symbol_type": "class",
      "qualified_name": "ProjectProjectFinancial",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class ProjectProjectFinancial(models.Model):",
        "    _inherit = \"project.project\"",
        ""
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "module",
      "qualified_name": "purchase_extend",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "class",
      "qualified_name": "PurchaseOrder",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class PurchaseOrder(models.Model):",
        "    _inherit = \"purchase.order\"",
        ""
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "class",
      "qualified_name": "PurchaseOrderLine",
      "line": 56,
      "decorators": [],
      "context_snippet": [
        "class PurchaseOrderLine(models.Model):",
        "    _inherit = \"purchase.order.line\"",
        ""
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "method",
      "qualified_name": "PurchaseOrder.button_confirm",
      "line": 19,
      "decorators": [],
      "context_snippet": [
        "    def button_confirm(self):",
        "        for order in self:",
        "            if order.project_id:"
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "method",
      "qualified_name": "PurchaseOrder._is_cost_enabled",
      "line": 31,
      "decorators": [],
      "context_snippet": [
        "    def _is_cost_enabled(self, param_key):",
        "        icp = self.env[\"ir.config_parameter\"].sudo().with_company(self.env.company)",
        "        val = icp.get_param(param_key, default=\"False\")"
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "method",
      "qualified_name": "PurchaseOrder._create_cost_ledger_entries",
      "line": 36,
      "decorators": [],
      "context_snippet": [
        "    def _create_cost_ledger_entries(self):",
        "        ledger_obj = self.env[\"project.cost.ledger\"]",
        "        for order in self:"
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "method",
      "qualified_name": "PurchaseOrderLine.create",
      "line": 88,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            if not vals.get(\"project_id\") and vals.get(\"order_id\"):"
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "method",
      "qualified_name": "PurchaseOrderLine.write",
      "line": 95,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        res = super().write(vals)",
        "        if \"project_id\" in vals and not vals.get(\"project_id\"):"
      ]
    },
    {
      "file": "models/core/purchase_extend.py",
      "symbol_type": "method",
      "qualified_name": "PurchaseOrderLine._prepare_cost_ledger_vals",
      "line": 103,
      "decorators": [],
      "context_snippet": [
        "    def _prepare_cost_ledger_vals(self):",
        "        self.ensure_one()",
        "        project = self.project_id or self.order_id.project_id"
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "module",
      "qualified_name": "settlement",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _, api, fields, models",
        ""
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "class",
      "qualified_name": "ProjectSettlement",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ProjectSettlement(models.Model):",
        "    _name = \"project.settlement\"",
        "    _description = \"Project Settlement\""
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "class",
      "qualified_name": "ProjectSettlementLine",
      "line": 86,
      "decorators": [],
      "context_snippet": [
        "class ProjectSettlementLine(models.Model):",
        "    _name = \"project.settlement.line\"",
        "    _description = \"Project Settlement Line\""
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "method",
      "qualified_name": "ProjectSettlement.create",
      "line": 69,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        seq = self.env[\"ir.sequence\"]",
        "        for vals in vals_list:"
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "method",
      "qualified_name": "ProjectSettlement.action_confirm",
      "line": 76,
      "decorators": [],
      "context_snippet": [
        "    def action_confirm(self):",
        "        self.write({\"state\": \"confirmed\"})",
        ""
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "method",
      "qualified_name": "ProjectSettlement.action_done",
      "line": 79,
      "decorators": [],
      "context_snippet": [
        "    def action_done(self):",
        "        self.write({\"state\": \"done\"})",
        ""
      ]
    },
    {
      "file": "models/core/settlement.py",
      "symbol_type": "method",
      "qualified_name": "ProjectSettlement.action_cancel",
      "line": 82,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self):",
        "        self.write({\"state\": \"cancel\"})",
        ""
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "module",
      "qualified_name": "settlement_order",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _, api, fields, models",
        "from odoo.exceptions import UserError, ValidationError"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "class",
      "qualified_name": "ScSettlementOrder",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class ScSettlementOrder(models.Model):",
        "    _name = \"sc.settlement.order\"",
        "    _description = \"Settlement Order\""
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "class",
      "qualified_name": "ScSettlementOrderLine",
      "line": 400,
      "decorators": [],
      "context_snippet": [
        "class ScSettlementOrderLine(models.Model):",
        "    _name = \"sc.settlement.order.line\"",
        "    _description = \"Settlement Order Line\""
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._compute_amount_total",
      "line": 141,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount_total(self):",
        "        for order in self:",
        "            order.amount_total = sum(order.line_ids.mapped(\"amount\"))"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._check_po_vendor_consistency",
      "line": 146,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_po_vendor_consistency(self):",
        "        for rec in self:",
        "            if not rec.purchase_order_ids or not rec.partner_id:"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._compute_compliance_summary",
      "line": 169,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_compliance_summary(self):",
        "        for rec in self:",
        "            missing = []"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._get_bool_param",
      "line": 217,
      "decorators": [],
      "context_snippet": [
        "    def _get_bool_param(self, key, default=True):",
        "        val = self.env[\"ir.config_parameter\"].sudo().get_param(key)",
        "        if val is None:"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.create",
      "line": 262,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            if vals.get(\"name\", \"新建\") in (False, \"新建\"):"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.action_submit",
      "line": 269,
      "decorators": [],
      "context_snippet": [
        "    def action_submit(self):",
        "        for rec in self:",
        "            rec._check_line_contracts_or_raise()"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.action_approve",
      "line": 277,
      "decorators": [],
      "context_snippet": [
        "    def action_approve(self):",
        "        for rec in self:",
        "            rec._check_line_contracts_or_raise()"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.action_done",
      "line": 285,
      "decorators": [],
      "context_snippet": [
        "    def action_done(self):",
        "        self.write({\"state\": \"done\"})",
        ""
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.action_cancel",
      "line": 288,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self):",
        "        self._check_payments_before_cancel()",
        "        self.write({\"state\": \"cancel\"})"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._check_payments_before_cancel",
      "line": 292,
      "decorators": [],
      "context_snippet": [
        "    def _check_payments_before_cancel(self):",
        "        Payment = self.env[\"payment.request\"]",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.write",
      "line": 310,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        if vals.get(\"state\") == \"cancel\":",
        "            self._check_payments_before_cancel()"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._onchange_contract_id_fill_header",
      "line": 319,
      "decorators": [
        "api.onchange"
      ],
      "context_snippet": [
        "    def _onchange_contract_id_fill_header(self):",
        "        for rec in self:",
        "            c = rec.contract_id"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.create",
      "line": 342,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            if vals.get(\"name\", \"新建\") in (False, \"新建\"):"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder.write",
      "line": 351,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        res = super().write(vals)",
        "        if \"contract_id\" in vals:"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrder._check_line_contracts_or_raise",
      "line": 380,
      "decorators": [],
      "context_snippet": [
        "    def _check_line_contracts_or_raise(self):",
        "        for rec in self:",
        "            for line in rec.line_ids:"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine._compute_amount",
      "line": 436,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount(self):",
        "        for line in self:",
        "            line.amount = (line.qty or 0.0) * (line.price_unit or 0.0)"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine._ensure_manager_role",
      "line": 440,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_manager_role(self):",
        "        if not self.env.user.has_group(\"smart_construction_core.group_sc_cap_project_manager\"):",
        "            raise_guard("
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine._ensure_contract_required",
      "line": 449,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_contract_required(self, contract_id=None):",
        "        if not contract_id:",
        "            raise_guard("
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine._ensure_contract_match",
      "line": 458,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_contract_match(self, contract_id, project_id):",
        "        if not contract_id or not project_id:",
        "            return"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine._audit_contract",
      "line": 470,
      "decorators": [],
      "context_snippet": [
        "    def _audit_contract(self, event_code, before_id, after_id, reason=None, require_reason=False):",
        "        Audit = self.env[\"sc.audit.log\"]",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine.create",
      "line": 487,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            if not vals.get(\"contract_id\") and vals.get(\"settlement_id\"):"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine.write",
      "line": 499,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        if \"contract_id\" in vals and not self.env.context.get(\"allow_contract_change\"):",
        "            raise_guard("
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine.action_bind_contract",
      "line": 520,
      "decorators": [],
      "context_snippet": [
        "    def action_bind_contract(self, contract_id, reason=None):",
        "        self.ensure_one()",
        "        self._ensure_contract_required(contract_id)"
      ]
    },
    {
      "file": "models/core/settlement_order.py",
      "symbol_type": "method",
      "qualified_name": "ScSettlementOrderLine.action_unbind_contract",
      "line": 546,
      "decorators": [],
      "context_snippet": [
        "    def action_unbind_contract(self, reason=None):",
        "        self.ensure_one()",
        "        self._ensure_manager_role()"
      ]
    },
    {
      "file": "models/core/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import project_core",
        "from . import purchase_extend"
      ]
    },
    {
      "file": "models/projection/cost_report.py",
      "symbol_type": "module",
      "qualified_name": "cost_report",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models, tools",
        ""
      ]
    },
    {
      "file": "models/projection/profit_report.py",
      "symbol_type": "module",
      "qualified_name": "profit_report",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models, tools",
        ""
      ]
    },
    {
      "file": "models/projection/profit_report.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProfitCompare.init",
      "line": 35,
      "decorators": [],
      "context_snippet": [
        "    def init(self):",
        "        tools.drop_view_if_exists(self._cr, self._table)",
        "        self._cr.execute(f\"\"\""
      ]
    },
    {
      "file": "models/projection/treasury_ledger.py",
      "symbol_type": "module",
      "qualified_name": "treasury_ledger",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _, api, fields, models",
        "from odoo.exceptions import UserError, ValidationError"
      ]
    },
    {
      "file": "models/projection/treasury_ledger.py",
      "symbol_type": "class",
      "qualified_name": "TreasuryLedger",
      "line": 6,
      "decorators": [],
      "context_snippet": [
        "class TreasuryLedger(models.Model):",
        "    _name = \"sc.treasury.ledger\"",
        "    _description = \"Treasury Ledger\""
      ]
    },
    {
      "file": "models/projection/treasury_ledger.py",
      "symbol_type": "method",
      "qualified_name": "TreasuryLedger.create",
      "line": 43,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        # 限制只能通过业务动作创建",
        "        if not self.env.context.get(\"allow_ledger_auto\"):"
      ]
    },
    {
      "file": "models/projection/treasury_ledger.py",
      "symbol_type": "method",
      "qualified_name": "TreasuryLedger._check_amount_positive",
      "line": 54,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_amount_positive(self):",
        "        for rec in self:",
        "            if rec.amount <= 0:"
      ]
    },
    {
      "file": "models/projection/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import profit_report",
        "from . import cost_report"
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "module",
      "qualified_name": "account_extend",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "class",
      "qualified_name": "AccountMove",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class AccountMove(models.Model):",
        "    _inherit = \"account.move\"",
        ""
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "class",
      "qualified_name": "AccountMoveLine",
      "line": 58,
      "decorators": [],
      "context_snippet": [
        "class AccountMoveLine(models.Model):",
        "    _inherit = \"account.move.line\"",
        ""
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "method",
      "qualified_name": "AccountMove.action_post",
      "line": 14,
      "decorators": [],
      "context_snippet": [
        "    def action_post(self):",
        "        res = super().action_post()",
        "        if self._is_cost_enabled(\"smart_construction_core.sc_cost_from_account_move\"):"
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "method",
      "qualified_name": "AccountMove.button_draft",
      "line": 20,
      "decorators": [],
      "context_snippet": [
        "    def button_draft(self):",
        "        res = super().button_draft()",
        "        # 清理当前凭证生成的成本台账，确保过账/反过账一一对应"
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "method",
      "qualified_name": "AccountMove._is_cost_enabled",
      "line": 33,
      "decorators": [],
      "context_snippet": [
        "    def _is_cost_enabled(self, param_key):",
        "        icp = self.env[\"ir.config_parameter\"].sudo().with_company(self.env.company)",
        "        val = icp.get_param(param_key, default=\"False\")"
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "method",
      "qualified_name": "AccountMove._create_cost_ledger_entries",
      "line": 38,
      "decorators": [],
      "context_snippet": [
        "    def _create_cost_ledger_entries(self):",
        "        ledger_obj = self.env[\"project.cost.ledger\"]",
        "        for move in self.filtered(lambda m: m.move_type in (\"in_invoice\", \"entry\")):"
      ]
    },
    {
      "file": "models/support/account_extend.py",
      "symbol_type": "method",
      "qualified_name": "AccountMoveLine._prepare_cost_ledger_vals",
      "line": 78,
      "decorators": [],
      "context_snippet": [
        "    def _prepare_cost_ledger_vals(self):",
        "        self.ensure_one()",
        "        project = self.project_id"
      ]
    },
    {
      "file": "models/support/account_move_line_ext.py",
      "symbol_type": "module",
      "qualified_name": "account_move_line_ext",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import models, fields",
        ""
      ]
    },
    {
      "file": "models/support/account_move_line_ext.py",
      "symbol_type": "class",
      "qualified_name": "AccountMoveLine",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class AccountMoveLine(models.Model):",
        "    _inherit = 'account.move.line'",
        ""
      ]
    },
    {
      "file": "models/support/audit_log.py",
      "symbol_type": "module",
      "qualified_name": "audit_log",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import json",
        "import uuid"
      ]
    },
    {
      "file": "models/support/audit_log.py",
      "symbol_type": "class",
      "qualified_name": "ScAuditLog",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class ScAuditLog(models.Model):",
        "    _name = \"sc.audit.log\"",
        "    _description = \"SC Audit Log\""
      ]
    },
    {
      "file": "models/support/audit_log.py",
      "symbol_type": "method",
      "qualified_name": "ScAuditLog.write_event",
      "line": 29,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def write_event(",
        "        self,",
        "        event_code,"
      ]
    },
    {
      "file": "models/support/audit_log.py",
      "symbol_type": "function",
      "qualified_name": "_to_json",
      "line": 53,
      "decorators": [],
      "context_snippet": [
        "        def _to_json(value):",
        "            if value is None:",
        "                return False"
      ]
    },
    {
      "file": "models/support/base_dictionary.py",
      "symbol_type": "module",
      "qualified_name": "base_dictionary",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import models, fields",
        ""
      ]
    },
    {
      "file": "models/support/budget_compat.py",
      "symbol_type": "module",
      "qualified_name": "budget_compat",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import models",
        ""
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "module",
      "qualified_name": "contract_center",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        ""
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract._tax_use_from_contract_type",
      "line": 160,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _tax_use_from_contract_type(self, contract_type: str) -> str:",
        "        return \"sale\" if contract_type == \"out\" else \"purchase\"",
        ""
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.default_get",
      "line": 248,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def default_get(self, fields_list):",
        "        res = super().default_get(fields_list)",
        "        contract_type = res.get(\"type\") or \"out\""
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract._compute_ref_stats",
      "line": 269,
      "decorators": [],
      "context_snippet": [
        "    def _compute_ref_stats(self):",
        "        Pay = self.env[\"payment.request\"]",
        "        Settle = self.env[\"sc.settlement.order\"]"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract._compute_amount_total",
      "line": 339,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount_total(self):",
        "        for contract in self:",
        "            currency = contract.currency_id or contract.company_currency_id"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract._check_tax_type",
      "line": 352,
      "decorators": [
        "api.constrains"
      ],
      "context_snippet": [
        "    def _check_tax_type(self):",
        "        for contract in self:",
        "            if not contract.tax_id:"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract._compute_line_amount_total",
      "line": 365,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_line_amount_total(self):",
        "        for contract in self:",
        "            contract.line_amount_total = sum(contract.line_ids.mapped(\"amount_contract\"))"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract._compute_final_amount",
      "line": 370,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_final_amount(self):",
        "        for contract in self:",
        "            # 变更模块尚未上线，留出接口，当前默认 0"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.create",
      "line": 379,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        seq = self.env[\"ir.sequence\"]",
        "        for vals in vals_list:"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_confirm",
      "line": 397,
      "decorators": [],
      "context_snippet": [
        "    def action_confirm(self):",
        "        for contract in self:",
        "            old = contract.state"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_set_running",
      "line": 406,
      "decorators": [],
      "context_snippet": [
        "    def action_set_running(self):",
        "        for contract in self:",
        "            old = contract.state"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_close",
      "line": 415,
      "decorators": [],
      "context_snippet": [
        "    def action_close(self):",
        "        for contract in self:",
        "            old = contract.state"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_cancel",
      "line": 426,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self):",
        "        for contract in self:",
        "            old = contract.state"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_reset_draft",
      "line": 436,
      "decorators": [],
      "context_snippet": [
        "    def action_reset_draft(self):",
        "        for contract in self:",
        "            old = contract.state"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_open_payment_requests",
      "line": 445,
      "decorators": [],
      "context_snippet": [
        "    def action_open_payment_requests(self):",
        "        self.ensure_one()",
        "        action = self.env.ref(\"smart_construction_core.action_payment_request\").read()[0]"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContract.action_open_settlements",
      "line": 454,
      "decorators": [],
      "context_snippet": [
        "    def action_open_settlements(self):",
        "        self.ensure_one()",
        "        action = self.env.ref(\"smart_construction_core.action_sc_settlement_order\").read()[0]"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContractLine._auto_init",
      "line": 472,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _auto_init(self):",
        "        # 防御性补列：老库缺少新增的存储字段时，确保列存在再继续初始化",
        "        res = super()._auto_init()"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContractLine._compute_amount_contract",
      "line": 595,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount_contract(self):",
        "        for line in self:",
        "            qty = line.qty_contract or 0.0"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContractLine._compute_amount_contract_leaf",
      "line": 602,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount_contract_leaf(self):",
        "        for line in self:",
        "            # 当前模型无章节/父子结构，默认全部为叶子；若未来引入父子，可在此跳过章节行"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContractLine._compute_delta_amount",
      "line": 608,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_delta_amount(self):",
        "        for line in self:",
        "            line.delta_amount = (line.amount_contract_leaf or 0.0) - (line.boq_amount_leaf or 0.0)"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionContractLine._compute_boq_amount_leaf",
      "line": 619,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_boq_amount_leaf(self):",
        "        for line in self:",
        "            boq = line.boq_line_id"
      ]
    },
    {
      "file": "models/support/contract_center.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject._compute_contract_stats",
      "line": 673,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_contract_stats(self):",
        "        for project in self:",
        "            income = 0.0"
      ]
    },
    {
      "file": "models/support/document_center.py",
      "symbol_type": "module",
      "qualified_name": "document_center",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import models, fields",
        ""
      ]
    },
    {
      "file": "models/support/document_center.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectDocument._compute_attachment_count",
      "line": 82,
      "decorators": [],
      "context_snippet": [
        "    def _compute_attachment_count(self):",
        "        for rec in self:",
        "            rec.attachment_count = len(rec.attachment_ids)"
      ]
    },
    {
      "file": "models/support/document_center.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectDocument.action_submit",
      "line": 87,
      "decorators": [],
      "context_snippet": [
        "    def action_submit(self):",
        "        for rec in self:",
        "            if rec.state == 'draft':"
      ]
    },
    {
      "file": "models/support/document_center.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectDocument.action_approve",
      "line": 93,
      "decorators": [],
      "context_snippet": [
        "    def action_approve(self):",
        "        for rec in self:",
        "            if rec.state in ('draft', 'review'):"
      ]
    },
    {
      "file": "models/support/document_center.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectDocument.action_cancel",
      "line": 99,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self):",
        "        for rec in self:",
        "            rec.state = 'cancel'"
      ]
    },
    {
      "file": "models/support/document_center.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectDocument.action_reset_to_draft",
      "line": 103,
      "decorators": [],
      "context_snippet": [
        "    def action_reset_to_draft(self):",
        "        for rec in self:",
        "            rec.state = 'draft'"
      ]
    },
    {
      "file": "models/support/operating_metrics.py",
      "symbol_type": "module",
      "qualified_name": "operating_metrics",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from typing import Dict, Iterable, Optional, Sequence",
        ""
      ]
    },
    {
      "file": "models/support/operating_metrics_project.py",
      "symbol_type": "module",
      "qualified_name": "operating_metrics_project",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models, tools",
        ""
      ]
    },
    {
      "file": "models/support/operating_metrics_project.py",
      "symbol_type": "method",
      "qualified_name": "ScOperatingMetricsProject.init",
      "line": 29,
      "decorators": [],
      "context_snippet": [
        "    def init(self):",
        "        # 依赖的表若尚未创建（新装阶段），跳过视图创建，等待下次加载再建",
        "        self._cr.execute("
      ]
    },
    {
      "file": "models/support/pack_registry.py",
      "symbol_type": "module",
      "qualified_name": "pack_registry",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "models/support/pack_registry.py",
      "symbol_type": "class",
      "qualified_name": "ScPackRegistry",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ScPackRegistry(models.Model):",
        "    _name = \"sc.pack.registry\"",
        "    _description = \"SC Pack Registry\""
      ]
    },
    {
      "file": "models/support/pack_registry.py",
      "symbol_type": "class",
      "qualified_name": "ScPackInstallation",
      "line": 48,
      "decorators": [],
      "context_snippet": [
        "class ScPackInstallation(models.Model):",
        "    _name = \"sc.pack.installation\"",
        "    _description = \"SC Pack Installation\""
      ]
    },
    {
      "file": "models/support/portal_execute.py",
      "symbol_type": "module",
      "qualified_name": "portal_execute",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "models/support/portal_execute.py",
      "symbol_type": "class",
      "qualified_name": "ProjectProject",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ProjectProject(models.Model):",
        "    _inherit = \"project.project\"",
        ""
      ]
    },
    {
      "file": "models/support/portal_execute.py",
      "symbol_type": "method",
      "qualified_name": "ProjectProject.action_portal_demo_ping",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "    def action_portal_demo_ping(self):",
        "        return {",
        "            \"type\": \"ir.actions.client\","
      ]
    },
    {
      "file": "models/support/product_extend.py",
      "symbol_type": "module",
      "qualified_name": "product_extend",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models",
        ""
      ]
    },
    {
      "file": "models/support/project_dictionary.py",
      "symbol_type": "module",
      "qualified_name": "project_dictionary",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        "from odoo.exceptions import ValidationError"
      ]
    },
    {
      "file": "models/support/project_dictionary.py",
      "symbol_type": "class",
      "qualified_name": "ProjectDictionary",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ProjectDictionary(models.Model):",
        "    _name = \"project.dictionary\"",
        "    _description = \"工程项目数据字典\""
      ]
    },
    {
      "file": "models/support/project_dictionary.py",
      "symbol_type": "function",
      "qualified_name": "to_node",
      "line": 196,
      "decorators": [],
      "context_snippet": [
        "        def to_node(rec):",
        "            return {",
        "                \"id\": rec.id,"
      ]
    },
    {
      "file": "models/support/project_extend_boq.py",
      "symbol_type": "module",
      "qualified_name": "project_extend_boq",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import re",
        ""
      ]
    },
    {
      "file": "models/support/project_extend_boq.py",
      "symbol_type": "class",
      "qualified_name": "Project",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "class Project(models.Model):",
        "    _inherit = \"project.project\"",
        ""
      ]
    },
    {
      "file": "models/support/project_next_action_rule.py",
      "symbol_type": "module",
      "qualified_name": "project_next_action_rule",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/support/project_next_action_rule.py",
      "symbol_type": "class",
      "qualified_name": "ScProjectNextActionRule",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class ScProjectNextActionRule(models.Model):",
        "    _name = \"sc.project.next_action.rule\"",
        "    _description = \"项目下一步行动规则\""
      ]
    },
    {
      "file": "models/support/project_next_action_rule.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectNextActionRule._get_debug_flag",
      "line": 45,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _get_debug_flag(self):",
        "        return bool(self.env.context.get(\"sc_next_action_debug\"))",
        ""
      ]
    },
    {
      "file": "models/support/project_stage_requirements.py",
      "symbol_type": "module",
      "qualified_name": "project_stage_requirements",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/support/project_stage_requirements.py",
      "symbol_type": "class",
      "qualified_name": "ScProjectStageRequirementItem",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ScProjectStageRequirementItem(models.Model):",
        "    _name = \"sc.project.stage.requirement.item\"",
        "    _description = \"项目阶段要求项\""
      ]
    },
    {
      "file": "models/support/project_stage_requirements.py",
      "symbol_type": "class",
      "qualified_name": "ScProjectStageRequirementWizard",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "class ScProjectStageRequirementWizard(models.TransientModel):",
        "    _name = \"sc.project.stage.requirement.wizard\"",
        "    _description = \"项目阶段要求\""
      ]
    },
    {
      "file": "models/support/project_stage_requirements.py",
      "symbol_type": "class",
      "qualified_name": "ScProjectStageRequirementWizardLine",
      "line": 85,
      "decorators": [],
      "context_snippet": [
        "class ScProjectStageRequirementWizardLine(models.TransientModel):",
        "    _name = \"sc.project.stage.requirement.wizard.line\"",
        "    _description = \"项目阶段要求行\""
      ]
    },
    {
      "file": "models/support/project_stage_requirements.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStageRequirementWizard.default_get",
      "line": 55,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def default_get(self, fields_list):",
        "        res = super().default_get(fields_list)",
        "        project_id = res.get(\"project_id\") or self.env.context.get(\"default_project_id\")"
      ]
    },
    {
      "file": "models/support/project_stage_requirements.py",
      "symbol_type": "method",
      "qualified_name": "ScProjectStageRequirementWizardLine.action_go",
      "line": 107,
      "decorators": [],
      "context_snippet": [
        "    def action_go(self):",
        "        self.ensure_one()",
        "        if not self.action_xmlid:"
      ]
    },
    {
      "file": "models/support/res_config_settings.py",
      "symbol_type": "module",
      "qualified_name": "res_config_settings",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models",
        ""
      ]
    },
    {
      "file": "models/support/res_config_settings.py",
      "symbol_type": "method",
      "qualified_name": "ResConfigSettings.set_values",
      "line": 45,
      "decorators": [],
      "context_snippet": [
        "    def set_values(self):",
        "        res = super().set_values()",
        "        # 软提醒：同一公司同时开启多个成本入口，可能导致重复计入"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "module",
      "qualified_name": "scene_orchestration",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScCapability",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "class ScCapability(models.Model):",
        "    _name = \"sc.capability\"",
        "    _description = \"SC Capability Catalog\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScScene",
      "line": 172,
      "decorators": [],
      "context_snippet": [
        "class ScScene(models.Model):",
        "    _name = \"sc.scene\"",
        "    _description = \"SC Scene\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScSceneTile",
      "line": 415,
      "decorators": [],
      "context_snippet": [
        "class ScSceneTile(models.Model):",
        "    _name = \"sc.scene.tile\"",
        "    _description = \"SC Scene Tile\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScSceneVersion",
      "line": 468,
      "decorators": [],
      "context_snippet": [
        "class ScSceneVersion(models.Model):",
        "    _name = \"sc.scene.version\"",
        "    _description = \"SC Scene Version\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScUserPreference",
      "line": 485,
      "decorators": [],
      "context_snippet": [
        "class ScUserPreference(models.Model):",
        "    _name = \"sc.user.preference\"",
        "    _description = \"SC User Preference\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScSceneValidation",
      "line": 507,
      "decorators": [],
      "context_snippet": [
        "class ScSceneValidation(models.Model):",
        "    _name = \"sc.scene.validation\"",
        "    _description = \"SC Scene Validation\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScSceneAuditLog",
      "line": 519,
      "decorators": [],
      "context_snippet": [
        "class ScSceneAuditLog(models.Model):",
        "    _name = \"sc.scene.audit.log\"",
        "    _description = \"SC Scene Audit Log\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "class",
      "qualified_name": "ScCapabilityAuditLog",
      "line": 542,
      "decorators": [],
      "context_snippet": [
        "class ScCapabilityAuditLog(models.Model):",
        "    _name = \"sc.capability.audit.log\"",
        "    _description = \"SC Capability Audit Log\""
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScCapability._user_allowed",
      "line": 37,
      "decorators": [],
      "context_snippet": [
        "    def _user_allowed(self, user):",
        "        if not self.required_group_ids:",
        "            return True"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScCapability._resolve_payload",
      "line": 42,
      "decorators": [],
      "context_snippet": [
        "    def _resolve_payload(self, payload):",
        "        resolved = dict(payload or {})",
        "        if resolved.get(\"action_xmlid\") and not resolved.get(\"action_id\"):"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScCapability.to_public_dict",
      "line": 54,
      "decorators": [],
      "context_snippet": [
        "    def to_public_dict(self, user):",
        "        self.ensure_one()",
        "        group_xmlids = self.required_group_ids.get_external_id()"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScCapability.lint_capabilities",
      "line": 78,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def lint_capabilities(self, ignore_keys=None, include_tests=False):",
        "        issues = []",
        "        domain = [(\"active\", \"=\", True)]"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene._user_allowed",
      "line": 201,
      "decorators": [],
      "context_snippet": [
        "    def _user_allowed(self, user):",
        "        if not self.target_group_ids:",
        "            return True"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene.to_public_dict",
      "line": 206,
      "decorators": [],
      "context_snippet": [
        "    def to_public_dict(self, user):",
        "        self.ensure_one()",
        "        version_payload = self.active_version_id.payload_json if self.active_version_id else None"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene._build_version_payload",
      "line": 226,
      "decorators": [],
      "context_snippet": [
        "    def _build_version_payload(self, user=None):",
        "        self.ensure_one()",
        "        user = user or self.env.user"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene._get_allowed_intents",
      "line": 244,
      "decorators": [],
      "context_snippet": [
        "    def _get_allowed_intents(self):",
        "        param = self.env[\"ir.config_parameter\"].sudo().get_param(\"sc.scene.allowed_intents\", \"\")",
        "        if param:"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene._validate_scene",
      "line": 257,
      "decorators": [],
      "context_snippet": [
        "    def _validate_scene(self):",
        "        self.ensure_one()",
        "        issues = []"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene._log_audit",
      "line": 341,
      "decorators": [],
      "context_snippet": [
        "    def _log_audit(self, event, version=None, payload_diff=None):",
        "        self.env[\"sc.scene.audit.log\"].sudo().create({",
        "            \"event\": event,"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene.action_publish",
      "line": 351,
      "decorators": [],
      "context_snippet": [
        "    def action_publish(self):",
        "        for scene in self:",
        "            Entitlement = scene.env.get(\"sc.entitlement\")"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene.action_archive",
      "line": 398,
      "decorators": [],
      "context_snippet": [
        "    def action_archive(self):",
        "        self.write({\"state\": \"archived\"})",
        "        for scene in self:"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScScene.action_set_active_version",
      "line": 403,
      "decorators": [],
      "context_snippet": [
        "    def action_set_active_version(self, version_id):",
        "        version = self.env[\"sc.scene.version\"].browse(version_id)",
        "        if version and version.scene_id and version.scene_id.id in self.ids:"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScSceneTile._merge_payload",
      "line": 434,
      "decorators": [],
      "context_snippet": [
        "    def _merge_payload(self, base_payload, override_payload):",
        "        payload = dict(base_payload or {})",
        "        if isinstance(override_payload, dict):"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScSceneTile.to_public_dict",
      "line": 440,
      "decorators": [],
      "context_snippet": [
        "    def to_public_dict(self, user):",
        "        self.ensure_one()",
        "        cap = self.capability_id"
      ]
    },
    {
      "file": "models/support/scene_orchestration.py",
      "symbol_type": "method",
      "qualified_name": "ScUserPreference.get_or_create",
      "line": 500,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def get_or_create(cls, env, user):",
        "        pref = env[\"sc.user.preference\"].sudo().search([(\"user_id\", \"=\", user.id)], limit=1)",
        "        if pref:"
      ]
    },
    {
      "file": "models/support/sc_data_validator.py",
      "symbol_type": "module",
      "qualified_name": "sc_data_validator",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import json",
        "from datetime import datetime"
      ]
    },
    {
      "file": "models/support/sc_data_validator.py",
      "symbol_type": "class",
      "qualified_name": "ScDataValidator",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "class ScDataValidator(models.AbstractModel):",
        "    _name = \"sc.data.validator\"",
        "    _description = \"Smart Construction Data Validator\""
      ]
    },
    {
      "file": "models/support/sc_data_validator.py",
      "symbol_type": "method",
      "qualified_name": "ScDataValidator._collect_error_issues",
      "line": 27,
      "decorators": [],
      "context_snippet": [
        "    def _collect_error_issues(self, rule_results):",
        "        issues = []",
        "        for r in rule_results:"
      ]
    },
    {
      "file": "models/support/sc_data_validator.py",
      "symbol_type": "method",
      "qualified_name": "ScDataValidator._render_error_message",
      "line": 38,
      "decorators": [],
      "context_snippet": [
        "    def _render_error_message(self, error_issues):",
        "        lines = [\"数据校验未通过：\"]",
        "        for it in error_issues[:20]:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "module",
      "qualified_name": "sc_workflow",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _, api, fields, models",
        "from odoo.exceptions import UserError"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "class",
      "qualified_name": "ScWorkflowDef",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "class ScWorkflowDef(models.Model):",
        "    _name = \"sc.workflow.def\"",
        "    _description = \"SC Workflow Definition\""
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "class",
      "qualified_name": "ScWorkflowNode",
      "line": 79,
      "decorators": [],
      "context_snippet": [
        "class ScWorkflowNode(models.Model):",
        "    _name = \"sc.workflow.node\"",
        "    _description = \"SC Workflow Node\""
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "class",
      "qualified_name": "ScWorkflowInstance",
      "line": 125,
      "decorators": [],
      "context_snippet": [
        "class ScWorkflowInstance(models.Model):",
        "    _name = \"sc.workflow.instance\"",
        "    _description = \"SC Workflow Instance\""
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "class",
      "qualified_name": "ScWorkflowWorkitem",
      "line": 323,
      "decorators": [],
      "context_snippet": [
        "class ScWorkflowWorkitem(models.Model):",
        "    _name = \"sc.workflow.workitem\"",
        "    _description = \"SC Workflow Workitem\""
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "class",
      "qualified_name": "ScWorkflowLog",
      "line": 341,
      "decorators": [],
      "context_snippet": [
        "class ScWorkflowLog(models.Model):",
        "    _name = \"sc.workflow.log\"",
        "    _description = \"SC Workflow Log\""
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowDef._compute_instance_count",
      "line": 46,
      "decorators": [],
      "context_snippet": [
        "    def _compute_instance_count(self):",
        "        Inst = self.env[\"sc.workflow.instance\"].sudo()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowDef._require_admin",
      "line": 52,
      "decorators": [],
      "context_snippet": [
        "    def _require_admin(self):",
        "        if not self.env.user.has_group(CONFIG_GROUP):",
        "            raise UserError(_(\"You do not have permission to manage workflows.\"))"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowDef.action_publish",
      "line": 56,
      "decorators": [],
      "context_snippet": [
        "    def action_publish(self):",
        "        self._require_admin()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowDef.action_draft",
      "line": 64,
      "decorators": [],
      "context_snippet": [
        "    def action_draft(self):",
        "        self._require_admin()",
        "        self.write({\"state\": \"draft\"})"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowDef.get_start_node",
      "line": 68,
      "decorators": [],
      "context_snippet": [
        "    def get_start_node(self):",
        "        self.ensure_one()",
        "        if self.start_node_id and self.start_node_id.active:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowNode.allowed_group_set",
      "line": 119,
      "decorators": [],
      "context_snippet": [
        "    def allowed_group_set(self):",
        "        self.ensure_one()",
        "        xmlid = self.approve_group_id.get_external_id().get(self.approve_group_id.id) if self.approve_group_id else None"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._compute_name",
      "line": 155,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_name(self):",
        "        for rec in self:",
        "            if rec.workflow_def_id and rec.res_id:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._require_admin",
      "line": 165,
      "decorators": [],
      "context_snippet": [
        "    def _require_admin(self):",
        "        if not self.env.user.has_group(CONFIG_GROUP):",
        "            raise UserError(_(\"You do not have permission to manage workflow instances.\"))"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._require_group",
      "line": 169,
      "decorators": [],
      "context_snippet": [
        "    def _require_group(self, group_xmlid):",
        "        if group_xmlid and not self.env.user.has_group(group_xmlid):",
        "            raise UserError(_(\"You are not allowed to perform this action.\"))"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._group_xmlid",
      "line": 176,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _group_xmlid(group):",
        "        return group.get_external_id().get(group.id) if group else None",
        ""
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._get_start_node",
      "line": 179,
      "decorators": [],
      "context_snippet": [
        "    def _get_start_node(self):",
        "        self.ensure_one()",
        "        node = self.workflow_def_id.get_start_node()"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._get_todo_workitem",
      "line": 186,
      "decorators": [],
      "context_snippet": [
        "    def _get_todo_workitem(self):",
        "        self.ensure_one()",
        "        return self.workitem_ids.filtered(lambda w: w.status == \"todo\")[:1]"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._create_workitem",
      "line": 190,
      "decorators": [],
      "context_snippet": [
        "    def _create_workitem(self, node):",
        "        self.ensure_one()",
        "        if not node.approve_group_id:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance._log",
      "line": 201,
      "decorators": [],
      "context_snippet": [
        "    def _log(self, action, from_state, to_state, from_node, to_node, note=None):",
        "        self.ensure_one()",
        "        return self.env[\"sc.workflow.log\"].create({"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance.create_instance",
      "line": 216,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def create_instance(self, workflow_def, model_name, res_id, note=None):",
        "        self._require_admin()",
        "        if isinstance(workflow_def, int):"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance.action_submit",
      "line": 240,
      "decorators": [],
      "context_snippet": [
        "    def action_submit(self):",
        "        self._require_admin()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance.action_approve",
      "line": 256,
      "decorators": [],
      "context_snippet": [
        "    def action_approve(self, note=None):",
        "        for rec in self:",
        "            if rec.state != \"running\":"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance.action_reject",
      "line": 286,
      "decorators": [],
      "context_snippet": [
        "    def action_reject(self, note=None):",
        "        for rec in self:",
        "            if rec.state != \"running\":"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowInstance.action_cancel",
      "line": 307,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel(self, note=None):",
        "        self._require_admin()",
        "        for rec in self:"
      ]
    },
    {
      "file": "models/support/sc_workflow.py",
      "symbol_type": "method",
      "qualified_name": "ScWorkflowLog.create_log",
      "line": 362,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def create_log(self, instance, action, note=None):",
        "        return self.create({",
        "            \"instance_id\": instance.id,"
      ]
    },
    {
      "file": "models/support/signup_throttle.py",
      "symbol_type": "module",
      "qualified_name": "signup_throttle",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import time",
        ""
      ]
    },
    {
      "file": "models/support/signup_throttle.py",
      "symbol_type": "class",
      "qualified_name": "ScSignupThrottle",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ScSignupThrottle(models.Model):",
        "    _name = \"sc.signup.throttle\"",
        "    _description = \"Signup rate limit\""
      ]
    },
    {
      "file": "models/support/signup_throttle.py",
      "symbol_type": "method",
      "qualified_name": "ScSignupThrottle.check_and_bump",
      "line": 17,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def check_and_bump(self, key, window_sec, max_count):",
        "        now = int(time.time())",
        "        rec = self.sudo().search([(\"key\", \"=\", key)], limit=1)"
      ]
    },
    {
      "file": "models/support/signup_throttle.py",
      "symbol_type": "method",
      "qualified_name": "ScSignupThrottle.gc_expired",
      "line": 53,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def gc_expired(self):",
        "        icp = self.env[\"ir.config_parameter\"].sudo()",
        "        try:"
      ]
    },
    {
      "file": "models/support/state_guard.py",
      "symbol_type": "module",
      "qualified_name": "state_guard",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _",
        "from odoo.exceptions import UserError"
      ]
    },
    {
      "file": "models/support/state_machine.py",
      "symbol_type": "method",
      "qualified_name": "ScStateMachine.is_registered",
      "line": 115,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def is_registered(cls, model_name):",
        "        return model_name in cls._REGISTRY",
        ""
      ]
    },
    {
      "file": "models/support/state_machine.py",
      "symbol_type": "method",
      "qualified_name": "ScStateMachine._get_registry",
      "line": 119,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def _get_registry(cls, model_name):",
        "        if model_name not in cls._REGISTRY:",
        "            raise KeyError(f\"ScStateMachine: model not registered: {model_name}\")"
      ]
    },
    {
      "file": "models/support/state_machine.py",
      "symbol_type": "method",
      "qualified_name": "ScStateMachine.selection",
      "line": 125,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def selection(cls, model_name):",
        "        return cls._get_registry(model_name)[0]",
        ""
      ]
    },
    {
      "file": "models/support/state_machine.py",
      "symbol_type": "method",
      "qualified_name": "ScStateMachine.transitions",
      "line": 129,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def transitions(cls, model_name):",
        "        return cls._get_registry(model_name)[1]",
        ""
      ]
    },
    {
      "file": "models/support/state_machine.py",
      "symbol_type": "method",
      "qualified_name": "ScStateMachine.label",
      "line": 133,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def label(cls, model_name, key):",
        "        states, _ = cls._get_registry(model_name)",
        "        return dict(states).get(key, key)"
      ]
    },
    {
      "file": "models/support/state_machine.py",
      "symbol_type": "method",
      "qualified_name": "ScStateMachine.assert_transition",
      "line": 138,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def assert_transition(cls, model_name, old, new, obj_display=\"\"):",
        "        if not old or not new or old == new:",
        "            return"
      ]
    },
    {
      "file": "models/support/stock_extend.py",
      "symbol_type": "module",
      "qualified_name": "stock_extend",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        ""
      ]
    },
    {
      "file": "models/support/stock_extend.py",
      "symbol_type": "method",
      "qualified_name": "StockPicking._is_cost_enabled",
      "line": 89,
      "decorators": [],
      "context_snippet": [
        "    def _is_cost_enabled(self, param_key):",
        "        icp = self.env[\"ir.config_parameter\"].sudo().with_company(self.env.company)",
        "        val = icp.get_param(param_key, default=\"False\")"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "module",
      "qualified_name": "subscription",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "class",
      "qualified_name": "ScSubscriptionPlan",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ScSubscriptionPlan(models.Model):",
        "    _name = \"sc.subscription.plan\"",
        "    _description = \"SC Subscription Plan\""
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "class",
      "qualified_name": "ScSubscription",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "class ScSubscription(models.Model):",
        "    _name = \"sc.subscription\"",
        "    _description = \"SC Subscription\""
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "class",
      "qualified_name": "ScEntitlement",
      "line": 43,
      "decorators": [],
      "context_snippet": [
        "class ScEntitlement(models.Model):",
        "    _name = \"sc.entitlement\"",
        "    _description = \"SC Entitlement\""
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "class",
      "qualified_name": "ScUsageCounter",
      "line": 146,
      "decorators": [],
      "context_snippet": [
        "class ScUsageCounter(models.Model):",
        "    _name = \"sc.usage.counter\"",
        "    _description = \"SC Usage Counter\""
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "class",
      "qualified_name": "ScOpsJob",
      "line": 179,
      "decorators": [],
      "context_snippet": [
        "class ScOpsJob(models.Model):",
        "    _name = \"sc.ops.job\"",
        "    _description = \"SC Ops Job\""
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScEntitlement._default_plan",
      "line": 59,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _default_plan(self):",
        "        code = (",
        "            self.env[\"ir.config_parameter\"]"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScEntitlement._resolve_plan",
      "line": 71,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _resolve_plan(self, company):",
        "        today = fields.Date.context_today(self)",
        "        sub = self.env[\"sc.subscription\"].sudo().search(["
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScEntitlement.get_effective",
      "line": 83,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def get_effective(self, company):",
        "        plan = self._resolve_plan(company)",
        "        flags = dict(plan.feature_flags_json or {}) if plan else {}"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScEntitlement._flag_enabled",
      "line": 102,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def _flag_enabled(self, flags, flag):",
        "        if not flag:",
        "            return True"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScEntitlement.evaluate_intent",
      "line": 115,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def evaluate_intent(self, user, intent, params):",
        "        if not user:",
        "            return True, \"\", {}"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScEntitlement.get_payload",
      "line": 135,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def get_payload(self, user):",
        "        if not user:",
        "            return {}"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScUsageCounter.bump",
      "line": 161,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def bump(self, company, key, delta=1):",
        "        counter = self.search([(\"company_id\", \"=\", company.id), (\"key\", \"=\", key)], limit=1)",
        "        if counter:"
      ]
    },
    {
      "file": "models/support/subscription.py",
      "symbol_type": "method",
      "qualified_name": "ScUsageCounter.get_usage_map",
      "line": 174,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def get_usage_map(self, company):",
        "        counters = self.search([(\"company_id\", \"=\", company.id)])",
        "        return {rec.key: rec.value for rec in counters}"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "module",
      "qualified_name": "task_extend",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import json",
        ""
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "class",
      "qualified_name": "ProjectTask",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "class ProjectTask(models.Model):",
        "    _inherit = \"project.task\"",
        ""
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._compute_boq_totals",
      "line": 97,
      "decorators": [],
      "context_snippet": [
        "    def _compute_boq_totals(self):",
        "        for task in self:",
        "            qty = sum(task.boq_line_ids.mapped(\"quantity\"))"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._compute_readiness",
      "line": 106,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_readiness(self):",
        "        for task in self:",
        "            missing_fields, blockers = task._get_readiness_state()"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._get_readiness_state",
      "line": 118,
      "decorators": [],
      "context_snippet": [
        "    def _get_readiness_state(self):",
        "        missing_fields = []",
        "        blockers = []"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._get_progress_ratio",
      "line": 136,
      "decorators": [],
      "context_snippet": [
        "    def _get_progress_ratio(self):",
        "        if \"progress_rate\" in self._fields:",
        "            return self.progress_rate or 0.0"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._audit_transition",
      "line": 143,
      "decorators": [],
      "context_snippet": [
        "    def _audit_transition(self, event_code, action, before_state, after_state, reason=None):",
        "        Audit = self.env[\"sc.audit.log\"]",
        "        for task in self:"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._ensure_manager_role",
      "line": 159,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_manager_role(self):",
        "        if not self.env.user.has_group(\"smart_construction_core.group_sc_cap_project_manager\"):",
        "            raise_guard("
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask._ensure_no_direct_state_write",
      "line": 168,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_no_direct_state_write(self, vals):",
        "        if \"sc_state\" in vals and not self.env.context.get(\"allow_transition\"):",
        "            raise_guard("
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask.create",
      "line": 178,
      "decorators": [
        "api.model_create_multi"
      ],
      "context_snippet": [
        "    def create(self, vals_list):",
        "        for vals in vals_list:",
        "            self._ensure_no_direct_state_write(vals)"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask.write",
      "line": 183,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        self._ensure_no_direct_state_write(vals)",
        "        return super().write(vals)"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask.action_prepare_task",
      "line": 187,
      "decorators": [],
      "context_snippet": [
        "    def action_prepare_task(self):",
        "        for task in self:",
        "            if task.sc_state != \"draft\":"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask.action_start_task",
      "line": 216,
      "decorators": [],
      "context_snippet": [
        "    def action_start_task(self):",
        "        for task in self:",
        "            if task.sc_state != \"ready\":"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask.action_mark_done",
      "line": 238,
      "decorators": [],
      "context_snippet": [
        "    def action_mark_done(self):",
        "        for task in self:",
        "            if task.sc_state != \"in_progress\":"
      ]
    },
    {
      "file": "models/support/task_extend.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTask.action_cancel_task",
      "line": 260,
      "decorators": [],
      "context_snippet": [
        "    def action_cancel_task(self, reason=None):",
        "        self._ensure_manager_role()",
        "        for task in self:"
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "module",
      "qualified_name": "tender",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        "from odoo.exceptions import UserError"
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderBid",
      "line": 6,
      "decorators": [],
      "context_snippet": [
        "class TenderBid(models.Model):",
        "    _name = \"tender.bid\"",
        "    _description = \"投标管理\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderBidLine",
      "line": 158,
      "decorators": [],
      "context_snippet": [
        "class TenderBidLine(models.Model):",
        "    _name = \"tender.bid.line\"",
        "    _description = \"投标清单行\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderDocPurchase",
      "line": 189,
      "decorators": [],
      "context_snippet": [
        "class TenderDocPurchase(models.Model):",
        "    _name = \"tender.doc.purchase\"",
        "    _description = \"投标文件购买申请\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderSurvey",
      "line": 209,
      "decorators": [],
      "context_snippet": [
        "class TenderSurvey(models.Model):",
        "    _name = \"tender.survey\"",
        "    _description = \"投标项目勘察\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderDocReview",
      "line": 222,
      "decorators": [],
      "context_snippet": [
        "class TenderDocReview(models.Model):",
        "    _name = \"tender.doc.review\"",
        "    _description = \"投标文件审查\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderOpening",
      "line": 238,
      "decorators": [],
      "context_snippet": [
        "class TenderOpening(models.Model):",
        "    _name = \"tender.opening\"",
        "    _description = \"开标登记\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderOpeningCompetitor",
      "line": 259,
      "decorators": [],
      "context_snippet": [
        "class TenderOpeningCompetitor(models.Model):",
        "    _name = \"tender.opening.competitor\"",
        "    _description = \"竞争对手报价\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "class",
      "qualified_name": "TenderGuarantee",
      "line": 273,
      "decorators": [],
      "context_snippet": [
        "class TenderGuarantee(models.Model):",
        "    _name = \"tender.guarantee\"",
        "    _description = \"投标保证金\""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid._compute_amounts",
      "line": 86,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amounts(self):",
        "        for bid in self:",
        "            bid.amount_total = sum(bid.line_ids.mapped(\"amount\"))"
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid._compute_guarantee_stats",
      "line": 91,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_guarantee_stats(self):",
        "        for bid in self:",
        "            total = 0.0"
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid._reload",
      "line": 105,
      "decorators": [],
      "context_snippet": [
        "    def _reload(self):",
        "        return {\"type\": \"ir.actions.client\", \"tag\": \"reload\"}",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.action_to_prepare",
      "line": 108,
      "decorators": [],
      "context_snippet": [
        "    def action_to_prepare(self):",
        "        return self._set_state(\"prepare\")",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.action_to_estimating",
      "line": 111,
      "decorators": [],
      "context_snippet": [
        "    def action_to_estimating(self):",
        "        return self._set_state(\"estimating\")",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.action_to_submitted",
      "line": 114,
      "decorators": [],
      "context_snippet": [
        "    def action_to_submitted(self):",
        "        return self._set_state(\"submitted\")",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.action_to_waiting",
      "line": 117,
      "decorators": [],
      "context_snippet": [
        "    def action_to_waiting(self):",
        "        return self._set_state(\"waiting\")",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.action_mark_won",
      "line": 120,
      "decorators": [],
      "context_snippet": [
        "    def action_mark_won(self):",
        "        return self._set_state(\"won\")",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.action_mark_lost",
      "line": 123,
      "decorators": [],
      "context_snippet": [
        "    def action_mark_lost(self):",
        "        return self._set_state(\"lost\")",
        ""
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid._set_state",
      "line": 126,
      "decorators": [],
      "context_snippet": [
        "    def _set_state(self, target_state):",
        "        old_states = {rec.id: rec.state for rec in self}",
        "        res = self.write({\"state\": target_state})"
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBid.write",
      "line": 153,
      "decorators": [],
      "context_snippet": [
        "    def write(self, vals):",
        "        # 合同创建逻辑集中在 _set_state(\"won\")，避免重复/非法类型",
        "        return super().write(vals)"
      ]
    },
    {
      "file": "models/support/tender.py",
      "symbol_type": "method",
      "qualified_name": "TenderBidLine._compute_amount",
      "line": 184,
      "decorators": [
        "api.depends"
      ],
      "context_snippet": [
        "    def _compute_amount(self):",
        "        for line in self:",
        "            line.amount = (line.quantity or 0.0) * (line.price or 0.0)"
      ]
    },
    {
      "file": "models/support/tier_definition_ext.py",
      "symbol_type": "module",
      "qualified_name": "tier_definition_ext",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import models",
        ""
      ]
    },
    {
      "file": "models/support/tier_definition_ext.py",
      "symbol_type": "class",
      "qualified_name": "TierDefinition",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class TierDefinition(models.Model):",
        "    _inherit = \"tier.definition\"",
        ""
      ]
    },
    {
      "file": "models/support/work_breakdown.py",
      "symbol_type": "module",
      "qualified_name": "work_breakdown",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import api, fields, models",
        "from odoo.exceptions import ValidationError"
      ]
    },
    {
      "file": "models/support/work_breakdown.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionWorkBreakdown._exec_structure_action",
      "line": 203,
      "decorators": [],
      "context_snippet": [
        "    def _exec_structure_action(self, view_key):",
        "        ctx = dict(self.env.context or {})",
        "        project_id = False"
      ]
    },
    {
      "file": "models/support/work_breakdown.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionWorkBreakdown.action_open_exec_wbs",
      "line": 262,
      "decorators": [],
      "context_snippet": [
        "    def action_open_exec_wbs(self):",
        "        return self._exec_structure_action(\"wbs\")",
        ""
      ]
    },
    {
      "file": "models/support/work_breakdown.py",
      "symbol_type": "method",
      "qualified_name": "ConstructionWorkBreakdown.action_open_exec_structure",
      "line": 265,
      "decorators": [],
      "context_snippet": [
        "    def action_open_exec_structure(self):",
        "        return self._exec_structure_action(\"structure\")",
        ""
      ]
    },
    {
      "file": "models/support/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import base_dictionary",
        "from . import project_dictionary"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "module",
      "qualified_name": "capability_matrix_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "class",
      "qualified_name": "CapabilityMatrixService",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class CapabilityMatrixService:",
        "    def __init__(self, env):",
        "        self.env = env"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixService.build_matrix",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def build_matrix(self):",
        "        sections = []",
        "        for section in self._registry():"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixService._resolve_item",
      "line": 29,
      "decorators": [],
      "context_snippet": [
        "    def _resolve_item(self, item):",
        "        menu_xmlid = item.get(\"menu_xmlid\")",
        "        action_xmlid = item.get(\"action_xmlid\")"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixService._build_target_url",
      "line": 73,
      "decorators": [],
      "context_snippet": [
        "    def _build_target_url(self, action, menu_id):",
        "        if not action:",
        "            return None"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixService._menu_visible",
      "line": 85,
      "decorators": [],
      "context_snippet": [
        "    def _menu_visible(self, menu):",
        "        if hasattr(menu, \"_is_visible\"):",
        "            return bool(menu._is_visible())"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixService._ref",
      "line": 93,
      "decorators": [],
      "context_snippet": [
        "    def _ref(self, xmlid):",
        "        if not xmlid:",
        "            return None"
      ]
    },
    {
      "file": "services/capability_matrix_service.py",
      "symbol_type": "method",
      "qualified_name": "CapabilityMatrixService._registry",
      "line": 98,
      "decorators": [],
      "context_snippet": [
        "    def _registry(self):",
        "        return [",
        "            {"
      ]
    },
    {
      "file": "services/execute_button_service.py",
      "symbol_type": "module",
      "qualified_name": "execute_button_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/execute_button_service.py",
      "symbol_type": "class",
      "qualified_name": "ExecuteButtonService",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class ExecuteButtonService(models.AbstractModel):",
        "    _name = \"sc.execute_button.service\"",
        "    _description = \"Execute button actions with a unified response\""
      ]
    },
    {
      "file": "services/execute_button_service.py",
      "symbol_type": "function",
      "qualified_name": "_extract_ui_effect",
      "line": 46,
      "decorators": [],
      "context_snippet": [
        "def _extract_ui_effect(result):",
        "    if isinstance(result, dict) and \"effect\" in result:",
        "        return result.get(\"effect\")"
      ]
    },
    {
      "file": "services/execute_button_service.py",
      "symbol_type": "function",
      "qualified_name": "_extract_action",
      "line": 52,
      "decorators": [],
      "context_snippet": [
        "def _extract_action(result):",
        "    if not isinstance(result, dict):",
        "        return None"
      ]
    },
    {
      "file": "services/execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "ExecuteButtonService.execute",
      "line": 12,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def execute(self, model, res_id, method, context=None):",
        "        if not model or model not in self.env:",
        "            raise ValueError(\"invalid model\")"
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "module",
      "qualified_name": "lifecycle_capability_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "class",
      "qualified_name": "LifecycleCapabilityService",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "class LifecycleCapabilityService:",
        "    _MODES = {\"allow\", \"deny\", \"readonly\"}",
        ""
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "method",
      "qualified_name": "LifecycleCapabilityService.describe_project",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "    def describe_project(self, project):",
        "        matrix, meta = self._load_matrix()",
        "        lifecycle_state = project.lifecycle_state or \"draft\""
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "method",
      "qualified_name": "LifecycleCapabilityService.resolve",
      "line": 36,
      "decorators": [],
      "context_snippet": [
        "    def resolve(self, project, capability_code):",
        "        matrix, meta = self._load_matrix()",
        "        lifecycle_state = project.lifecycle_state or \"draft\""
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "method",
      "qualified_name": "LifecycleCapabilityService._load_matrix",
      "line": 56,
      "decorators": [],
      "context_snippet": [
        "    def _load_matrix(self):",
        "        path = os.environ.get(\"SC_LIFECYCLE_CAP_MATRIX_PATH\") or self._default_matrix_path()",
        "        if not os.path.exists(path):"
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "method",
      "qualified_name": "LifecycleCapabilityService._default_matrix_path",
      "line": 65,
      "decorators": [],
      "context_snippet": [
        "    def _default_matrix_path(self):",
        "        module_root = os.path.abspath(os.path.join(os.path.dirname(__file__), os.pardir))",
        "        repo_root = os.path.abspath(os.path.join(module_root, os.pardir, os.pardir))"
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "method",
      "qualified_name": "LifecycleCapabilityService._parse_matrix",
      "line": 70,
      "decorators": [],
      "context_snippet": [
        "    def _parse_matrix(self, content):",
        "        matrix = {}",
        "        current_state = None"
      ]
    },
    {
      "file": "services/lifecycle_capability_service.py",
      "symbol_type": "method",
      "qualified_name": "LifecycleCapabilityService._capability_registry",
      "line": 97,
      "decorators": [],
      "context_snippet": [
        "    def _capability_registry(self):",
        "        return {",
        "            \"project.edit_basic\": {"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "module",
      "qualified_name": "portal_dashboard_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "class",
      "qualified_name": "PortalDashboardService",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class PortalDashboardService:",
        "    def __init__(self, env):",
        "        self.env = env"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardService.build_dashboard",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def build_dashboard(self):",
        "        entries = []",
        "        for item in self._registry():"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardService._resolve_entry",
      "line": 20,
      "decorators": [],
      "context_snippet": [
        "    def _resolve_entry(self, item):",
        "        menu_xmlid = item.get(\"menu_xmlid\")",
        "        action_xmlid = item.get(\"action_xmlid\")"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardService._build_target",
      "line": 61,
      "decorators": [],
      "context_snippet": [
        "    def _build_target(self, action, menu_id):",
        "        if not action:",
        "            return None"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardService._menu_visible",
      "line": 72,
      "decorators": [],
      "context_snippet": [
        "    def _menu_visible(self, menu):",
        "        if hasattr(menu, \"_is_visible\"):",
        "            return bool(menu._is_visible())"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardService._ref",
      "line": 80,
      "decorators": [],
      "context_snippet": [
        "    def _ref(self, xmlid):",
        "        if not xmlid:",
        "            return None"
      ]
    },
    {
      "file": "services/portal_dashboard_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalDashboardService._registry",
      "line": 85,
      "decorators": [],
      "context_snippet": [
        "    def _registry(self):",
        "        return [",
        "            {"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "module",
      "qualified_name": "portal_execute_button_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "class",
      "qualified_name": "PortalExecuteButtonService",
      "line": 5,
      "decorators": [],
      "context_snippet": [
        "class PortalExecuteButtonService:",
        "    def __init__(self, env):",
        "        self.env = env"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "function",
      "qualified_name": "_registry",
      "line": 88,
      "decorators": [],
      "context_snippet": [
        "def _registry():",
        "    return {",
        "        \"project.project\": {"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "function",
      "qualified_name": "_error",
      "line": 100,
      "decorators": [],
      "context_snippet": [
        "def _error(code, message):",
        "    return {",
        "        \"code\": code,"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonService.build_contract",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def build_contract(self, model=None, res_id=None, method=None):",
        "        entry = self._resolve_entry(model, method)",
        "        record = self._resolve_record(entry.get(\"model\"), res_id)"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonService.assert_allowed",
      "line": 39,
      "decorators": [],
      "context_snippet": [
        "    def assert_allowed(self, model, method):",
        "        entry = self._resolve_entry(model, method)",
        "        if not entry.get(\"allowed\"):"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonService._resolve_entry",
      "line": 45,
      "decorators": [],
      "context_snippet": [
        "    def _resolve_entry(self, model=None, method=None):",
        "        model = model or \"project.project\"",
        "        method = method or \"action_portal_demo_ping\""
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonService._resolve_record",
      "line": 66,
      "decorators": [],
      "context_snippet": [
        "    def _resolve_record(self, model, res_id):",
        "        if not model or model not in self.env:",
        "            return None"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonService._check_method",
      "line": 73,
      "decorators": [],
      "context_snippet": [
        "    def _check_method(self, record, method):",
        "        fn = getattr(record, method, None)",
        "        if fn is None or not callable(fn):"
      ]
    },
    {
      "file": "services/portal_execute_button_service.py",
      "symbol_type": "method",
      "qualified_name": "PortalExecuteButtonService._check_access",
      "line": 79,
      "decorators": [],
      "context_snippet": [
        "    def _check_access(self, record):",
        "        try:",
        "            record.check_access_rights(\"write\")"
      ]
    },
    {
      "file": "services/project_next_action_service.py",
      "symbol_type": "module",
      "qualified_name": "project_next_action_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        ""
      ]
    },
    {
      "file": "services/project_next_action_service.py",
      "symbol_type": "class",
      "qualified_name": "ProjectNextActionService",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class ProjectNextActionService(models.AbstractModel):",
        "    _name = \"sc.project.next_action.service\"",
        "    _description = \"Project Next Action Rule Service\""
      ]
    },
    {
      "file": "services/project_next_action_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectNextActionService.get_next_actions",
      "line": 18,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def get_next_actions(self, project, limit=3):",
        "        project.ensure_one()",
        "        stats = self.env[\"sc.project.overview.service\"].get_overview([project.id]).get(project.id, {})"
      ]
    },
    {
      "file": "services/project_next_action_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectNextActionService._format_hint",
      "line": 78,
      "decorators": [],
      "context_snippet": [
        "    def _format_hint(self, template, stats):",
        "        if not template:",
        "            return \"\""
      ]
    },
    {
      "file": "services/project_next_action_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectNextActionService._is_expr_safe",
      "line": 94,
      "decorators": [],
      "context_snippet": [
        "    def _is_expr_safe(self, expr):",
        "        if not expr:",
        "            return True"
      ]
    },
    {
      "file": "services/project_overview_service.py",
      "symbol_type": "module",
      "qualified_name": "project_overview_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from collections import defaultdict",
        "import logging"
      ]
    },
    {
      "file": "services/project_overview_service.py",
      "symbol_type": "class",
      "qualified_name": "ProjectOverviewService",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "class ProjectOverviewService(models.AbstractModel):",
        "    _name = \"sc.project.overview.service\"",
        "    _description = \"Project Overview Aggregation Service\""
      ]
    },
    {
      "file": "services/project_overview_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectOverviewService.get_overview",
      "line": 16,
      "decorators": [
        "api.model"
      ],
      "context_snippet": [
        "    def get_overview(self, project_ids):",
        "        ids = [pid for pid in (project_ids or []) if pid]",
        "        data = {pid: {"
      ]
    },
    {
      "file": "services/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import insight",
        "from . import project_overview_service"
      ]
    },
    {
      "file": "services/insight/dto.py",
      "symbol_type": "module",
      "qualified_name": "dto",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/insight/dto.py",
      "symbol_type": "class",
      "qualified_name": "InsightSummary",
      "line": 9,
      "decorators": [
        "dataclass"
      ],
      "context_snippet": [
        "class InsightSummary:",
        "    level: str               # info | warning | risk",
        "    title: str               # short label"
      ]
    },
    {
      "file": "services/insight/dto.py",
      "symbol_type": "class",
      "qualified_name": "BusinessInsight",
      "line": 25,
      "decorators": [
        "dataclass"
      ],
      "context_snippet": [
        "class BusinessInsight:",
        "    object: str",
        "    object_id: int"
      ]
    },
    {
      "file": "services/insight/dto.py",
      "symbol_type": "method",
      "qualified_name": "InsightSummary.to_dict",
      "line": 18,
      "decorators": [],
      "context_snippet": [
        "    def to_dict(self) -> Dict[str, Any]:",
        "        data = asdict(self)",
        "        # prune None to keep payload clean"
      ]
    },
    {
      "file": "services/insight/dto.py",
      "symbol_type": "method",
      "qualified_name": "BusinessInsight.to_dict",
      "line": 33,
      "decorators": [],
      "context_snippet": [
        "    def to_dict(self) -> Dict[str, Any]:",
        "        data = {",
        "            \"object\": self.object,"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "module",
      "qualified_name": "project_insight_service",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from __future__ import annotations",
        ""
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_get_schedule_dates",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "def _get_schedule_dates(project, safe_getattr):",
        "    # Prefer system daterange fields (date_start/date) used by Odoo form view.",
        "    primary_start = safe_getattr(project, \"date_start\")"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_check_missing_schedule",
      "line": 33,
      "decorators": [],
      "context_snippet": [
        "def _check_missing_schedule(project, safe_getattr) -> bool:",
        "    start, end = _get_schedule_dates(project, safe_getattr)",
        "    if start is MISSING or end is MISSING:"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_check_missing_manager",
      "line": 40,
      "decorators": [],
      "context_snippet": [
        "def _check_missing_manager(project, safe_getattr) -> bool:",
        "    manager = safe_getattr(project, \"manager_id\")",
        "    if manager is MISSING:"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_check_missing_wbs",
      "line": 47,
      "decorators": [],
      "context_snippet": [
        "def _check_missing_wbs(project, safe_getattr) -> bool:",
        "    ready = safe_getattr(project, \"wbs_ready\")",
        "    if ready is MISSING:"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_check_missing_boq",
      "line": 54,
      "decorators": [],
      "context_snippet": [
        "def _check_missing_boq(project, safe_getattr) -> bool:",
        "    imported = safe_getattr(project, \"boq_imported\")",
        "    if imported is MISSING:"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_build_initiation_v0_3",
      "line": 105,
      "decorators": [],
      "context_snippet": [
        "def _build_initiation_v0_3(risks, risk_count):",
        "    def priority(risk):",
        "        return risk.get(\"priority\", 999)"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "_build_ui_model",
      "line": 161,
      "decorators": [],
      "context_snippet": [
        "def _build_ui_model(initiation: Dict[str, Any]) -> Dict[str, Any]:",
        "    risks = initiation.get(\"risks\") or []",
        "    risk_count = initiation.get(\"risk_count\", len(risks))"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "priority",
      "line": 106,
      "decorators": [],
      "context_snippet": [
        "    def priority(risk):",
        "        return risk.get(\"priority\", 999)",
        ""
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "is_actionable",
      "line": 109,
      "decorators": [],
      "context_snippet": [
        "    def is_actionable(risk):",
        "        return bool((risk.get(\"recommended_action\") or {}).get(\"target\"))",
        ""
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "map_item",
      "line": 140,
      "decorators": [],
      "context_snippet": [
        "    def map_item(risk):",
        "        return {",
        "            \"rule_key\": risk.get(\"rule_key\"),"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "risk_priority",
      "line": 178,
      "decorators": [],
      "context_snippet": [
        "    def risk_priority(risk):",
        "        return risk.get(\"priority\", 999)",
        ""
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "map_best",
      "line": 206,
      "decorators": [],
      "context_snippet": [
        "    def map_best(risk):",
        "        target = (risk.get(\"recommended_action\") or {}).get(\"target\") or \"\"",
        "        cta = cta_map.get(target) or {"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "function",
      "qualified_name": "map_more",
      "line": 224,
      "decorators": [],
      "context_snippet": [
        "    def map_more(risk):",
        "        target = (risk.get(\"recommended_action\") or {}).get(\"target\") or \"\"",
        "        label = label_map.get(target) or (risk.get(\"recommended_action\") or {}).get(\"label\") or _(\"去完善\")"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectInsightService.get_insight",
      "line": 271,
      "decorators": [],
      "context_snippet": [
        "    def get_insight(self, project, scene: Optional[str] = None) -> Dict[str, Any]:",
        "        scene = scene or self.SCENE_PROJECT_ENTRY",
        "        if scene == self.SCENE_PROJECT_ENTRY:"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectInsightService._insight_project_entry",
      "line": 296,
      "decorators": [],
      "context_snippet": [
        "    def _insight_project_entry(self, project) -> BusinessInsight:",
        "        stage = self._get_stage(project)",
        ""
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectInsightService._get_stage",
      "line": 353,
      "decorators": [],
      "context_snippet": [
        "    def _get_stage(self, project) -> str:",
        "        # Prefer explicit stage name if present",
        "        stage_id = self._safe_getattr(project, \"stage_id\")"
      ]
    },
    {
      "file": "services/insight/project_insight_service.py",
      "symbol_type": "method",
      "qualified_name": "ProjectInsightService._safe_getattr",
      "line": 369,
      "decorators": [],
      "context_snippet": [
        "    def _safe_getattr(self, record, name):",
        "        try:",
        "            if name not in record._fields:"
      ]
    },
    {
      "file": "services/insight/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import dto",
        "from . import project_insight_service"
      ]
    },
    {
      "file": "tests/perm_matrix.py",
      "symbol_type": "module",
      "qualified_name": "perm_matrix",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "",
        "# 权限矩阵单一事实源（可被测试读取生成用例）"
      ]
    },
    {
      "file": "tests/risk_actions.py",
      "symbol_type": "module",
      "qualified_name": "risk_actions",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "",
        "# 高风险动作清单（需要显式 groups_id）"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_acl_matrix_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import csv",
        "import logging"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestAclMatrixGate.setUpClass",
      "line": 84,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestAclMatrixGate._rights",
      "line": 103,
      "decorators": [],
      "context_snippet": [
        "    def _rights(self, user, model_name):",
        "        if model_name not in self.env:",
        "            return None"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestAclMatrixGate._audit_path",
      "line": 109,
      "decorators": [],
      "context_snippet": [
        "    def _audit_path(self):",
        "        repo_root = os.path.abspath(",
        "            os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, os.pardir)"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestAclMatrixGate._write_audit_csv",
      "line": 125,
      "decorators": [],
      "context_snippet": [
        "    def _write_audit_csv(self):",
        "        target = self._audit_path()",
        "        rows = []"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestAclMatrixGate._write_p1_acl_sources",
      "line": 161,
      "decorators": [],
      "context_snippet": [
        "    def _write_p1_acl_sources(self):",
        "        repo_root = os.path.abspath(",
        "            os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, os.pardir)"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestAclMatrixGate.test_acl_matrix_gate",
      "line": 217,
      "decorators": [],
      "context_snippet": [
        "    def test_acl_matrix_gate(self):",
        "        failures = []",
        "        missing = []"
      ]
    },
    {
      "file": "tests/test_acl_matrix_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 88,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_action_groups_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_action_groups_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo.tests.common import tagged"
      ]
    },
    {
      "file": "tests/test_action_groups_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestActionGroupsGate.setUpClass",
      "line": 11,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        cls.module_name = \"smart_construction_core\""
      ]
    },
    {
      "file": "tests/test_action_groups_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestActionGroupsGate.test_actions_have_groups",
      "line": 16,
      "decorators": [],
      "context_snippet": [
        "    def test_actions_have_groups(self):",
        "        imd = self.env[\"ir.model.data\"].search(",
        "            [(\"module\", \"=\", self.module_name), (\"model\", \"in\", self.models)]"
      ]
    },
    {
      "file": "tests/test_action_groups_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestActionGroupsGate.test_menu_action_bypass",
      "line": 31,
      "decorators": [],
      "context_snippet": [
        "    def test_menu_action_bypass(self):",
        "        menus = self.env[\"ir.ui.menu\"].search([])",
        "        risky = []"
      ]
    },
    {
      "file": "tests/test_budget.py",
      "symbol_type": "module",
      "qualified_name": "test_budget",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo.tests.common import tagged"
      ]
    },
    {
      "file": "tests/test_budget.py",
      "symbol_type": "class",
      "qualified_name": "TestProjectBudget",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestProjectBudget(TransactionCase):",
        "",
        "    def setUp(self):"
      ]
    },
    {
      "file": "tests/test_budget.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectBudget.setUp",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.project = self.env[\"project.project\"].create({"
      ]
    },
    {
      "file": "tests/test_budget.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectBudget.test_budget_unique_version",
      "line": 16,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_budget_unique_version(self):",
        "        budget = self.env[\"project.budget\"].create({",
        "            \"name\": \"Budget V1\","
      ]
    },
    {
      "file": "tests/test_budget.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectBudget.test_budget_copy_without_alloc",
      "line": 30,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_budget_copy_without_alloc(self):",
        "        budget = self.env[\"project.budget\"].create({",
        "            \"name\": \"Budget\","
      ]
    },
    {
      "file": "tests/test_capability_lint_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_capability_lint_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests.common import TransactionCase, tagged",
        ""
      ]
    },
    {
      "file": "tests/test_capability_lint_gate.py",
      "symbol_type": "class",
      "qualified_name": "TestCapabilityLintGate",
      "line": 6,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestCapabilityLintGate(TransactionCase):",
        "    def test_capability_lint_passes(self):",
        "        issues = self.env[\"sc.capability\"].lint_capabilities()"
      ]
    },
    {
      "file": "tests/test_capability_lint_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestCapabilityLintGate.test_capability_lint_passes",
      "line": 7,
      "decorators": [],
      "context_snippet": [
        "    def test_capability_lint_passes(self):",
        "        issues = self.env[\"sc.capability\"].lint_capabilities()",
        "        self.assertFalse(issues, f\"capability lint issues: {issues}\")"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "module",
      "qualified_name": "test_contract_center",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo.tests.common import tagged"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "class",
      "qualified_name": "TestConstructionContract",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestConstructionContract(TransactionCase):",
        "    def _ensure_tax_group(self):",
        "        country = self.env.ref(\"base.cn\", raise_if_not_found=False)"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "method",
      "qualified_name": "TestConstructionContract._ensure_tax_group",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_tax_group(self):",
        "        country = self.env.ref(\"base.cn\", raise_if_not_found=False)",
        "        company = self.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "method",
      "qualified_name": "TestConstructionContract._create_test_tax",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "    def _create_test_tax(self, name, amount, tax_use):",
        "        company = self.env.ref(\"base.main_company\")",
        "        country = self.env.ref(\"base.cn\", raise_if_not_found=False)"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "method",
      "qualified_name": "TestConstructionContract.setUp",
      "line": 42,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.project = self.env[\"project.project\"].create({\"name\": \"合同中心测试项目\"})"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "method",
      "qualified_name": "TestConstructionContract.test_contract_state_and_amount",
      "line": 75,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_contract_state_and_amount(self):",
        "        contract = self.env[\"construction.contract\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_contract_center.py",
      "symbol_type": "method",
      "qualified_name": "TestConstructionContract.test_generate_lines_from_budget",
      "line": 118,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_generate_lines_from_budget(self):",
        "        contract = self.env[\"construction.contract\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_contract_link_integrity.py",
      "symbol_type": "module",
      "qualified_name": "test_contract_link_integrity",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import UserError",
        "from odoo.tests import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_contract_link_integrity.py",
      "symbol_type": "class",
      "qualified_name": "TestContractLinkIntegrity",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestContractLinkIntegrity(TransactionCase):",
        "    def setUp(self):",
        "        super().setUp()"
      ]
    },
    {
      "file": "tests/test_contract_link_integrity.py",
      "symbol_type": "method",
      "qualified_name": "TestContractLinkIntegrity.setUp",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.company = self.env.company"
      ]
    },
    {
      "file": "tests/test_contract_link_integrity.py",
      "symbol_type": "method",
      "qualified_name": "TestContractLinkIntegrity.test_referenced_contract_cannot_reset_or_cancel",
      "line": 42,
      "decorators": [],
      "context_snippet": [
        "    def test_referenced_contract_cannot_reset_or_cancel(self):",
        "        # 创建引用单据（付款申请）",
        "        self.env[\"payment.request\"].create("
      ]
    },
    {
      "file": "tests/test_cost_compare.py",
      "symbol_type": "module",
      "qualified_name": "test_cost_compare",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo.tests.common import tagged"
      ]
    },
    {
      "file": "tests/test_cost_compare.py",
      "symbol_type": "class",
      "qualified_name": "TestProjectCostCompare",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestProjectCostCompare(TransactionCase):",
        "",
        "    def setUp(self):"
      ]
    },
    {
      "file": "tests/test_cost_compare.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectCostCompare.setUp",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.project = self.env[\"project.project\"].create({\"name\": \"Compare Project\"})"
      ]
    },
    {
      "file": "tests/test_cost_compare.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectCostCompare.test_compare_view_records",
      "line": 50,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_compare_view_records(self):",
        "        records = self.env[\"project.cost.compare\"].search([",
        "            (\"project_id\", \"=\", self.project.id),"
      ]
    },
    {
      "file": "tests/test_high_risk_actions.py",
      "symbol_type": "module",
      "qualified_name": "test_high_risk_actions",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        ""
      ]
    },
    {
      "file": "tests/test_high_risk_actions.py",
      "symbol_type": "method",
      "qualified_name": "TestHighRiskActions.test_high_risk_actions_have_groups",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "    def test_high_risk_actions_have_groups(self):",
        "        missing_groups = []",
        "        missing_xmlid = []"
      ]
    },
    {
      "file": "tests/test_install_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_install_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests.common import TransactionCase, tagged",
        ""
      ]
    },
    {
      "file": "tests/test_install_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestInstallGate.setUpClass",
      "line": 10,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        cls.module = \"smart_construction_core\""
      ]
    },
    {
      "file": "tests/test_install_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestInstallGate.test_required_external_ids_exist",
      "line": 20,
      "decorators": [],
      "context_snippet": [
        "    def test_required_external_ids_exist(self):",
        "        required = [",
        "            \"smart_construction_core.group_sc_super_admin\","
      ]
    },
    {
      "file": "tests/test_install_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestInstallGate.test_actions_have_groups_at_install",
      "line": 31,
      "decorators": [],
      "context_snippet": [
        "    def test_actions_have_groups_at_install(self):",
        "        action_imd = self.imd.search(",
        "            [(\"module\", \"=\", self.module), (\"model\", \"in\", self.action_models)]"
      ]
    },
    {
      "file": "tests/test_install_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestInstallGate.test_menu_action_bypass_at_install",
      "line": 42,
      "decorators": [],
      "context_snippet": [
        "    def test_menu_action_bypass_at_install(self):",
        "        menu_imd = self.imd.search(",
        "            [(\"module\", \"=\", self.module), (\"model\", \"=\", \"ir.ui.menu\")]"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_p0_finance_aggregate_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import AccessError",
        "from odoo.tests.common import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.setUpClass",
      "line": 18,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate._project_ids_from_groups",
      "line": 190,
      "decorators": [],
      "context_snippet": [
        "    def _project_ids_from_groups(self, groups):",
        "        return {g.get(\"project_id\")[0] for g in groups if g.get(\"project_id\")}",
        ""
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate._read_group_project_ids",
      "line": 193,
      "decorators": [],
      "context_snippet": [
        "    def _read_group_project_ids(self, model, user):",
        "        groups = (",
        "            self.env[model]"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate._sum_read_group_count",
      "line": 201,
      "decorators": [],
      "context_snippet": [
        "    def _sum_read_group_count(self, model, user, domain, groupby=\"project_id\"):",
        "        groups = (",
        "            self.env[model]"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate._sum_read_group_value",
      "line": 221,
      "decorators": [],
      "context_snippet": [
        "    def _sum_read_group_value(self, model, user, field, domain, groupby=\"project_id\"):",
        "        groups = (",
        "            self.env[model]"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate._sum_search_field",
      "line": 232,
      "decorators": [],
      "context_snippet": [
        "    def _sum_search_field(self, model, user, field, domain):",
        "        values = self.env[model].with_user(user).search(domain).mapped(field)",
        "        return sum(values or [])"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate._assert_aggregate_consistency",
      "line": 236,
      "decorators": [],
      "context_snippet": [
        "    def _assert_aggregate_consistency(self, model, user, domain, groupby=\"project_id\"):",
        "        count = self.env[model].with_user(user).search_count(domain)",
        "        rg_total = self._sum_read_group_count(model, user, domain, groupby=groupby)"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_read_group_denied_non_finance",
      "line": 245,
      "decorators": [],
      "context_snippet": [
        "    def test_read_group_denied_non_finance(self):",
        "        for model in [",
        "            \"payment.request\","
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_read_group_sum_denied_non_finance",
      "line": 255,
      "decorators": [],
      "context_snippet": [
        "    def test_read_group_sum_denied_non_finance(self):",
        "        for model, field in self._SUM_FIELDS:",
        "            with self.assertRaises(AccessError):"
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_search_count_denied_non_finance",
      "line": 260,
      "decorators": [],
      "context_snippet": [
        "    def test_search_count_denied_non_finance(self):",
        "        for model in [",
        "            \"payment.request\","
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_read_group_scope_finance_read",
      "line": 270,
      "decorators": [],
      "context_snippet": [
        "    def test_read_group_scope_finance_read(self):",
        "        expected = {self.project_same.id}",
        "        for model in ["
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_read_group_scope_finance_manager",
      "line": 281,
      "decorators": [],
      "context_snippet": [
        "    def test_read_group_scope_finance_manager(self):",
        "        expected = {self.project_same.id, self.project_other.id}",
        "        for model in ["
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_aggregate_consistency_finance_read",
      "line": 294,
      "decorators": [],
      "context_snippet": [
        "    def test_aggregate_consistency_finance_read(self):",
        "        for model in [",
        "            \"payment.request\","
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_aggregate_consistency_finance_manager",
      "line": 305,
      "decorators": [],
      "context_snippet": [
        "    def test_aggregate_consistency_finance_manager(self):",
        "        for model in [",
        "            \"payment.request\","
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_aggregate_sum_parity_finance_read",
      "line": 316,
      "decorators": [],
      "context_snippet": [
        "    def test_aggregate_sum_parity_finance_read(self):",
        "        for model, field in self._SUM_FIELDS:",
        "            rg_total = self._sum_read_group_value("
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceAggregateGate.test_aggregate_sum_parity_finance_manager",
      "line": 331,
      "decorators": [],
      "context_snippet": [
        "    def test_aggregate_sum_parity_finance_manager(self):",
        "        for model, field in self._SUM_FIELDS:",
        "            rg_total = self._sum_read_group_value("
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "function",
      "qualified_name": "_ctx",
      "line": 29,
      "decorators": [],
      "context_snippet": [
        "        def _ctx(model):",
        "            return cls.env[model].with_context(ctx)",
        ""
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_p0_finance_aggregate_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_contract",
      "line": 98,
      "decorators": [],
      "context_snippet": [
        "        def _create_contract(name, project, partner):",
        "            return _ctx(\"construction.contract\").create(",
        "                {"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_p0_finance_rr_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import AccessError",
        "from odoo.tests.common import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.setUpClass",
      "line": 11,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate._project_ids_from_groups",
      "line": 154,
      "decorators": [],
      "context_snippet": [
        "    def _project_ids_from_groups(self, groups):",
        "        return {g.get(\"project_id\")[0] for g in groups if g.get(\"project_id\")}",
        ""
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate._assert_groups_include",
      "line": 157,
      "decorators": [],
      "context_snippet": [
        "    def _assert_groups_include(self, record, required_xmlids):",
        "        self.assertTrue(record.groups_id, \"Expected groups on record but found none\")",
        "        required_ids = {self.env.ref(xmlid).id for xmlid in required_xmlids}"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_action_menu_groups_for_payment_request",
      "line": 165,
      "decorators": [],
      "context_snippet": [
        "    def test_action_menu_groups_for_payment_request(self):",
        "        action_payment_request = self.env.ref(",
        "            \"smart_construction_core.action_payment_request\""
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_action_menu_groups_for_settlement_order",
      "line": 199,
      "decorators": [],
      "context_snippet": [
        "    def test_action_menu_groups_for_settlement_order(self):",
        "        action_settlement_order = self.env.ref(",
        "            \"smart_construction_core.action_sc_settlement_order\""
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_payment_request_read_group_scope_finance_read",
      "line": 214,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_read_group_scope_finance_read(self):",
        "        groups = (",
        "            self.env[\"payment.request\"]"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_payment_request_read_group_scope_finance_manager",
      "line": 223,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_read_group_scope_finance_manager(self):",
        "        groups = (",
        "            self.env[\"payment.request\"]"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_payment_request_read_group_denied_non_finance",
      "line": 232,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_read_group_denied_non_finance(self):",
        "        with self.assertRaises(AccessError):",
        "            self.env[\"payment.request\"].with_user(self.user_no_access).read_group("
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_settlement_read_group_scope_finance_read",
      "line": 238,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_read_group_scope_finance_read(self):",
        "        groups = (",
        "            self.env[\"sc.settlement.order\"]"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_settlement_read_group_scope_finance_manager",
      "line": 247,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_read_group_scope_finance_manager(self):",
        "        groups = (",
        "            self.env[\"sc.settlement.order\"]"
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceRrGate.test_settlement_read_group_denied_non_finance",
      "line": 256,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_read_group_denied_non_finance(self):",
        "        with self.assertRaises(AccessError):",
        "            self.env[\"sc.settlement.order\"].with_user(self.user_no_access).read_group("
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "function",
      "qualified_name": "_ctx",
      "line": 22,
      "decorators": [],
      "context_snippet": [
        "        def _ctx(model):",
        "            return cls.env[model].with_context(ctx)",
        ""
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_p0_finance_rr_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_contract",
      "line": 98,
      "decorators": [],
      "context_snippet": [
        "        def _create_contract(name, project, partner):",
        "            return _ctx(\"construction.contract\").create(",
        "                {"
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_p0_finance_ui_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from lxml import etree",
        ""
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceUiGate._get_form_arch",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "    def _get_form_arch(self, model):",
        "        model_env = self.env[model]",
        "        if hasattr(model_env, \"get_view\"):"
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceUiGate._iter_buttons",
      "line": 21,
      "decorators": [],
      "context_snippet": [
        "    def _iter_buttons(self, arch):",
        "        root = etree.fromstring(arch.encode(\"utf-8\"))",
        "        return root.xpath(\".//button\")"
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceUiGate._is_high_risk_button",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "    def _is_high_risk_button(self, btn):",
        "        btn_type = (btn.get(\"type\") or \"\").strip()",
        "        name = (btn.get(\"name\") or \"\").strip()"
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceUiGate._assert_buttons_have_groups",
      "line": 34,
      "decorators": [],
      "context_snippet": [
        "    def _assert_buttons_have_groups(self, model, ignore_names=None):",
        "        ignore_names = set(ignore_names or [])",
        "        offenders = []"
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceUiGate.test_ui_buttons_groups_payment_request",
      "line": 62,
      "decorators": [],
      "context_snippet": [
        "    def test_ui_buttons_groups_payment_request(self):",
        "        self._assert_buttons_have_groups(\"payment.request\")",
        ""
      ]
    },
    {
      "file": "tests/test_p0_finance_ui_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0FinanceUiGate.test_ui_buttons_groups_settlement_order",
      "line": 65,
      "decorators": [],
      "context_snippet": [
        "    def test_ui_buttons_groups_settlement_order(self):",
        "        self._assert_buttons_have_groups(\"sc.settlement.order\")",
        ""
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_p0_ledger_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import AccessError, UserError",
        "from odoo.tests.common import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.setUpClass",
      "line": 11,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_create_ledger_from_approved_payment",
      "line": 205,
      "decorators": [],
      "context_snippet": [
        "    def test_create_ledger_from_approved_payment(self):",
        "        ledger = self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger()",
        "        self.assertEqual(ledger.payment_request_id.id, self.payment_ok.id)"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_ledger_idempotent_per_request",
      "line": 210,
      "decorators": [],
      "context_snippet": [
        "    def test_ledger_idempotent_per_request(self):",
        "        first = self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger()",
        "        second = self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger()"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_ledger_amount_matches_request",
      "line": 219,
      "decorators": [],
      "context_snippet": [
        "    def test_ledger_amount_matches_request(self):",
        "        ledger = self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger()",
        "        self.assertEqual(ledger.amount, self.payment_ok.amount)"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_block_when_settlement_not_approved",
      "line": 223,
      "decorators": [],
      "context_snippet": [
        "    def test_block_when_settlement_not_approved(self):",
        "        with self.assertRaises(UserError):",
        "            self.payment_bad_settlement.with_user(self.user_finance_user)._ensure_payment_ledger()"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_block_unauthorized_create",
      "line": 227,
      "decorators": [],
      "context_snippet": [
        "    def test_block_unauthorized_create(self):",
        "        with self.assertRaises(AccessError):",
        "            self.payment_ok.with_user(self.user_finance_read)._ensure_payment_ledger()"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_block_create_without_context",
      "line": 231,
      "decorators": [],
      "context_snippet": [
        "    def test_block_create_without_context(self):",
        "        with self.assertRaises(UserError):",
        "            self.env[\"payment.ledger\"].with_user(self.user_finance_user).create("
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_block_duplicate_create",
      "line": 240,
      "decorators": [],
      "context_snippet": [
        "    def test_block_duplicate_create(self):",
        "        self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger()",
        "        with self.assertRaises(UserError):"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_block_overpay",
      "line": 252,
      "decorators": [],
      "context_snippet": [
        "    def test_block_overpay(self):",
        "        with self.assertRaises(UserError):",
        "            self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger(amount=1000.0)"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_ui_blocks_direct_ledger_create",
      "line": 256,
      "decorators": [],
      "context_snippet": [
        "    def test_ui_blocks_direct_ledger_create(self):",
        "        tree_view = self.env.ref(\"smart_construction_core.view_payment_ledger_tree\").arch_db",
        "        form_view = self.env.ref(\"smart_construction_core.view_payment_ledger_form\").arch_db"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_ui_blocks_ledger_lines_inline_create",
      "line": 266,
      "decorators": [],
      "context_snippet": [
        "    def test_ui_blocks_ledger_lines_inline_create(self):",
        "        view = self.env.ref(\"smart_construction_core.view_payment_request_form\").arch_db",
        "        self.assertIn('name=\"ledger_line_ids\"', view)"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_rr_ledger_read_scope_finance_read",
      "line": 271,
      "decorators": [],
      "context_snippet": [
        "    def test_rr_ledger_read_scope_finance_read(self):",
        "        ledger = self.payment_ok.with_user(self.user_finance_user)._ensure_payment_ledger()",
        "        can_read = self.env[\"payment.ledger\"].with_user(self.user_finance_read).search_count("
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_rr_ledger_read_denied_non_finance",
      "line": 282,
      "decorators": [],
      "context_snippet": [
        "    def test_rr_ledger_read_denied_non_finance(self):",
        "        with self.assertRaises(AccessError):",
        "            self.env[\"payment.ledger\"].with_user(self.user_no_access).search_count([])"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_action_menu_groups_for_ledger",
      "line": 286,
      "decorators": [],
      "context_snippet": [
        "    def test_action_menu_groups_for_ledger(self):",
        "        action = self.env.ref(\"smart_construction_core.action_payment_ledger\")",
        "        menu = self.env.ref(\"smart_construction_core.menu_payment_ledger\")"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_rr_treasury_read_scope_finance_read",
      "line": 292,
      "decorators": [],
      "context_snippet": [
        "    def test_rr_treasury_read_scope_finance_read(self):",
        "        can_read = self.env[\"sc.treasury.ledger\"].with_user(self.user_finance_read).search_count(",
        "            [(\"id\", \"=\", self.treasury_same.id)]"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_rr_treasury_read_denied_non_finance",
      "line": 302,
      "decorators": [],
      "context_snippet": [
        "    def test_rr_treasury_read_denied_non_finance(self):",
        "        with self.assertRaises(AccessError):",
        "            self.env[\"sc.treasury.ledger\"].with_user(self.user_no_access).search_count([])"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestP0LedgerGate.test_action_menu_groups_for_treasury_ledger",
      "line": 306,
      "decorators": [],
      "context_snippet": [
        "    def test_action_menu_groups_for_treasury_ledger(self):",
        "        action = self.env.ref(\"smart_construction_core.action_sc_treasury_ledger\")",
        "        menu = self.env.ref(\"smart_construction_core.menu_sc_treasury_ledger\")"
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "function",
      "qualified_name": "_ctx",
      "line": 22,
      "decorators": [],
      "context_snippet": [
        "        def _ctx(model):",
        "            return cls.env[model].with_context(ctx)",
        ""
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_p0_ledger_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_contract",
      "line": 85,
      "decorators": [],
      "context_snippet": [
        "        def _create_contract(name, project, partner):",
        "            return _ctx(\"construction.contract\").create(",
        "                {"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "module",
      "qualified_name": "test_p0_state_closure",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import base64",
        ""
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "class",
      "qualified_name": "TestP0StateClosure",
      "line": 10,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestP0StateClosure(TransactionCase):",
        "    def setUp(self):",
        "        super().setUp()"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.setUp",
      "line": 11,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.company = self.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_project",
      "line": 16,
      "decorators": [],
      "context_snippet": [
        "    def _create_project(self, name, with_boq=False):",
        "        owner = self._create_partner(f\"{name} Owner\")",
        "        project = self.env[\"project.project\"].create("
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_partner",
      "line": 39,
      "decorators": [],
      "context_snippet": [
        "    def _create_partner(self, name=\"P0 Partner\"):",
        "        return self.env[\"res.partner\"].create({\"name\": name})",
        ""
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_tax",
      "line": 42,
      "decorators": [],
      "context_snippet": [
        "    def _create_tax(self, name=\"P0 VAT 9%\", tax_use=\"purchase\"):",
        "        return self.env[\"account.tax\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_contract",
      "line": 54,
      "decorators": [],
      "context_snippet": [
        "    def _create_contract(self, project, partner):",
        "        tax = self._create_tax()",
        "        return self.env[\"construction.contract\"].create("
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_finance_user",
      "line": 66,
      "decorators": [],
      "context_snippet": [
        "    def _create_finance_user(self, login=\"p0_finance_user_state_closure\"):",
        "        finance_group = self.env.ref(\"smart_construction_core.group_sc_cap_finance_user\")",
        "        return self.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_purchase_order",
      "line": 79,
      "decorators": [],
      "context_snippet": [
        "    def _create_purchase_order(self, partner):",
        "        product = self.env[\"product.product\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._enable_funding",
      "line": 110,
      "decorators": [],
      "context_snippet": [
        "    def _enable_funding(self, project, cap=1000.0):",
        "        project.write({\"funding_enabled\": True})",
        "        self.env[\"project.funding.baseline\"].create("
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_settlement_order",
      "line": 116,
      "decorators": [],
      "context_snippet": [
        "    def _create_settlement_order(",
        "        self, project, partner, contract, amount=100.0, state=\"approve\", purchase_orders=None",
        "    ):"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._attach_dummy",
      "line": 132,
      "decorators": [],
      "context_snippet": [
        "    def _attach_dummy(self, record, name=\"test.pdf\"):",
        "        self.env[\"ir.attachment\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure._create_settlement",
      "line": 144,
      "decorators": [],
      "context_snippet": [
        "    def _create_settlement(self, project, partner, state=\"confirmed\"):",
        "        return self.env[\"project.settlement\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_project_lifecycle_requires_boq",
      "line": 154,
      "decorators": [],
      "context_snippet": [
        "    def test_project_lifecycle_requires_boq(self):",
        "        project = self._create_project(\"P0 Project No BOQ\")",
        "        with self.assertRaises(UserError):"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_project_lifecycle_blocked_by_settlement",
      "line": 163,
      "decorators": [],
      "context_snippet": [
        "    def test_project_lifecycle_blocked_by_settlement(self):",
        "        project = self._create_project(\"P0 Project Settlement\", with_boq=True)",
        "        partner = self._create_partner()"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_project_lifecycle_blocked_by_payment",
      "line": 170,
      "decorators": [],
      "context_snippet": [
        "    def test_project_lifecycle_blocked_by_payment(self):",
        "        project = self._create_project(\"P0 Project Payment\", with_boq=True)",
        "        partner = self._create_partner(\"P0 Payee\")"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_payment_requires_settlement_approved",
      "line": 205,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_requires_settlement_approved(self):",
        "        project = self._create_project(\"P0 Project Settle State\", with_boq=True)",
        "        partner = self._create_partner()"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_payment_overpay_blocked",
      "line": 227,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_overpay_blocked(self):",
        "        project = self._create_project(\"P0 Project Overpay\", with_boq=True)",
        "        partner = self._create_partner()"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_payment_write_approved_requires_tier",
      "line": 249,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_write_approved_requires_tier(self):",
        "        project = self._create_project(\"P0 Project Tier\", with_boq=True)",
        "        partner = self._create_partner()"
      ]
    },
    {
      "file": "tests/test_p0_state_closure.py",
      "symbol_type": "method",
      "qualified_name": "TestP0StateClosure.test_settlement_cancel_blocked_when_payments_exist",
      "line": 271,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_cancel_blocked_when_payments_exist(self):",
        "        project = self._create_project(\"P0 Project Cancel\", with_boq=True)",
        "        partner = self._create_partner()"
      ]
    },
    {
      "file": "tests/test_permission_doc_sync.py",
      "symbol_type": "module",
      "qualified_name": "test_permission_doc_sync",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import json",
        "import os"
      ]
    },
    {
      "file": "tests/test_permission_doc_sync.py",
      "symbol_type": "method",
      "qualified_name": "TestPermissionDocSync.test_perm_matrix_doc_block_matches_code",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "    def test_perm_matrix_doc_block_matches_code(self):",
        "        repo_root = os.path.abspath(",
        "            os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, os.pardir)"
      ]
    },
    {
      "file": "tests/test_permission_matrix.py",
      "symbol_type": "module",
      "qualified_name": "test_permission_matrix",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        ""
      ]
    },
    {
      "file": "tests/test_permission_matrix.py",
      "symbol_type": "method",
      "qualified_name": "TestPermissionMatrix.setUpClass",
      "line": 16,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_permission_matrix.py",
      "symbol_type": "method",
      "qualified_name": "TestPermissionMatrix._action_allowed",
      "line": 37,
      "decorators": [],
      "context_snippet": [
        "    def _action_allowed(self, user, action_xmlid):",
        "        action = self.env.ref(action_xmlid)",
        "        if not hasattr(action, \"groups_id\") or not action.groups_id:"
      ]
    },
    {
      "file": "tests/test_permission_matrix.py",
      "symbol_type": "method",
      "qualified_name": "TestPermissionMatrix._menu_visible",
      "line": 43,
      "decorators": [],
      "context_snippet": [
        "    def _menu_visible(self, user, menu_xmlid):",
        "        menu = self.env.ref(menu_xmlid)",
        "        if not menu.groups_id:"
      ]
    },
    {
      "file": "tests/test_permission_matrix.py",
      "symbol_type": "method",
      "qualified_name": "TestPermissionMatrix.test_permission_matrix",
      "line": 49,
      "decorators": [],
      "context_snippet": [
        "    def test_permission_matrix(self):",
        "        failures = []",
        "        for role, cfg in PERM_MATRIX.items():"
      ]
    },
    {
      "file": "tests/test_permission_matrix.py",
      "symbol_type": "function",
      "qualified_name": "_create",
      "line": 20,
      "decorators": [],
      "context_snippet": [
        "        def _create(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_profit_compare.py",
      "symbol_type": "module",
      "qualified_name": "test_profit_compare",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo.tests.common import tagged"
      ]
    },
    {
      "file": "tests/test_profit_compare.py",
      "symbol_type": "class",
      "qualified_name": "TestProjectProfitCompare",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestProjectProfitCompare(TransactionCase):",
        "",
        "    def setUp(self):"
      ]
    },
    {
      "file": "tests/test_profit_compare.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectProfitCompare.setUp",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.project = self.env[\"project.project\"].create({\"name\": \"Profit Project\"})"
      ]
    },
    {
      "file": "tests/test_profit_compare.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectProfitCompare.test_profit_view_records",
      "line": 92,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_profit_view_records(self):",
        "        records = self.env[\"project.profit.compare\"].search([",
        "            (\"project_id\", \"=\", self.project.id),"
      ]
    },
    {
      "file": "tests/test_project_state_transition_validation.py",
      "symbol_type": "module",
      "qualified_name": "test_project_state_transition_validation",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import ValidationError",
        "from odoo.tests.common import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_project_state_transition_validation.py",
      "symbol_type": "class",
      "qualified_name": "TestProjectStateTransitionValidation",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestProjectStateTransitionValidation(TransactionCase):",
        "    def setUp(self):",
        "        super().setUp()"
      ]
    },
    {
      "file": "tests/test_project_state_transition_validation.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectStateTransitionValidation.setUp",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.uom_unit = self.env.ref(\"uom.product_uom_unit\")"
      ]
    },
    {
      "file": "tests/test_project_state_transition_validation.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectStateTransitionValidation._create_boq",
      "line": 12,
      "decorators": [],
      "context_snippet": [
        "    def _create_boq(self, project):",
        "        self.env[\"project.boq.line\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_project_state_transition_validation.py",
      "symbol_type": "method",
      "qualified_name": "TestProjectStateTransitionValidation.test_draft_submit_requires_fields",
      "line": 24,
      "decorators": [],
      "context_snippet": [
        "    def test_draft_submit_requires_fields(self):",
        "        project = self.env[\"project.project\"].create({\"name\": \"Draft Project\"})",
        "        self._create_boq(project)"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "module",
      "qualified_name": "test_record_rule_behavior_gate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import AccessError",
        "from odoo.tests.common import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate.setUpClass",
      "line": 11,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate._can_read",
      "line": 197,
      "decorators": [],
      "context_snippet": [
        "    def _can_read(self, user, record):",
        "        Model = self.env[record._name].with_user(user)",
        "        return bool(Model.search_count([(\"id\", \"=\", record.id)]))"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate._assert_write_allowed",
      "line": 201,
      "decorators": [],
      "context_snippet": [
        "    def _assert_write_allowed(self, user, record, values):",
        "        record.with_user(user).write(values)",
        ""
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate._assert_write_denied",
      "line": 204,
      "decorators": [],
      "context_snippet": [
        "    def _assert_write_denied(self, user, record, values):",
        "        with self.assertRaises(AccessError):",
        "            record.with_user(user).write(values)"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate.test_project_project_rules",
      "line": 208,
      "decorators": [],
      "context_snippet": [
        "    def test_project_project_rules(self):",
        "        # Read-only role: can read own project, cannot see others.",
        "        self.assertTrue(self._can_read(self.user_project_read, self.project_read))"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate.test_project_task_rules",
      "line": 227,
      "decorators": [],
      "context_snippet": [
        "    def test_project_task_rules(self):",
        "        # Read-only role: can read tasks on own project, cannot see others.",
        "        self.assertTrue(self._can_read(self.user_project_read, self.task_read))"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate.test_payment_request_rules",
      "line": 246,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_rules(self):",
        "        # Finance read: can read own project, cannot see others.",
        "        self.assertTrue(self._can_read(self.user_finance_read, self.payment_req_read))"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleBehaviorGate.test_settlement_order_rules",
      "line": 263,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_order_rules(self):",
        "        # Settlement read: can read own project, cannot see others.",
        "        self.assertTrue(self._can_read(self.user_settlement_read, self.settlement_read))"
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "function",
      "qualified_name": "_ctx",
      "line": 21,
      "decorators": [],
      "context_snippet": [
        "        def _ctx(model):",
        "            return cls.env[model].with_context(ctx)",
        ""
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 24,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_record_rule_behavior_gate.py",
      "symbol_type": "function",
      "qualified_name": "_create_contract",
      "line": 112,
      "decorators": [],
      "context_snippet": [
        "        def _create_contract(name, project):",
        "            return _ctx(\"construction.contract\").create(",
        "                {"
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "module",
      "qualified_name": "test_record_rule_contract_p1",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import csv",
        "import os"
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleContractP1.setUpClass",
      "line": 13,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleContractP1._can_read",
      "line": 110,
      "decorators": [],
      "context_snippet": [
        "    def _can_read(self, user, record):",
        "        Model = self.env[record._name].with_user(user)",
        "        return bool(Model.search_count([(\"id\", \"=\", record.id)]))"
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleContractP1._audit_path",
      "line": 114,
      "decorators": [],
      "context_snippet": [
        "    def _audit_path(self):",
        "        repo_root = os.path.abspath(",
        "            os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, os.pardir)"
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleContractP1.test_contract_read_visibility_audit",
      "line": 130,
      "decorators": [],
      "context_snippet": [
        "    def test_contract_read_visibility_audit(self):",
        "        rules = self.env[\"ir.rule\"].sudo().search([(\"model_id.model\", \"=\", \"construction.contract\")])",
        "        rule_xmlids = []"
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "function",
      "qualified_name": "_ctx",
      "line": 23,
      "decorators": [],
      "context_snippet": [
        "        def _ctx(model):",
        "            return cls.env[model].with_context(ctx)",
        ""
      ]
    },
    {
      "file": "tests/test_record_rule_contract_p1.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 26,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "module",
      "qualified_name": "test_record_rule_ledger_p1",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import csv",
        "import os"
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleLedgerP1.setUpClass",
      "line": 13,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleLedgerP1._can_read",
      "line": 166,
      "decorators": [],
      "context_snippet": [
        "    def _can_read(self, user, record):",
        "        Model = self.env[record._name].with_user(user)",
        "        return bool(Model.search_count([(\"id\", \"=\", record.id)]))"
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleLedgerP1._rule_xmlids",
      "line": 170,
      "decorators": [],
      "context_snippet": [
        "    def _rule_xmlids(self, model_name):",
        "        rules = self.env[\"ir.rule\"].sudo().search([(\"model_id.model\", \"=\", model_name)])",
        "        xmlids = []"
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleLedgerP1._audit_path",
      "line": 179,
      "decorators": [],
      "context_snippet": [
        "    def _audit_path(self):",
        "        repo_root = os.path.abspath(",
        "            os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, os.pardir)"
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "method",
      "qualified_name": "TestRecordRuleLedgerP1.test_ledger_visibility_audit",
      "line": 195,
      "decorators": [],
      "context_snippet": [
        "    def test_ledger_visibility_audit(self):",
        "        rows = []",
        ""
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "function",
      "qualified_name": "_ctx",
      "line": 23,
      "decorators": [],
      "context_snippet": [
        "        def _ctx(model):",
        "            return cls.env[model].with_context(ctx)",
        ""
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "function",
      "qualified_name": "_create_user",
      "line": 26,
      "decorators": [],
      "context_snippet": [
        "        def _create_user(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_record_rule_ledger_p1.py",
      "symbol_type": "function",
      "qualified_name": "_create_contract",
      "line": 77,
      "decorators": [],
      "context_snippet": [
        "        def _create_contract(name, project):",
        "            return _ctx(\"construction.contract\").create(",
        "                {"
      ]
    },
    {
      "file": "tests/test_role_regression_minimal.py",
      "symbol_type": "module",
      "qualified_name": "test_role_regression_minimal",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo.tests.common import tagged"
      ]
    },
    {
      "file": "tests/test_role_regression_minimal.py",
      "symbol_type": "method",
      "qualified_name": "TestRoleRegressionMinimal.setUpClass",
      "line": 14,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_role_regression_minimal.py",
      "symbol_type": "method",
      "qualified_name": "TestRoleRegressionMinimal._allowed",
      "line": 56,
      "decorators": [],
      "context_snippet": [
        "    def _allowed(self, user, action_xmlid):",
        "        action = self.env.ref(action_xmlid)",
        "        if not hasattr(action, \"groups_id\"):"
      ]
    },
    {
      "file": "tests/test_role_regression_minimal.py",
      "symbol_type": "method",
      "qualified_name": "TestRoleRegressionMinimal.test_role_action_matrix",
      "line": 62,
      "decorators": [],
      "context_snippet": [
        "    def test_role_action_matrix(self):",
        "        cases = [",
        "            # 项目域"
      ]
    },
    {
      "file": "tests/test_role_regression_minimal.py",
      "symbol_type": "function",
      "qualified_name": "_create",
      "line": 18,
      "decorators": [],
      "context_snippet": [
        "        def _create(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_sidebar_menu_visibility_audit.py",
      "symbol_type": "module",
      "qualified_name": "test_sidebar_menu_visibility_audit",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import csv",
        "import logging"
      ]
    },
    {
      "file": "tests/test_sidebar_menu_visibility_audit.py",
      "symbol_type": "method",
      "qualified_name": "TestSidebarMenuVisibilityAudit.setUpClass",
      "line": 18,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        company = cls.env.ref(\"base.main_company\")"
      ]
    },
    {
      "file": "tests/test_sidebar_menu_visibility_audit.py",
      "symbol_type": "method",
      "qualified_name": "TestSidebarMenuVisibilityAudit._audit_path",
      "line": 39,
      "decorators": [],
      "context_snippet": [
        "    def _audit_path(self):",
        "        repo_root = os.path.abspath(",
        "            os.path.join(os.path.dirname(__file__), os.pardir, os.pardir, os.pardir)"
      ]
    },
    {
      "file": "tests/test_sidebar_menu_visibility_audit.py",
      "symbol_type": "method",
      "qualified_name": "TestSidebarMenuVisibilityAudit._menu_visible",
      "line": 55,
      "decorators": [],
      "context_snippet": [
        "    def _menu_visible(self, user, menu):",
        "        if not menu:",
        "            return False"
      ]
    },
    {
      "file": "tests/test_sidebar_menu_visibility_audit.py",
      "symbol_type": "method",
      "qualified_name": "TestSidebarMenuVisibilityAudit.test_sidebar_menu_visibility_audit",
      "line": 62,
      "decorators": [],
      "context_snippet": [
        "    def test_sidebar_menu_visibility_audit(self):",
        "        menu_xmlids = sorted(",
        "            {"
      ]
    },
    {
      "file": "tests/test_sidebar_menu_visibility_audit.py",
      "symbol_type": "function",
      "qualified_name": "_create",
      "line": 22,
      "decorators": [],
      "context_snippet": [
        "        def _create(login, group_xmlids):",
        "            groups = [(6, 0, [cls.env.ref(x).id for x in group_xmlids])]",
        "            return cls.env[\"res.users\"].with_context(no_reset_password=True).create("
      ]
    },
    {
      "file": "tests/test_smoke_3waymatch_flow.py",
      "symbol_type": "module",
      "qualified_name": "test_smoke_3waymatch_flow",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests.common import TransactionCase, tagged",
        ""
      ]
    },
    {
      "file": "tests/test_smoke_3waymatch_flow.py",
      "symbol_type": "class",
      "qualified_name": "TestSmokeThreeWayMatchFlow",
      "line": 6,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestSmokeThreeWayMatchFlow(TransactionCase):",
        "",
        "    @classmethod"
      ]
    },
    {
      "file": "tests/test_smoke_3waymatch_flow.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeThreeWayMatchFlow.setUpClass",
      "line": 9,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        cls.partner = cls.env[\"res.partner\"].create({\"name\": \"Flow Vendor\"})"
      ]
    },
    {
      "file": "tests/test_smoke_3waymatch_flow.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeThreeWayMatchFlow.test_minimum_three_way_match_chain",
      "line": 50,
      "decorators": [],
      "context_snippet": [
        "    def test_minimum_three_way_match_chain(self):",
        "        settlement = self.env[\"sc.settlement.order\"].create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_smoke_registry.py",
      "symbol_type": "module",
      "qualified_name": "test_smoke_registry",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests.common import TransactionCase, tagged",
        ""
      ]
    },
    {
      "file": "tests/test_smoke_registry.py",
      "symbol_type": "class",
      "qualified_name": "TestSmokeRegistry",
      "line": 6,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestSmokeRegistry(TransactionCase):",
        "",
        "    @classmethod"
      ]
    },
    {
      "file": "tests/test_smoke_registry.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeRegistry.setUpClass",
      "line": 9,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        cls.settlement_model = cls.env[\"sc.settlement.order\"]"
      ]
    },
    {
      "file": "tests/test_smoke_registry.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeRegistry.test_models_are_available",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "    def test_models_are_available(self):",
        "        self.assertEqual(self.settlement_model._name, \"sc.settlement.order\")",
        "        self.assertEqual(self.payment_model._name, \"payment.request\")"
      ]
    },
    {
      "file": "tests/test_smoke_registry.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeRegistry.test_settlement_key_fields_exist",
      "line": 20,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_key_fields_exist(self):",
        "        expected = {",
        "            \"purchase_order_ids\","
      ]
    },
    {
      "file": "tests/test_smoke_registry.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeRegistry.test_payment_request_key_fields_exist",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_key_fields_exist(self):",
        "        expected = {\"project_id\", \"partner_id\", \"settlement_id\", \"amount\", \"contract_id\"}",
        "        self.assertTrue(expected.issubset(set(self.payment_model._fields)))"
      ]
    },
    {
      "file": "tests/test_smoke_security.py",
      "symbol_type": "module",
      "qualified_name": "test_smoke_security",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests.common import TransactionCase, tagged",
        ""
      ]
    },
    {
      "file": "tests/test_smoke_security.py",
      "symbol_type": "class",
      "qualified_name": "TestSmokeSecurity",
      "line": 6,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestSmokeSecurity(TransactionCase):",
        "",
        "    @classmethod"
      ]
    },
    {
      "file": "tests/test_smoke_security.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeSecurity.setUpClass",
      "line": 9,
      "decorators": [
        "classmethod"
      ],
      "context_snippet": [
        "    def setUpClass(cls):",
        "        super().setUpClass()",
        "        cls.partner = cls.env[\"res.partner\"].create({\"name\": \"Smoke Partner\"})"
      ]
    },
    {
      "file": "tests/test_smoke_security.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeSecurity.test_finance_user_can_create_payment_request",
      "line": 59,
      "decorators": [],
      "context_snippet": [
        "    def test_finance_user_can_create_payment_request(self):",
        "        request = self.env[\"payment.request\"].with_user(self.finance_user).create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_smoke_security.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeSecurity.test_material_manager_can_create_material_plan",
      "line": 75,
      "decorators": [],
      "context_snippet": [
        "    def test_material_manager_can_create_material_plan(self):",
        "        plan = self.env[\"project.material.plan\"].with_user(self.material_manager).create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_smoke_security.py",
      "symbol_type": "method",
      "qualified_name": "TestSmokeSecurity.test_admin_can_create_settlement_order",
      "line": 95,
      "decorators": [],
      "context_snippet": [
        "    def test_admin_can_create_settlement_order(self):",
        "        settlement = self.env[\"sc.settlement.order\"].with_user(self.admin_user).create(",
        "            {"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "module",
      "qualified_name": "test_smoke_validator",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.exceptions import UserError",
        "from odoo.tests.common import TransactionCase, tagged"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "class",
      "qualified_name": "TestValidatorSmoke",
      "line": 7,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestValidatorSmoke(TransactionCase):",
        "",
        "    def test_validator_runs(self):"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "method",
      "qualified_name": "TestValidatorSmoke.test_validator_runs",
      "line": 9,
      "decorators": [],
      "context_snippet": [
        "    def test_validator_runs(self):",
        "        payload = self.env[\"sc.data.validator\"].run(return_dict=True)",
        "        self.assertIn(\"rules\", payload)"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "method",
      "qualified_name": "TestValidatorSmoke.test_validator_catches_missing_settlement",
      "line": 16,
      "decorators": [],
      "context_snippet": [
        "    def test_validator_catches_missing_settlement(self):",
        "        project = self.env[\"project.project\"].create({\"name\": \"Validator Project\"})",
        "        partner = self.env[\"res.partner\"].create({\"name\": \"Validator Partner\"})"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "method",
      "qualified_name": "TestValidatorSmoke.test_payment_request_submit_happy_path",
      "line": 38,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_submit_happy_path(self):",
        "        # 构造完整链路：项目 -> 合同 -> 采购 -> 结算 -> 付款申请",
        "        project = self.env[\"project.project\"].create({\"name\": \"PR Happy Project\"})"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "method",
      "qualified_name": "TestValidatorSmoke.test_payment_request_overpay_blocked",
      "line": 208,
      "decorators": [],
      "context_snippet": [
        "    def test_payment_request_overpay_blocked(self):",
        "        project = self.env[\"project.project\"].create({\"name\": \"Overpay Project\"})",
        "        partner = self.env[\"res.partner\"].create({\"name\": \"Overpay Vendor\"})"
      ]
    },
    {
      "file": "tests/test_smoke_validator.py",
      "symbol_type": "method",
      "qualified_name": "TestValidatorSmoke.test_settlement_approve_happy_path",
      "line": 413,
      "decorators": [],
      "context_snippet": [
        "    def test_settlement_approve_happy_path(self):",
        "        project = self.env[\"project.project\"].create({\"name\": \"Settle Happy Project\"})",
        "        partner = self.env[\"res.partner\"].create({\"name\": \"Happy Vendor\"})"
      ]
    },
    {
      "file": "tests/test_stock_cost.py",
      "symbol_type": "module",
      "qualified_name": "test_stock_cost",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo.tests import TransactionCase",
        "from odoo import fields"
      ]
    },
    {
      "file": "tests/test_stock_cost.py",
      "symbol_type": "class",
      "qualified_name": "TestStockCostLedger",
      "line": 8,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "class TestStockCostLedger(TransactionCase):",
        "",
        "    def setUp(self):"
      ]
    },
    {
      "file": "tests/test_stock_cost.py",
      "symbol_type": "method",
      "qualified_name": "TestStockCostLedger.setUp",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "    def setUp(self):",
        "        super().setUp()",
        "        self.project = self.env[\"project.project\"].create({\"name\": \"Project Cost Test\"})"
      ]
    },
    {
      "file": "tests/test_stock_cost.py",
      "symbol_type": "method",
      "qualified_name": "TestStockCostLedger.test_cost_ledger_created_on_receipt",
      "line": 47,
      "decorators": [
        "tagged"
      ],
      "context_snippet": [
        "    def test_cost_ledger_created_on_receipt(self):",
        "        picking = self.env[\"stock.picking\"].create({",
        "            \"name\": \"WH/IN/0001\","
      ]
    },
    {
      "file": "tests/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import test_action_groups_gate",
        "from . import test_role_regression_minimal"
      ]
    },
    {
      "file": "tools/validator/rules.py",
      "symbol_type": "class",
      "qualified_name": "RuleResult",
      "line": 14,
      "decorators": [
        "dataclass"
      ],
      "context_snippet": [
        "class RuleResult:",
        "    code: str",
        "    title: str"
      ]
    },
    {
      "file": "tools/validator/rules.py",
      "symbol_type": "class",
      "qualified_name": "BaseRule",
      "line": 22,
      "decorators": [],
      "context_snippet": [
        "class BaseRule(ABC):",
        "    code: str = None",
        "    title: str = None"
      ]
    },
    {
      "file": "tools/validator/rules.py",
      "symbol_type": "function",
      "qualified_name": "register",
      "line": 71,
      "decorators": [],
      "context_snippet": [
        "def register(rule_cls):",
        "    _RULES.append(rule_cls)",
        "    return rule_cls"
      ]
    },
    {
      "file": "tools/validator/rules.py",
      "symbol_type": "function",
      "qualified_name": "get_registered_rules",
      "line": 76,
      "decorators": [],
      "context_snippet": [
        "def get_registered_rules():",
        "    return _RULES",
        ""
      ]
    },
    {
      "file": "tools/validator/rules.py",
      "symbol_type": "method",
      "qualified_name": "BaseRule._validate_meta",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "    def _validate_meta(self):",
        "        if not self.code or not self.title:",
        "            raise ValueError(f\"Rule meta missing: code/title in {self.__class__.__name__}\")"
      ]
    },
    {
      "file": "tools/validator/rule_3way_link_integrity.py",
      "symbol_type": "module",
      "qualified_name": "rule_3way_link_integrity",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _",
        ""
      ]
    },
    {
      "file": "tools/validator/rule_3way_link_integrity.py",
      "symbol_type": "class",
      "qualified_name": "ThreeWayLinkIntegrityRule",
      "line": 8,
      "decorators": [
        "register"
      ],
      "context_snippet": [
        "class ThreeWayLinkIntegrityRule(BaseRule):",
        "    code = \"SC.VAL.3WAY.001\"",
        "    title = \"三单匹配链路的关键关联是否缺失\""
      ]
    },
    {
      "file": "tools/validator/rule_3way_link_integrity.py",
      "symbol_type": "method",
      "qualified_name": "ThreeWayLinkIntegrityRule.run",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "    def run(self):",
        "        env = self.env",
        "        Payment = env[\"payment.request\"].sudo()"
      ]
    },
    {
      "file": "tools/validator/rule_amount_qty_sanity.py",
      "symbol_type": "module",
      "qualified_name": "rule_amount_qty_sanity",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _",
        ""
      ]
    },
    {
      "file": "tools/validator/rule_amount_qty_sanity.py",
      "symbol_type": "class",
      "qualified_name": "AmountQtySanityRule",
      "line": 8,
      "decorators": [
        "register"
      ],
      "context_snippet": [
        "class AmountQtySanityRule(BaseRule):",
        "    code = \"SC.VAL.AMT.001\"",
        "    title = \"金额与数量的合理性检查（不允许负数）\""
      ]
    },
    {
      "file": "tools/validator/rule_amount_qty_sanity.py",
      "symbol_type": "method",
      "qualified_name": "AmountQtySanityRule.run",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "    def run(self):",
        "        env = self.env",
        "        issues = []"
      ]
    },
    {
      "file": "tools/validator/rule_company_consistency.py",
      "symbol_type": "module",
      "qualified_name": "rule_company_consistency",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _",
        ""
      ]
    },
    {
      "file": "tools/validator/rule_company_consistency.py",
      "symbol_type": "class",
      "qualified_name": "CompanyConsistencyRule",
      "line": 8,
      "decorators": [
        "register"
      ],
      "context_snippet": [
        "class CompanyConsistencyRule(BaseRule):",
        "    code = \"SC.VAL.COMP.001\"",
        "    title = \"采购/结算/付款的公司一致性\""
      ]
    },
    {
      "file": "tools/validator/rule_company_consistency.py",
      "symbol_type": "method",
      "qualified_name": "CompanyConsistencyRule.run",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "    def run(self):",
        "        env = self.env",
        "        Payment = env[\"payment.request\"].sudo()"
      ]
    },
    {
      "file": "tools/validator/rule_payment_not_overpay.py",
      "symbol_type": "module",
      "qualified_name": "rule_payment_not_overpay",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _",
        "from odoo.tools.float_utils import float_compare"
      ]
    },
    {
      "file": "tools/validator/rule_payment_not_overpay.py",
      "symbol_type": "class",
      "qualified_name": "PaymentNotOverpayRule",
      "line": 10,
      "decorators": [
        "register"
      ],
      "context_snippet": [
        "class PaymentNotOverpayRule(BaseRule):",
        "    code = \"SC.VAL.PAY.001\"",
        "    title = _(\"付款不得超过结算可付余额\")"
      ]
    },
    {
      "file": "tools/validator/rule_payment_not_overpay.py",
      "symbol_type": "method",
      "qualified_name": "PaymentNotOverpayRule.run",
      "line": 15,
      "decorators": [],
      "context_snippet": [
        "    def run(self):",
        "        env = self.env",
        "        Payment = env[\"payment.request\"].sudo()"
      ]
    },
    {
      "file": "tools/validator/rule_project_required.py",
      "symbol_type": "module",
      "qualified_name": "rule_project_required",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import _",
        ""
      ]
    },
    {
      "file": "tools/validator/rule_project_required.py",
      "symbol_type": "class",
      "qualified_name": "ProjectRequiredRule",
      "line": 8,
      "decorators": [
        "register"
      ],
      "context_snippet": [
        "class ProjectRequiredRule(BaseRule):",
        "    code = \"SC.VAL.PROJ.001\"",
        "    title = \"关键单据必须挂项目\""
      ]
    },
    {
      "file": "tools/validator/rule_project_required.py",
      "symbol_type": "method",
      "qualified_name": "ProjectRequiredRule.run",
      "line": 13,
      "decorators": [],
      "context_snippet": [
        "    def run(self):",
        "        env = self.env",
        "        issues = []"
      ]
    },
    {
      "file": "tools/validator/run_validate.py",
      "symbol_type": "module",
      "qualified_name": "run_validate",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import odoo",
        "from odoo import api, SUPERUSER_ID"
      ]
    },
    {
      "file": "tools/validator/run_validate.py",
      "symbol_type": "function",
      "qualified_name": "main",
      "line": 8,
      "decorators": [],
      "context_snippet": [
        "def main():",
        "    # 读取容器内 Odoo 配置",
        "    config.parse_config([\"-c\", \"/etc/odoo/odoo.conf\"])"
      ]
    },
    {
      "file": "tools/validator/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from .rules import get_registered_rules",
        ""
      ]
    },
    {
      "file": "wizard/material_plan_to_rfq.py",
      "symbol_type": "module",
      "qualified_name": "material_plan_to_rfq",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import logging",
        ""
      ]
    },
    {
      "file": "wizard/material_plan_to_rfq.py",
      "symbol_type": "class",
      "qualified_name": "MaterialPlanToRfqWizard",
      "line": 10,
      "decorators": [],
      "context_snippet": [
        "class MaterialPlanToRfqWizard(models.TransientModel):",
        "    _name = \"material.plan.to.rfq.wizard\"",
        "    _description = \"Material Plan To RFQ\""
      ]
    },
    {
      "file": "wizard/material_plan_to_rfq.py",
      "symbol_type": "method",
      "qualified_name": "MaterialPlanToRfqWizard.action_generate_rfq",
      "line": 45,
      "decorators": [],
      "context_snippet": [
        "    def action_generate_rfq(self):",
        "        self.ensure_one()",
        "        records = self._get_active_records()"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "module",
      "qualified_name": "project_boq_import_wizard",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import base64",
        "import csv"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "class",
      "qualified_name": "ProjectBoqImportWizard",
      "line": 24,
      "decorators": [],
      "context_snippet": [
        "class ProjectBoqImportWizard(models.TransientModel):",
        "    _name = \"project.boq.import.wizard\"",
        "    _description = \"工程量清单导入\""
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "class",
      "qualified_name": "HierarchyBuilder",
      "line": 1403,
      "decorators": [],
      "context_snippet": [
        "class HierarchyBuilder:",
        "    def __init__(self):",
        "        self.stack = {}"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard.action_import",
      "line": 106,
      "decorators": [],
      "context_snippet": [
        "    def action_import(self):",
        "        self.ensure_one()",
        "        if not self.file:"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._parse_csv_content",
      "line": 209,
      "decorators": [],
      "context_snippet": [
        "    def _parse_csv_content(self, content):",
        "        reader = csv.reader(io.StringIO(content))",
        "        rows_data = list(reader)"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._col_map_cfg",
      "line": 457,
      "decorators": [],
      "context_snippet": [
        "    def _col_map_cfg(self):",
        "        return {",
        "            \"code\": [\"清单编码\", \"编码\", \"code\"],"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._prepare_col_map",
      "line": 474,
      "decorators": [],
      "context_snippet": [
        "    def _prepare_col_map(self, headers, col_map_cfg=None):",
        "        col_map_cfg = col_map_cfg or self._col_map_cfg()",
        "        col_map = {}"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._parse_engineering_header_xls",
      "line": 540,
      "decorators": [],
      "context_snippet": [
        "    def _parse_engineering_header_xls(self, sheet, limit=5):",
        "        for r in range(min(limit, sheet.nrows)):",
        "            for c in range(sheet.ncols):"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._extract_xls_header",
      "line": 637,
      "decorators": [],
      "context_snippet": [
        "    def _extract_xls_header(self, sheet, header_rows=2, scan_rows=8):",
        "        max_col = sheet.ncols",
        "        header_row_idx = 0"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._build_rows_from_iter",
      "line": 680,
      "decorators": [],
      "context_snippet": [
        "    def _build_rows_from_iter(",
        "        self,",
        "        row_iter,"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._guess_section_type",
      "line": 1063,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _guess_section_type(sheet_title):",
        "        title = (sheet_title or \"\").lower()",
        "        mapping = {"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._normalize_header",
      "line": 1146,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _normalize_header(title):",
        "        text = str(title or \"\").strip()",
        "        text = re.sub(r\"\\s+\", \"\", text)"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._is_number",
      "line": 1152,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _is_number(val):",
        "        try:",
        "            if isinstance(val, str):"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectBoqImportWizard._to_float",
      "line": 1166,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _to_float(val):",
        "        try:",
        "            if isinstance(val, str):"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "HierarchyBuilder.reset",
      "line": 1407,
      "decorators": [],
      "context_snippet": [
        "    def reset(self):",
        "        self.stack = {}",
        ""
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "HierarchyBuilder.place",
      "line": 1410,
      "decorators": [],
      "context_snippet": [
        "    def place(self, rec, level):",
        "        parent = self.stack.get(level - 1)",
        "        rec.parent_id = parent.id if parent else False"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "cell_val",
      "line": 582,
      "decorators": [],
      "context_snippet": [
        "        def cell_val(r, c):",
        "            key = merge_map.get((r, c))",
        "            if key:"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "_default_uom",
      "line": 970,
      "decorators": [],
      "context_snippet": [
        "        def _default_uom():",
        "            category = self.env.ref(\"uom.product_uom_categ_unit\", raise_if_not_found=False)",
        "            if not category:"
      ]
    },
    {
      "file": "wizard/project_boq_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "get",
      "line": 713,
      "decorators": [],
      "context_snippet": [
        "            def get(field):",
        "                idx = col_map.get(field)",
        "                if idx is None or idx >= len(row):"
      ]
    },
    {
      "file": "wizard/project_task_from_boq_wizard.py",
      "symbol_type": "module",
      "qualified_name": "project_task_from_boq_wizard",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from odoo import fields, models",
        "from odoo.exceptions import UserError"
      ]
    },
    {
      "file": "wizard/project_task_from_boq_wizard.py",
      "symbol_type": "class",
      "qualified_name": "ProjectTaskFromBoqWizard",
      "line": 6,
      "decorators": [],
      "context_snippet": [
        "class ProjectTaskFromBoqWizard(models.TransientModel):",
        "    _name = \"project.task.from.boq.wizard\"",
        "    _description = \"从工程量清单生成施工任务\""
      ]
    },
    {
      "file": "wizard/project_task_from_boq_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTaskFromBoqWizard.action_generate_tasks",
      "line": 32,
      "decorators": [],
      "context_snippet": [
        "    def action_generate_tasks(self):",
        "        self.ensure_one()",
        "        project = self.project_id"
      ]
    },
    {
      "file": "wizard/project_task_from_boq_wizard.py",
      "symbol_type": "method",
      "qualified_name": "ProjectTaskFromBoqWizard._section_labels",
      "line": 126,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _section_labels():",
        "        return {",
        "            \"building\": \"建筑\","
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "module",
      "qualified_name": "quota_import_wizard",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "import base64",
        "import io"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "_clean",
      "line": 18,
      "decorators": [],
      "context_snippet": [
        "def _clean(val):",
        "    if val is None:",
        "        return \"\""
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "_to_float",
      "line": 25,
      "decorators": [],
      "context_snippet": [
        "def _to_float(val):",
        "    val = _clean(val)",
        "    if not val:"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "class",
      "qualified_name": "QuotaImportWizard",
      "line": 36,
      "decorators": [],
      "context_snippet": [
        "class QuotaImportWizard(models.TransientModel):",
        "    _name = \"quota.import.wizard\"",
        "    _description = \"四川定额导入向导\""
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "QuotaImportWizard._load_workbook",
      "line": 47,
      "decorators": [],
      "context_snippet": [
        "    def _load_workbook(self):",
        "        if not self.file_data:",
        "            raise UserError(\"请先上传 Excel 文件。\")"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "QuotaImportWizard._val",
      "line": 59,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _val(sheet, row, col):",
        "        return sheet.cell(row=row, column=col).value if col else None",
        ""
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "QuotaImportWizard._str",
      "line": 63,
      "decorators": [
        "staticmethod"
      ],
      "context_snippet": [
        "    def _str(sheet, row, col):",
        "        v = sheet.cell(row=row, column=col).value if col else \"\"",
        "        return _clean(v)"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "QuotaImportWizard._ensure_dict",
      "line": 67,
      "decorators": [],
      "context_snippet": [
        "    def _ensure_dict(self, type_code, name, code=None, parent=None):",
        "        Dic = self.env[\"project.dictionary\"].sudo()",
        "        domain = [(\"type\", \"=\", type_code), (\"name\", \"=\", name)]"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "method",
      "qualified_name": "QuotaImportWizard.action_import",
      "line": 133,
      "decorators": [],
      "context_snippet": [
        "    def action_import(self):",
        "        self.ensure_one()",
        "        wb = self._load_workbook()"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "_match_key",
      "line": 92,
      "decorators": [],
      "context_snippet": [
        "        def _match_key(sheet_title):",
        "            st = sheet_title.strip()",
        "            for key in QUOTA_SPEC.keys():"
      ]
    },
    {
      "file": "wizard/quota_import_wizard.py",
      "symbol_type": "function",
      "qualified_name": "col",
      "line": 173,
      "decorators": [],
      "context_snippet": [
        "            def col(*names):",
        "                for n in names:",
        "                    if n in header_map:"
      ]
    },
    {
      "file": "wizard/__init__.py",
      "symbol_type": "module",
      "qualified_name": "__init__",
      "line": 1,
      "decorators": [],
      "context_snippet": [
        "# -*- coding: utf-8 -*-",
        "from . import project_boq_import_wizard",
        "from . import quota_import_wizard"
      ]
    }
  ],
  "statistics": {
    "total_files": 135,
    "total_classes": 157,
    "total_methods": 668,
    "total_functions": 112,
    "missing_class_docstrings": 121,
    "missing_method_docstrings": 558,
    "missing_function_docstrings": 89,
    "missing_module_docstrings": 129
  }
}